webpackJsonp([158],{1040:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(66),s=r.n(a),n=r(102),i=r.n(n),l=r(100),c=r.n(l),o=r(99),u=r.n(o),m=(r(1),r(101)),p=r(65),d=(r.n(p),r(436)),f=r.n(d),h=r(22),v=r(64);t.default={data:function(){return{title:"",selectMes:{},ope:"",btnLoading:!1,tabloading:!1,loading:!1,shopList:[],doctorList:[],baseUrl:m.b,column:"",class1:[],class2:[],class3:[],catLog:[],hospitalList:[],supplierList:[],currentPage:1,dialogVisible:!1,form:{},formLabelWidth:"80px",pageSize:10,totalPage:10,formInline:{column:"",class1:"",class2:"",class3:"",startPrice:"",endPrice:"",hospital:"",supplier:"",doctor:"",name:"",shop:"",isEnable:""},tableData:[],allData:[]}},computed:{tHeader:function(){return["ID","商品编号","商品名称","分类","医院/供方","医生","售价","积分抵现","产地"]},filterVal:function(){return["id","goodsCode","name","class","supplierName","serviceName","priceRange","limitAmount","productionAddress"]},tableData1:function(){return this.allData.forEach(function(e){e.class=e.cloumnName+"/"+e.catalogName}),this.allData},name:function(){return"商品列表"}},watch:{"formInline.supplier":{handler:function(e){this.formInline.doctor="",this.GetServiceManByHspCode({hospitalCode:e})},deep:!0}},mounted:function(){this.getColumn()},methods:{expt:function(){this.search("export")},DeleteGoodsById:function(e){var t=this;this.$confirm("确定删除该商品?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.deleteGood({id:e.id})})},deleteGood:function(a){var n=this;return u()(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.i(v._561)(a);case 2:(t=e.sent).status?(n.$message({message:"操作成功",type:"success"}),n.search()):n.$message.error("操作失败"+t.errorMessage);case 4:case"end":return e.stop()}},e,n)}))()},onSubmit:function(){this.currentPage=1,this.search()},handleSizeChange:function(e){console.log("每页 "+e+" 条"),this.pageSize=e,this.search()},handleCurrentChange:function(e){console.log("当前页: "+e),this.currentPage=e,this.search()},handleClick:function(e,t,a){r.i(h.e)("editId",t[e].id),this.$router.push({path:"/menu/productEditor",query:{id:t[e].id,from:a}})},handleSuccess:function(){alert("复制成功")},handleError:function(){},columnChange:function(){this.formInline.class1="",this.getCatelog({code:this.formInline.column})},classChange:function(){this.formInline.class2="",this.class2=this.parentCode(this.formInline.class1)},class2Change:function(){this.formInline.class3="",this.class3=this.parentCode(this.formInline.class2)},selectData:function(e,t){for(var a=t.length,n=0;n<a;n++);},GetShopByPage:function(a){var n=this;return u()(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.i(v._110)(a);case 3:t=e.sent,n.shopList=t.data,n.loading=!1,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}},e,n,[[0,8]])}))()},remoteMethod:function(e){""!==e?(this.loading=!0,this.GetShopByPage({pageIndex:1,pageSize:20,keywords:e.removeSP()})):this.options4=[]},getClass:function(){this.class1=this.parentCode("")},getGoods:function(a,n){var l=this;return u()(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.i(v._163)(a);case 3:t=e.sent,"export"==n?(l.allData=t.data,l.btnLoading=!1,l.$refs.export.handleDownload()):(l.totalPage=t.count,l.tableData=l.splitUrl(t.data),l.tabloading=!1),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}},e,l,[[0,7]])}))()},getColumn:function(){var o=this;return u()(c.a.mark(function e(){var t,a,n,l;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.a.all([r.i(v._553)(),r.i(v.d)({typeId:1})]);case 3:t=e.sent,a=i()(t,2),n=a[0],l=a[1],o.column=n,o.supplierList=l.data,o.formInline.supplier=l.data[0].code,o.search(),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop()}},e,o,[[0,13]])}))()},getCatelog:function(a){var n=this;return u()(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.i(v._207)(a);case 3:t=e.sent,n.catelog=t.data,n.getClass(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}},e,n,[[0,8]])}))()},parentCode:function(e){for(var t=[],a=0;a<this.catelog.length;a++)this.catelog[a].parentCode==e&&t.push(this.catelog[a]);return t},search:function(e){"export"==e?this.btnLoading=!1:this.tabloading=!0;var t="";t=0!=this.formInline.class3.length?this.formInline.class3:0!=this.formInline.class2.length?this.formInline.class2:this.formInline.class1,this.getGoods({columnCode:this.formInline.column,catalogCode:t,startPrice:this.formInline.startPrice,endPrice:this.formInline.endPrice,supplierCode:this.formInline.supplier,keyWords:this.formInline.name.removeSP(),serviceMan:this.formInline.doctor,pageSize:"export"==e?this.totalPage:this.pageSize,pageIndex:this.currentPage,isEnable:this.formInline.isEnable},e)},splitUrl:function(e){return e.forEach(function(e){e.ImgMainUrl=m.b+e.imgMainUrl}),e},GetServiceManByHspCode:function(a){var n=this;return u()(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.i(v._555)(a);case 3:t=e.sent,n.doctorList=t,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("获取数据失败",e.t0);case 10:case"end":return e.stop()}},e,n,[[0,7]])}))()}},components:{Export:f.a}}},1386:function(e,t,a){(e.exports=a(215)(!1)).push([e.i,".goodsList[data-v-54310740]{font-size:12px}.block[data-v-54310740]{float:right}",""])},1811:function(e,t,a){var n=a(1386);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a(216)("7f129e87",n,!0)},2284:function(e,t){e.exports={render:function(){var a=this,e=a.$createElement,n=a._self._c||e;return n("div",{staticClass:"goodsList selCommon"},[n("el-form",{staticClass:"demo-form-inline form_search",attrs:{inline:!0,model:a.formInline,"label-width":"80px"}},[n("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"栏目："}},[n("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},on:{change:a.columnChange},model:{value:a.formInline.column,callback:function(e){a.$set(a.formInline,"column",e)},expression:"formInline.column"}},[n("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),a._l(a.column,function(e){return n("el-option",{key:e.Code,attrs:{label:e.Name,value:e.CloumnCode}})})],2)],1),a._v(" "),n("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"大类："}},[n("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},on:{change:a.classChange},model:{value:a.formInline.class1,callback:function(e){a.$set(a.formInline,"class1",e)},expression:"formInline.class1"}},[n("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),a._l(a.class1,function(e){return n("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})],2)],1),a._v(" "),n("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"中类："}},[n("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},on:{change:a.class2Change},model:{value:a.formInline.class2,callback:function(e){a.$set(a.formInline,"class2",e)},expression:"formInline.class2"}},[n("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),a._l(a.class2,function(e){return n("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})],2)],1),a._v(" "),n("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"小类："}},[n("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},model:{value:a.formInline.class3,callback:function(e){a.$set(a.formInline,"class3",e)},expression:"formInline.class3"}},[n("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),a._l(a.class3,function(e){return n("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})],2)],1),a._v(" "),n("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"价格区间："}},[n("el-input",{staticStyle:{width:"92px"},attrs:{placeholder:""},model:{value:a.formInline.startPrice,callback:function(e){a.$set(a.formInline,"startPrice",e)},expression:"formInline.startPrice"}}),a._v(" "),n("span",{staticStyle:{display:"inline-block",float:"left",margin:"0 5px"}},[a._v("-")]),a._v(" "),n("el-input",{staticStyle:{width:"92px"},attrs:{placeholder:""},model:{value:a.formInline.endPrice,callback:function(e){a.$set(a.formInline,"endPrice",e)},expression:"formInline.endPrice"}})],1),a._v(" "),n("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"医院："}},[n("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择",filterable:""},model:{value:a.formInline.supplier,callback:function(e){a.$set(a.formInline,"supplier",e)},expression:"formInline.supplier"}},a._l(a.supplierList,function(e){return n("el-option",{key:e.code,attrs:{label:e.supplierName,value:e.code}})}),1)],1),a._v(" "),n("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"医生："}},[n("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},model:{value:a.formInline.doctor,callback:function(e){a.$set(a.formInline,"doctor",e)},expression:"formInline.doctor"}},[n("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),a._l(a.doctorList,function(e){return n("el-option",{key:e.Code,attrs:{label:e.ServiceName,value:e.Code}})})],2)],1),a._v(" "),n("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"商户："}},[n("el-select",{staticStyle:{width:"200px"},attrs:{filterable:"",remote:"",placeholder:"请输入关键词","remote-method":a.remoteMethod,loading:a.loading},model:{value:a.formInline.shop,callback:function(e){a.$set(a.formInline,"shop",e)},expression:"formInline.shop"}},a._l(a.shopList,function(e){return n("el-option",{key:e.value,attrs:{label:e.ShopName,value:e.ShopCode}})}),1)],1),a._v(" "),n("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"商品名称："}},[n("el-input",{staticStyle:{width:"200px"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&a._k(e.keyCode,"enter",13,e.key,"Enter")?null:a.search(e)}},model:{value:a.formInline.name,callback:function(e){a.$set(a.formInline,"name",e)},expression:"formInline.name"}})],1),a._v(" "),n("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"是否有效："}},[n("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},model:{value:a.formInline.isEnable,callback:function(e){a.$set(a.formInline,"isEnable",e)},expression:"formInline.isEnable"}},[n("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),n("el-option",{attrs:{label:"有效",value:"1"}}),a._v(" "),n("el-option",{attrs:{label:"无效",value:"0"}})],1)],1),a._v(" "),n("br"),a._v(" "),n("el-form-item",{staticClass:"form_item_mt10",attrs:{label:" "}},[n("el-button",{staticClass:"searchBtn",attrs:{type:"primary"},on:{click:a.onSubmit}},[a._v("查询")]),a._v(" "),n("el-button",{staticClass:"searchBtn",attrs:{type:"primary",disabled:0==a.tableData.length,loading:a.btnLoading},on:{click:a.expt}},[a._v("导出报表")]),a._v(" "),n("Export",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"export",attrs:{tHeader:a.tHeader,filterVal:a.filterVal,tableData1:a.tableData1,name:a.name}})],1)],1),a._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:a.tabloading,expression:"tabloading"}],staticClass:"min_table smt",staticStyle:{width:"100%","margin-top":"10px","margin-bottom":"10px"},attrs:{data:a.tableData,border:"","max-height":"560"}},[n("el-table-column",{attrs:{prop:"id",label:"ID","min-width":"70"}}),a._v(" "),n("el-table-column",{attrs:{prop:"ImgMainUrl",label:"图片","min-width":"70"},scopedSlots:a._u([{key:"default",fn:function(e){return[n("img",{staticStyle:{"vertical-align":"middle"},attrs:{width:"50px",height:"50px",src:e.row.ImgMainUrl,alt:""}})]}}])}),a._v(" "),n("el-table-column",{attrs:{prop:"goodsCode",label:"商品编号","min-width":"120"}}),a._v(" "),n("el-table-column",{attrs:{prop:"name",label:"商品名称","min-width":"200","show-overflow-tooltip":""}}),a._v(" "),n("el-table-column",{attrs:{prop:"keyWords",label:"搜索关键字","min-width":"150","show-overflow-tooltip":""}}),a._v(" "),n("el-table-column",{attrs:{prop:"isEnable",label:"是否有效","min-width":"70"},scopedSlots:a._u([{key:"default",fn:function(e){return[n("span",{domProps:{textContent:a._s("1"==e.row.isEnable?"是":"否")}})]}}])}),a._v(" "),n("el-table-column",{attrs:{prop:"grade",label:"分类","min-width":"150","show-overflow-tooltip":""},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v("\n                "+a._s(e.row.cloumnName)+"/"+a._s(e.row.catalogName)+"\n            ")]}}])}),a._v(" "),n("el-table-column",{attrs:{prop:"supplierName",label:"医院/供方","min-width":"150"}}),a._v(" "),n("el-table-column",{attrs:{prop:"serviceName",label:"医生","min-width":"80"}}),a._v(" "),n("el-table-column",{attrs:{prop:"priceRange",label:"售价","min-width":"130"}}),a._v(" "),n("el-table-column",{attrs:{prop:"limitAmount",label:"积分抵现","min-width":"80"}}),a._v(" "),n("el-table-column",{attrs:{prop:"productionAddress",label:"产地","min-width":"120"}}),a._v(" "),n("el-table-column",{attrs:{fixed:"right",prop:"grade",label:"操作","min-width":"270"},scopedSlots:a._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return a.handleClick(t.$index,a.tableData,"edit")}}},[a._v("编辑商品")]),a._v(" "),n("el-button",{attrs:{disabled:"医美"!=t.row.cloumnName,type:"primary",size:"small"},on:{click:function(e){return a.handleClick(t.$index,a.tableData,"copy")}}},[a._v("复制商品")]),a._v(" "),n("el-button",{attrs:{type:"primary",disabled:"产品"!=t.row.cloumnName,size:"small"},on:{click:function(e){return a.DeleteGoodsById(t.row)}}},[a._v("删除")])]}}])})],1),a._v(" "),n("div",{staticClass:"block"},[n("el-pagination",{attrs:{"current-page":a.currentPage,"page-sizes":[10,20,30,40],"page-size":a.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:a.totalPage},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1)],1)},staticRenderFns:[]}},322:function(e,t,a){a(1811);var n=a(98)(a(1040),a(2284),"data-v-54310740",null);e.exports=n.exports},436:function(e,t,a){a(439);var n=a(98)(a(437),a(440),"data-v-6c47323e",null);e.exports=n.exports},437:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:{tHeader:{},filterVal:{},tableData1:{type:Array},name:""},watch:{tableData1:{handler:function(e){this.otData=e},deep:!0}},data:function(){return{otData:[]}},methods:{handleDownload:function(){var a=this;n.e(220).then(function(){var e=n(448).export_json_to_excel,t=[];t=0!=a.otData.length?a.formatJson(a.filterVal,a.otData):a.formatJson(a.filterVal,a.tableData1),e(a.tHeader,t,a.name)}.bind(null,n)).catch(n.oe)},formatJson:function(e,t){return t.map(function(t){return e.map(function(e){return t[e]})})}}}},438:function(e,t,a){(e.exports=a(215)(!1)).push([e.i,".exportBtn[data-v-6c47323e]{background:#fff;border:1px solid #d6d4d4;font-size:14px;color:#666;border-radius:4px}",""])},439:function(e,t,a){var n=a(438);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a(216)("fdf4f478",n,!0)},440:function(e,t){e.exports={render:function(){var e=this.$createElement;return(this._self._c||e)("el-button",{staticClass:"exportBtn",attrs:{type:"primary"},on:{click:this.handleDownload}},[this._v("导出报表")])},staticRenderFns:[]}}});