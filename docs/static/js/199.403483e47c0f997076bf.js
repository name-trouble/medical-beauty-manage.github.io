webpackJsonp([199],{1097:function(t,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=d(37),n=d.n(a),i=d(100),p=d.n(i),s=d(103),u=d.n(s),l=d(99),o=d.n(l),r=d(101),f=d(64),c=d(22);e.default={components:{},data:function(){return{currentIndex:0,url:"",loading:!1,filterModel:{tickName:"",ticketsType:"",tickState:-1,hospitalCodes:"",projCodes:"",checkState:"0",startDate:"",endDate:"",pageIndex:1,pageSize:10},tabLoading:!1,date:"",filterWord:"",tableData:[],dataCount:0,currentPage:1,pageSize:10,states:[{text:"审核中",code:"0"},{text:"已通过",code:"1"},{text:"已驳回",code:"2"}],state:["0"],hospList:[],projectList:[],selectData:"",popCheck:!1,popOK:!1,popNo:!1,rejectReson:""}},computed:{},mounted:function(){this.url=r.b,this.$nextTick(function(){this.dropInfo()})},methods:{remoteMethod:function(t){""!==t?(this.loading=!0,this.GetGoodsByKeywords({keywords:t.removeSP(),IsMall:0})):(this.projectList=[],this.filterModel.projCodes=t)},GetGoodsByKeywords:function(r){var c=this;return o()(p.a.mark(function t(){var e,a,i,s,n,l,o;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c.projectList=[],t.next=3,d.i(f._30)(r);case 3:for(e=t.sent,i=!(a=!0),s=void 0,t.prev=7,n=u()(e);!(a=(l=n.next()).done);a=!0)o=l.value,c.projectList.push({name:o.GoodsEntity.GoodsAlias,id:o.GoodsEntity.Id});t.next=15;break;case 11:t.prev=11,t.t0=t.catch(7),i=!0,s=t.t0;case 15:t.prev=15,t.prev=16,!a&&n.return&&n.return();case 18:if(t.prev=18,i)throw s;t.next=21;break;case 21:return t.finish(18);case 22:return t.finish(15);case 23:c.loading=!1;case 24:case"end":return t.stop()}},t,c,[[7,11,15,23],[16,,18,22]])}))()},getName:function(t){switch(t){case 1:return"折扣券";case 2:return"代金券";case 3:return"门票"}},getData:function(t){return""!=t.PrdOfVal&&t.PrdOfVal+""!="null"?"售后"+t.PrdOfVal+"天":t.StartDate&&t.EndDate?"开始："+t.StartDate.substr(0,10)+"结束："+t.EndDate.substr(0,10):""},getTicketsList:function(){var a=this;return o()(p.a.mark(function t(){var e;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a.filterModel.checkState=a.state[0],a.filterModel.pageIndex=a.currentPage,a.filterModel.pageSize=a.pageSize,a.tabLoading=!0,t.next=6,d.i(f._420)(a.filterModel);case 6:e=t.sent,a.tableData=[],a.tabLoading=!1,e instanceof Array&&(a.tableData=e,0<a.tableData.length?a.dataCount=parseInt(a.tableData[0].RecordCount):a.dataCount=0);case 10:case"end":return t.stop()}},t,a)}))()},dropInfo:function(){var e=this;return o()(p.a.mark(function t(){return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.i(f._186)("001");case 2:e.hospList=t.sent;case 3:case"end":return t.stop()}},t,e)}))()},openCheck:function(t){this.selectData=t,this.popCheck=!0},dateSelect:function(t){0!=t.length?(t=t.formatDates(),this.filterModel.startDate=t.substring(0,10),this.filterModel.endDate=t.substring(13)):(this.filterModel.startDate="",this.filterModel.endDate="")},check:function(i){var s=this;return o()(p.a.mark(function t(){var e,a;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={id:s.selectData.ApplyId,checkResult:i,rejectReson:2==i?s.rejectReson:"",checkUserCode:d.i(c.b)("userId")},t.next=3,d.i(f._429)(e);case 3:0<(a=t.sent).success?s.$message({type:"success",message:"操作成功!"}):s.$message({type:"warning",message:n()(a)}),s.popOK=!1,s.popNo=!1;case 7:case"end":return t.stop()}},t,s)}))()},cancel:function(){this.popCheck=!1,this.popOK=!1,this.popNo=!1,this.$message({type:"info",message:"已取消操作!"})},selectState:function(t,e){this.currentIndex=e,this.state=[],this.state.push(t),this.initFilter(),this.getTicketsList(),this.filterModel.checkState=t,window.event.preventDefault()},initFilter:function(){this.filterModel.tickName="",this.filterModel.ticketsType="",this.filterModel.hospitalCodes="",this.filterModel.projCodes="",this.filterModel.checkState="",this.filterModel.startDate="",this.filterModel.endDate="",this.filterModel.pageIndex=1,this.filterModel.pageSize=this.pageSize},search:function(){this.currentPage=1,this.getTicketsList()},pageIndexChange:function(){this.getTicketsList()},pageSizeChange:function(t){this.pageSize=t,this.getTicketsList()},init:function(){this.getTicketsList(),this.currentPage=1},submited:function(){}}}},1318:function(t,e,a){(t.exports=a(215)(!1)).push([t.i,".el-dialog__body[data-v-3149f2b0]{padding:10px 20px}.el-checkbox-button__inner[data-v-3149f2b0]{width:120px;height:35px}.el-checkbox-button:first-child .el-checkbox-button__inner[data-v-3149f2b0],.el-checkbox-button:last-child .el-checkbox-button__inner[data-v-3149f2b0]{border-radius:0}.el-dialog__title[data-v-3149f2b0]{font-weight:0}.el-dialog__header[data-v-3149f2b0]{text-align:center}.el-table__row[data-v-3149f2b0]{cursor:pointer}.select[data-v-3149f2b0]{background:#f9f9f9;padding:10px;border-radius:5px}.select .el-input[data-v-3149f2b0]{width:270px}.select .el-date-editor[data-v-3149f2b0]{width:128px}.select .el-input--small .el-input__inner[data-v-3149f2b0]{height:35px;width:270px}.select .el-select[data-v-3149f2b0]{width:270px}.block[data-v-3149f2b0]{float:right;margin-right:30px;padding-right:0!important}.el-checkbox-button__inner[data-v-3149f2b0]{width:150px}.flex-box[data-v-3149f2b0]{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;width:100%}.flex-box .flex-item[data-v-3149f2b0]{-webkit-box-flex:0;-ms-flex:0 50%;flex:0 50%;margin-top:10px}.btn-box[data-v-3149f2b0]{text-align:center;width:100%;margin-top:15px}.btn-box button[data-v-3149f2b0]{width:120px}.row-item[data-v-3149f2b0]{position:relative;font-size:14px;text-align:left;margin:10px;left:30%}",""])},1743:function(t,e,a){var i=a(1318);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(216)("47704303",i,!0)},2215:function(t,e){t.exports={render:function(){var i=this,t=i.$createElement,s=i._self._c||t;return s("div",[s("div",{staticClass:"select"},[s("el-form",{staticClass:"demo-form-inline form_search",attrs:{inline:!0,"label-width":"100px"},model:{value:i.filterModel,callback:function(t){i.filterModel=t},expression:"filterModel"}},[s("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"创建日期："}},[s("el-date-picker",{staticClass:"form_item_ipt220",attrs:{type:"daterange",placeholder:"选择日期范围"},on:{change:i.dateSelect},model:{value:i.date,callback:function(t){i.date=t},expression:"date"}})],1),i._v(" "),s("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"关键字："}},[s("el-input",{staticClass:"form_item_ipt220",attrs:{placeholder:"券种编号/申请人/券名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&i._k(t.keyCode,"enter",13,t.key,"Enter")?null:i.search(t)}},model:{value:i.filterModel.tickName,callback:function(t){i.$set(i.filterModel,"tickName",t)},expression:"filterModel.tickName"}})],1),i._v(" "),s("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"券类型："}},[s("el-select",{staticClass:"form_item_ipt220",on:{change:i.search},model:{value:i.filterModel.ticketsType,callback:function(t){i.$set(i.filterModel,"ticketsType",t)},expression:"filterModel.ticketsType"}},[s("el-option",{attrs:{label:"全部",value:""}}),i._v(" "),s("el-option",{attrs:{label:"折扣券",value:"1"}}),i._v(" "),s("el-option",{attrs:{label:"现金券",value:"2"}}),i._v(" "),s("el-option",{attrs:{label:"门票",value:"3"}})],1)],1),i._v(" "),s("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"适用医院："}},[s("el-select",{staticClass:"form_item_ipt220",on:{change:i.search},model:{value:i.filterModel.hospitalCodes,callback:function(t){i.$set(i.filterModel,"hospitalCodes",t)},expression:"filterModel.hospitalCodes"}},[s("el-option",{attrs:{label:"全部",value:""}}),i._v(" "),i._l(i.hospList,function(t,e){return s("el-option",{key:e,attrs:{label:t.SupplierName,value:t.Code}})})],2)],1),i._v(" "),s("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"适用项目："}},[s("el-select",{staticClass:"form_item_ipt220",attrs:{filterable:"",remote:"",placeholder:"请输入关键词","remote-method":i.remoteMethod,loading:i.loading},model:{value:i.filterModel.projCodes,callback:function(t){i.$set(i.filterModel,"projCodes",t)},expression:"filterModel.projCodes"}},i._l(i.projectList,function(t){return s("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),i._v(" "),s("el-form-item",{staticClass:"form_item_mt10",attrs:{label:" "}},[s("el-button",{staticClass:"searchBtn",attrs:{type:"primary",icon:"search"},on:{click:i.search}},[i._v("查询")])],1)],1)],1),i._v(" "),s("ul",i._l(i.states,function(e,a){return s("li",{key:a,staticClass:"shelve",class:{active:i.currentIndex===a},on:{click:function(t){return i.selectState(e.code,a)}}},[i._v(i._s(e.text))])}),0),i._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:i.tabLoading,expression:"tabLoading"}],ref:"multipleTable",staticClass:"min_table",staticStyle:{width:"100%","margin-top":"10px","margin-bottom":"10px"},attrs:{data:i.tableData,"max-height":"1000",border:"",stripe:"","row-key":"id"}},[s("el-table-column",{attrs:{prop:"TickInfoCode",label:"券正面",width:"120"},scopedSlots:i._u([{key:"default",fn:function(t){return[s("img",{attrs:{src:i.url+t.row.FrontPicUrl,alt:"",height:"50",width:"82"}})]}}])}),i._v(" "),s("el-table-column",{attrs:{prop:"TickInfoCode",label:"券种编号","min-width":"100"}}),i._v(" "),s("el-table-column",{attrs:{prop:"ApplyUserName",label:"申请人","min-width":"100"}}),i._v(" "),s("el-table-column",{attrs:{label:"申请日期","min-width":"100"},scopedSlots:i._u([{key:"default",fn:function(t){return[i._v("\n                "+i._s(t.row.ApplyOn&&t.row.ApplyOn.substr(0,10))+"\n            ")]}}])}),i._v(" "),s("el-table-column",{attrs:{prop:"TickName",label:"券名称","min-width":"200"}}),i._v(" "),s("el-table-column",{attrs:{label:"券类型","min-width":"100"},scopedSlots:i._u([{key:"default",fn:function(t){return[1==t.row.TicketsType?s("span",[i._v("折扣券")]):i._e(),i._v(" "),2==t.row.TicketsType?s("span",[i._v("代金券")]):i._e(),i._v(" "),3==t.row.TicketsType?s("span",[i._v("门票")]):i._e()]}}])}),i._v(" "),s("el-table-column",{attrs:{label:"有效期",width:"170"},scopedSlots:i._u([{key:"default",fn:function(t){return[""!=t.row.PrdOfVal&&null!=t.row.PrdOfVal?s("span",[i._v(" "+i._s("售后"+t.row.PrdOfVal+"天"))]):s("span",[i._v("\n                    开始时间： "),t.row.StartDate?s("span",[i._v("\n                       "+i._s(t.row.StartDate.substring(0,10))+"\n                    ")]):i._e(),s("br"),i._v("\n                    结束时间："),t.row.EndDate?s("span",[i._v("\n                        "+i._s(t.row.EndDate.substring(0,10))+"\n                    ")]):i._e()])]}}])}),i._v(" "),s("el-table-column",{attrs:{prop:"RealPrice",label:"售价","min-width":"100"},scopedSlots:i._u([{key:"default",fn:function(t){return[i._v("\n                "+i._s("￥"+t.row.RealPrice)+"\n            ")]}}])}),i._v(" "),s("el-table-column",{attrs:{prop:"ApplyNum",label:"申请数量","min-width":"100"}}),i._v(" "),s("el-table-column",{attrs:{label:"审核",width:"100px"},scopedSlots:i._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{disabled:0!=i.states[i.currentIndex].code,type:"primary",size:"mini",icon:"edit"},on:{click:function(t){return i.openCheck(e.row)}}},[i._v(" 审核")])]}}])})],1),i._v(" "),s("div",{staticClass:"block"},[s("el-pagination",{attrs:{total:i.dataCount,"current-page":i.currentPage,"page-size":i.pageSize,"page-sizes":[10,20,30,40],layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":i.pageSizeChange,"current-change":i.pageIndexChange,"update:currentPage":function(t){i.currentPage=t},"update:current-page":function(t){i.currentPage=t}}})],1),i._v(" "),s("el-dialog",{attrs:{title:"消费券审核",visible:i.popCheck,size:"tiny",modal:!0,top:"40%"},on:{"update:visible":function(t){i.popCheck=t}}},[s("div",{staticStyle:{"padding-bottom":"10px","border-bottom":"1px solid #ddd"}},[s("span",{staticStyle:{"font-size":"15px"}},[i._v("申请详情")])]),i._v(" "),s("div",{staticClass:"flex-box"},[s("div",{staticClass:"flex-item"},[i._v("申请编号："+i._s(i.selectData.ReceiptCode))]),i._v(" "),s("div",{staticClass:"flex-item"},[i._v("状态：待审核")]),i._v(" "),s("div",{staticClass:"flex-item"},[i._v("申请人："+i._s(i.selectData.TickName))]),i._v(" "),s("div",{staticClass:"flex-item"},[i._v("申请时间: "+i._s(i.selectData.ApplyOn&&i.selectData.ApplyOn.substr(0,10)))]),i._v(" "),s("div",{staticClass:"btn-box"},[s("el-button",{attrs:{type:"info"},on:{click:function(t){i.popCheck=!1,i.popOK=!0}}},[i._v(" 审核通过")]),i._v(" "),s("el-button",{on:{click:function(t){i.popCheck=!1,i.popNo=!0}}},[i._v("驳回")])],1)])]),i._v(" "),s("el-dialog",{attrs:{title:"同意",visible:i.popOK,top:"40%",size:"tiny"},on:{"update:visible":function(t){i.popOK=t}}},[s("div",{staticClass:"row-item"},[i._v("券名称："+i._s(i.selectData.TickName))]),i._v(" "),s("div",{staticClass:"row-item"},[i._v("申请人："+i._s(i.selectData.BranchCode))]),i._v(" "),s("div",{staticClass:"row-item"},[i._v("申请数量："+i._s(i.selectData.ApplyNum))]),i._v(" "),s("div",{staticClass:"btn-box"},[s("el-button",{attrs:{type:"info"},on:{click:function(t){return i.check(1)}}},[i._v("确认")]),i._v(" "),s("el-button",{on:{click:i.cancel}},[i._v("取消")])],1)]),i._v(" "),s("el-dialog",{attrs:{title:"驳回",visible:i.popNo,top:"40%",size:"tiny"},on:{"update:visible":function(t){i.popNo=t}}},[s("span",[i._v("券名称："+i._s(i.selectData.TickName)+" ")]),i._v(" "),s("span",[i._v("申请人："+i._s(i.selectData.BranchCode))]),i._v(" "),s("span",[i._v("申请数量："+i._s(i.selectData.ApplyNum))]),i._v(" "),s("P",[i._v("驳回原因：")]),i._v(" "),s("el-input",{attrs:{type:"textarea",rows:3,placeholder:""},model:{value:i.rejectReson,callback:function(t){i.rejectReson=t},expression:"rejectReson"}}),i._v(" "),s("div",{staticClass:"btn-box"},[s("el-button",{attrs:{type:"info"},on:{click:function(t){return i.check(2)}}},[i._v("确认驳回")]),i._v(" "),s("el-button",{on:{click:i.cancel}},[i._v("取消")])],1)],1)],1)},staticRenderFns:[]}},363:function(t,e,a){a(1743);var i=a(98)(a(1097),a(2215),"data-v-3149f2b0",null);t.exports=i.exports}});