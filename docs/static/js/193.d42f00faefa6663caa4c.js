webpackJsonp([193],{1122:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(100),o=a.n(r),l=a(99),s=a.n(l),n=a(65),i=(a.n(n),a(22)),c=a(64);t.default={data:function(){return{search:"",TypeId:"",dialogFormVisible:!1,consumeList:[],ticketData:[],labelPosition:"right",formLabelAlign:{},setTopList:[],loading:!1,ruleForm:{branch:"",UpgradeOrderNum:0,BranchOrderNum:0,rate:0,type:"",IsAmount:""},ope:"",topBranchList:[],rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"}],region:[{required:!0,message:"请选择活动区域",trigger:"change"}],date1:[{type:"date",required:!0,message:"请选择日期",trigger:"change"}]}}},watch:{"ruleForm.check":{handler:function(e){0==e.length&&(this.ruleForm.rate="")},deep:!0}},computed:{},mounted:function(){this.getTopBranch()},methods:{AddRecomSet:function(t){var r=this;return s()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.i(c._314)(t);case 3:e.sent.success?(r.$message({message:"添加成功",type:"success"}),r.$refs.ruleForm.resetFields(),r.dialogFormVisible=!1,r.GetRecomSetByCode()):r.$message.error("添加失败"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0),r.$message.error("添加失败");case 11:case"end":return e.stop()}},e,r,[[0,7]])}))()},UpdateRecomSet:function(t){var r=this;return s()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.i(c._315)(t);case 3:e.sent.success?(r.$message({message:"编辑成功",type:"success"}),r.GetRecomSetByCode()):r.$message.error("编辑失败"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0),r.$message.error("编辑失败");case 11:case"end":return e.stop()}},e,r,[[0,7]])}))()},DeleteRecomSet:function(t){var r=this;return s()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.i(c._316)(t);case 3:e.sent.success?(r.$message({message:"删除成功",type:"success"}),r.GetRecomSetByCode()):r.$message.error("删除失败"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0),r.$message.error("删除失败");case 11:case"end":return e.stop()}},e,r,[[0,7]])}))()},GetRecomSetByCode:function(){var r=this;return s()(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.loading=!0,e.prev=1,e.next=4,a.i(c._317)({BranchCode:r.search,TypeId:r.TypeId});case 4:t=e.sent,r.loading=!1,r.ticketData=r.dealType(t),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:case"end":return e.stop()}},e,r,[[1,9]])}))()},getTopBranch:function(){var t=this;return s()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.i(c._194)();case 3:return t.topBranchList=e.sent,e.next=6,a.i(c._318)();case 6:t.setTopList=e.sent,t.dealData(t.consumeList),t.GetRecomSetByCode(),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0),t.$message.error("编辑失败");case 15:case"end":return e.stop()}},e,t,[[0,11]])}))()},numCheck:function(e){var t=void 0,r=this;t=1<e.length?e.replace(/\D/g,"").replace(/^0/g,""):e.replace(/\D/g,""),setTimeout(function(){r.ruleForm.rate=t},100)},edit:function(e,t){this.UpdateRecomSet({id:t[e].Id,branchCode:t[e].BranchCode,branchName:t[e].BranchName,TypeId:Number(t[e].TypeId),isAmount:"true"==t[e].IsAmount,upgradeOrderNum:t[e].UpgradeOrderNum,branchOrderNum:t[e].BranchOrderNum,rate:"true"==t[e].IsAmount?Number(t[e].tableRate):Number(t[e].tableRate).div(100),modifiedUserId:a.i(i.b)("userId"),modifiedBy:a.i(i.b)("userName")})},sure:function(){var e={branchCode:this.ruleForm.branch.split("|")[0],branchName:this.ruleForm.branch.split("|")[1],TypeId:Number(this.ruleForm.type),isAmount:"true"==this.ruleForm.isAmount,upgradeOrderNum:this.ruleForm.UpgradeOrderNum,branchOrderNum:this.ruleForm.BranchOrderNum,rate:Number(this.ruleForm.rate).div(100),createUserId:a.i(i.b)("userId"),createBy:a.i(i.b)("userName")};this.AddRecomSet(e)},cancel:function(e){this.$refs[e].resetFields(),this.dialogFormVisible=!1},deleteRow:function(e,t){var r=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r.DeleteRecomSet({id:t[e].Id})}).catch(function(){})},add:function(){this.ope="add",this.dialogFormVisible=!0},dealData:function(){var t=[];this.consumeList.forEach(function(e){"6"!=e.DataCode&&"1"!=e.DataCode&&t.push(e)}),this.consumeList=t},submit:function(){this.GetRecomSetByCode()},dealType:function(e){return e.forEach(function(e){e.TypeId=e.TypeId+"",e.BranchNameCode=e.BranchCode+"|"+e.BranchName,e.IsAmount=e.IsAmount+"",e.tableRate="true"==e.IsAmount?e.Rate:e.Rate.mul(100)}),e},copyWorth:function(e){this.ruleForm.Id=e.Id,this.ruleForm.branch=e.BranchCode+"|"+e.BranchName,this.ruleForm.type=e.ConsumeTypeId+"",this.ruleForm.num=e.ShareCount,this.ruleForm.type=e.ConsumeTypeId+"",this.ruleForm.comGrade=e.CompanyGradeNum+"",this.ruleForm.compRate=Number(e.CompanyRate).mul(100)},getRateList:function(){for(var e=[],t=arguments,r=0;r<t.length;r++)t[r]&&e.push({rate:t[r].mul(100)});return e}},components:{}}},1244:function(e,t,r){(e.exports=r(215)(!1)).push([e.i,".dialog-footer[data-v-0e20b496]{text-align:center}.table_container[data-v-0e20b496]{width:100%;margin-top:20px}.demo-ruleForm[data-v-0e20b496]{min-width:400px;max-width:600px}.form_item[data-v-0e20b496]{width:150px}",""])},1669:function(e,t,r){var a=r(1244);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);r(216)("555c4b24",a,!0)},2141:function(e,t){e.exports={render:function(){var r=this,e=r.$createElement,a=r._self._c||e;return a("div",{staticClass:"recAllocation selCommon"},[a("el-form",{staticClass:"form_search",attrs:{inline:!0,"label-width":"80px"}},[a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"总代理："}},[a("el-select",{on:{change:r.submit},model:{value:r.search,callback:function(e){r.search=e},expression:"search"}},[a("el-option",{attrs:{value:"全部",label:""}}),r._v(" "),r._l(r.setTopList,function(e,t){return a("el-option",{key:t,attrs:{value:e.BranchCode,label:e.BranchName}})})],2)],1),r._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"策略："}},[a("el-select",{on:{change:r.submit},model:{value:r.TypeId,callback:function(e){r.TypeId=e},expression:"TypeId"}},[a("el-option",{attrs:{value:"全部",label:""}}),r._v(" "),a("el-option",{attrs:{value:"1",label:"新策略"}}),r._v(" "),a("el-option",{attrs:{value:"2",label:"老策略"}})],1)],1),r._v(" "),a("el-form-item",{attrs:{label:"","label-width":"20px"}},[a("el-button",{staticClass:"searchBtn",attrs:{type:"primary"},on:{click:r.submit}},[r._v("搜索")])],1)],1),r._v(" "),a("div",{staticClass:"table_container"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:r.loading,expression:"loading"}],ref:"multipleTable",staticClass:"min_table smt",staticStyle:{width:"100%"},attrs:{data:r.ticketData,"max-height":"560",border:""}},[a("el-table-column",{attrs:{type:"index",width:"70"}}),r._v(" "),a("el-table-column",{attrs:{prop:"BranchName",label:"总代","min-width":"100"},scopedSlots:r._u([{key:"default",fn:function(t){return[a("el-select",{staticClass:"form_item",attrs:{filterable:"",size:"small"},model:{value:t.row.BranchNameCode,callback:function(e){r.$set(t.row,"BranchNameCode",e)},expression:"scope.row.BranchNameCode"}},[a("el-option",{attrs:{value:"0|默认",label:"0|默认"}}),r._v(" "),r._l(r.topBranchList,function(e,t){return a("el-option",{key:t,attrs:{label:e.Code+"|"+e.BranchName,value:e.Code+"|"+e.BranchName}})})],2)]}}])},[r._v("recAllocation\n            ")]),r._v(" "),a("el-table-column",{attrs:{prop:"TypeId",label:"提成类型","min-width":"120"},scopedSlots:r._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{size:"small"},model:{value:t.row.TypeId,callback:function(e){r.$set(t.row,"TypeId",e)},expression:"scope.row.TypeId"}},[a("el-option",{attrs:{value:"1",label:"新策略"}}),r._v(" "),a("el-option",{attrs:{value:"2",label:"老策略"}})],1)]}}])}),r._v(" "),a("el-table-column",{attrs:{prop:"ShareCount",label:"是否金额","min-width":"100"},scopedSlots:r._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{size:"small"},model:{value:t.row.IsAmount,callback:function(e){r.$set(t.row,"IsAmount",e)},expression:"scope.row.IsAmount"}},[a("el-option",{attrs:{value:"true",label:"是"}}),r._v(" "),a("el-option",{attrs:{value:"false",label:"否"}})],1)]}}])}),r._v(" "),a("el-table-column",{attrs:{prop:"UpgradeOrderNum",label:"升级等级","min-width":"100"},scopedSlots:r._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"small"},model:{value:t.row.UpgradeOrderNum,callback:function(e){r.$set(t.row,"UpgradeOrderNum",e)},expression:"scope.row.UpgradeOrderNum"}})]}}])}),r._v(" "),a("el-table-column",{attrs:{prop:"BranchOrderNum",label:"推荐人等级序号","min-width":"100"},scopedSlots:r._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"small"},model:{value:t.row.BranchOrderNum,callback:function(e){r.$set(t.row,"BranchOrderNum",e)},expression:"scope.row.BranchOrderNum"}})]}}])}),r._v(" "),a("el-table-column",{attrs:{prop:"Rate",label:"比例","min-width":"100"},scopedSlots:r._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"small"},model:{value:t.row.tableRate,callback:function(e){r.$set(t.row,"tableRate",e)},expression:"scope.row.tableRate"}},["false"==t.row.IsAmount?a("template",{slot:"append"},[r._v("%")]):r._e()],2)]}}])}),r._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:"200"},scopedSlots:r._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small",type:"primary",icon:"edit"},on:{click:function(e){return r.edit(t.$index,r.ticketData)}}},[r._v("保存")]),r._v(" "),a("el-button",{attrs:{size:"small",icon:"delete"},on:{click:function(e){return r.deleteRow(t.$index,r.ticketData)}}},[r._v("删除")])]}}])})],1),r._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:r.add}},[r._v("添加")])],1),r._v(" "),a("el-dialog",{attrs:{title:"添加",visible:r.dialogFormVisible,size:""},on:{"update:visible":function(e){r.dialogFormVisible=e}}},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:r.ruleForm,rules:r.rules,"label-width":"110px"}},[a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"总代理：",prop:"branch"}},[a("el-select",{staticClass:"form_item",attrs:{filterable:""},model:{value:r.ruleForm.branch,callback:function(e){r.$set(r.ruleForm,"branch",e)},expression:"ruleForm.branch"}},r._l(r.topBranchList,function(e,t){return a("el-option",{key:t,attrs:{label:e.Code+"|"+e.BranchName,value:e.Code+"|"+e.BranchName}})}),1)],1),r._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"提成类型：",prop:"type"}},[a("el-select",{staticClass:"form_item",model:{value:r.ruleForm.type,callback:function(e){r.$set(r.ruleForm,"type",e)},expression:"ruleForm.type"}},[a("el-option",{attrs:{value:"1",label:"新策略"}}),r._v(" "),a("el-option",{attrs:{value:"2",label:"老策略"}})],1)],1),r._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"是否金额：",prop:"IsAmount"}},[a("el-select",{staticClass:"form_item",model:{value:r.ruleForm.IsAmount,callback:function(e){r.$set(r.ruleForm,"IsAmount",e)},expression:"ruleForm.IsAmount"}},[a("el-option",{attrs:{value:"true",label:"是"}}),r._v(" "),a("el-option",{attrs:{value:"false",label:"否"}})],1)],1),r._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"升级等级：",prop:"UpgradeOrderNum"}},[a("el-input-number",{staticClass:"form_item",attrs:{controls:!1},model:{value:r.ruleForm.UpgradeOrderNum,callback:function(e){r.$set(r.ruleForm,"UpgradeOrderNum",e)},expression:"ruleForm.UpgradeOrderNum"}})],1),r._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"推荐人等级序号：",prop:"BranchOrderNum"}},[a("el-input-number",{staticClass:"form_item",attrs:{controls:!1},model:{value:r.ruleForm.BranchOrderNum,callback:function(e){r.$set(r.ruleForm,"BranchOrderNum",e)},expression:"ruleForm.BranchOrderNum"}})],1),r._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"提成分配：",prop:"rate"}},[a("el-input",{staticClass:"form_item",staticStyle:{margin:"5px 5px 0 0"},on:{change:function(e){return r.numCheck(r.ruleForm.rate)}},model:{value:r.ruleForm.rate,callback:function(e){r.$set(r.ruleForm,"rate",e)},expression:"ruleForm.rate"}},["false"==r.ruleForm.IsAmount?a("template",{slot:"append"},[r._v("%")]):r._e()],2)],1)],1),r._v(" "),a("div",{staticClass:"el-dialog__footer "},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return r.sure("ruleForm")}}},[r._v("确定")]),r._v(" "),a("el-button",{on:{click:function(e){return r.cancel("ruleForm")}}},[r._v("取消")])],1)],1)],1)},staticRenderFns:[]}},380:function(e,t,r){r(1669);var a=r(98)(r(1122),r(2141),"data-v-0e20b496",null);e.exports=a.exports}});