webpackJsonp([82],{1161:function(t,e,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=l(100),n=l.n(a),r=l(37),i=l.n(r),o=l(99),u=l.n(o),s=l(443),c=l.n(s),m=l(1640),d=(l.n(m),l(22),l(64)),p=l(436),h=l.n(p);e.default={data:function(){var t;return t={yearList:[],monthList:["01","02","03","04","05","06","07","08","09",10,11,12],loading:!1,total:0,size:10,currentPage:1,formInline:{batch:"",year:(new Date).getFullYear(),month:"",keywords:"",typeCode:"",hospitalCode:"",wareHouse:""},tableData:[],hospitalList:[],supplierList:[],whList:[],allData:[]},c()(t,"allData",[]),c()(t,"sum",{preQuantity:0,preRealPriceTotal:0,preSalePriceTotal:0,curInQuantity:0,curInRealPriceTotal:0,curInSalePriceTotal:0,curOutQuantity:0,curOutRealPriceTotal:0,curOutSalePriceTotal:0,curQuantity:0,curRealPriceTotal:0,curSalePriceTotal:0}),t},computed:{tHeader:function(){return["仓库","药品编号","药品名称","规格","批号","剂型","单位","产地","（上月结余）数量","（上月结余）进价总额","（上月结余）售价总额","（本月入库）数量","（本月入库）进价总额","（本月入库）售价总额","（本月出库）数量","（本月出库）进价总额","（本月出库）售价总额","（本月结存）数量","（本月结存）进价总额","（本月结存）售价总额"]},filterVal:function(){return["warehouseName","drugId","drugName","unitName","batchNumber","jiType","dwName","originAddress","preQuantity","preRealPriceTotal","preSalePriceTotal","curInQuantity","curInRealPriceTotal","curInSalePriceTotal","curOutQuantity","curOutRealPriceTotal","curOutSalePriceTotal","curQuantity","curRealPriceTotal","curSalePriceTotal"]},tableData1:function(){return this.allData},name:function(){return"进销存汇总"}},mounted:function(){var t=(new Date).getFullYear(),e=(new Date).getMonth()+1;this.formInline.year=t,this.formInline.month=10<=e?e:"0"+e;for(var a=0;a<4;a++)this.yearList.push(t-a);this.GetDropDownPermission()},methods:{hosSelect:function(e){var a=this;this.whList=[],this.allWhList.forEach(function(t){t.hospitalCode==e&&a.whList.push(t)})},getSummaries:function(){return["总合计","","","","","","","","",Math.round(this.sum.preQuantity),Math.round(this.sum.preRealPriceTotal),Math.round(this.sum.preSalePriceTotal),Math.round(this.sum.curInQuantity),Math.round(this.sum.curInRealPriceTotal),Math.round(this.sum.curInSalePriceTotal),Math.round(this.sum.curOutQuantity),Math.round(this.sum.curOutRealPriceTotal),Math.round(this.sum.curOutSalePriceTotal),Math.round(this.sum.curQuantity),Math.round(this.sum.curRealPriceTotal),Math.round(this.sum.curSalePriceTotal)]},GetDropDownPermission:function(){var r=this;return u()(n.a.mark(function t(){var e,a;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.i(d.d)({typeId:1});case 2:return e=t.sent,r.hospitalList=e.data,t.next=6,l.i(d.e)({hospitalCode:"",pageIndex:1,pageSize:100,keywords:"",typeId:1});case 6:a=t.sent,r.allWhList=JSON.parse(i()(a.data));case 8:case"end":return t.stop()}},t,r)}))()},GetStockDrugRep:function(a){var r=this;return u()(n.a.mark(function t(){var e;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r.loading=!0,t.next=4,l.i(d.J)(a);case 4:(e=t.sent).status?(r.allData=r.GetTotal(e.data),r.getPage(e.data),r.total=e.count):r.$message.error("查询失败"+e.errorMessage),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:case"end":return t.stop()}},t,r,[[0,8]])}))()},onSubmit:function(){for(var t in this.sum)this.sum[t]=0;this.currentPage=1,this.search()},search:function(){this.sum={preQuantity:0,preRealPriceTotal:0,preSalePriceTotal:0,curInQuantity:0,curInRealPriceTotal:0,curInSalePriceTotal:0,curOutQuantity:0,curOutRealPriceTotal:0,curOutSalePriceTotal:0,curQuantity:0,curRealPriceTotal:0,curSalePriceTotal:0},this.GetStockDrugRep({hospitalCode:this.formInline.hospitalCode,warehouseId:this.formInline.wareHouse,isBatch:this.formInline.batch,currentDate:this.formInline.year+"-"+this.formInline.month,keywords:this.formInline.keywords})},handleSizeChange:function(t){this.size=t,this.getPage()},handleCurrentChange:function(t){this.currentPage=t,this.getPage()},GetTotal:function(t){var e=this;return t.forEach(function(t){e.sum.preQuantity=e.sum.preQuantity.add(t.preQuantity),e.sum.preRealPriceTotal=e.sum.preRealPriceTotal.add(t.preRealPriceTotal),e.sum.preSalePriceTotal=e.sum.preSalePriceTotal.add(t.preSalePriceTotal),e.sum.curInQuantity=e.sum.curInQuantity.add(t.curInQuantity),e.sum.curInRealPriceTotal=e.sum.curInRealPriceTotal.add(t.curInRealPriceTotal),e.sum.curInSalePriceTotal=e.sum.curInSalePriceTotal.add(t.curInSalePriceTotal),e.sum.curOutQuantity=e.sum.curOutQuantity.add(t.curOutQuantity),e.sum.curOutRealPriceTotal=e.sum.curOutRealPriceTotal.add(t.curOutRealPriceTotal),e.sum.curOutSalePriceTotal=e.sum.curOutSalePriceTotal.add(t.curOutSalePriceTotal),e.sum.curQuantity=e.sum.curQuantity.add(t.curQuantity),e.sum.curRealPriceTotal=e.sum.curRealPriceTotal.add(t.curRealPriceTotal),e.sum.curSalePriceTotal=e.sum.curSalePriceTotal.add(t.curSalePriceTotal)}),t},getPage:function(){var t=this;this.loading=!0,this.tableData=this.allData.slice((this.currentPage-1)*this.size,this.currentPage*this.size),setTimeout(function(){t.loading=!1},500)}},components:{Export:h.a}}},1215:function(t,e,a){(t.exports=a(215)(!1)).push([t.i,".el-table--border th,.el-table__fixed-right-patch{border-bottom:1px solid #dee1e4!important}.el-table--border td,.el-table--border th{border-right:1px solid #dee1e4!important}.el-table td,.el-table th.is-leaf{border-bottom:1px solid #dee1e4!important}.el-table{overflow:hidden;width:100%;max-width:100%;background-color:#fff;border:1px solid #dee1e4!important;font-size:14px;color:#1f2d3d}",""])},1511:function(t,e,a){(t.exports=a(215)(!1)).push([t.i,".block[data-v-d69b1058]{float:right}",""])},1640:function(t,e,a){var r=a(1215);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a(216)("0d0f50ae",r,!0)},1936:function(t,e,a){var r=a(1511);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a(216)("bf806eca",r,!0)},2411:function(t,e){t.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tag selCommon"},[a("el-form",{staticClass:"demo-form-inline form_search",attrs:{inline:!0,model:e.formInline,"label-width":"90px"}},[a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"医院："}},[a("el-select",{staticStyle:{width:"200px"},on:{change:e.hosSelect},model:{value:e.formInline.hospitalCode,callback:function(t){e.$set(e.formInline,"hospitalCode",t)},expression:"formInline.hospitalCode"}},e._l(e.hospitalList,function(t,e){return a("el-option",{key:e,attrs:{label:t.supplierName,value:t.code}})}),1)],1),e._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"仓库："}},[a("el-select",{staticStyle:{width:"200px"},model:{value:e.formInline.wareHouse,callback:function(t){e.$set(e.formInline,"wareHouse",t)},expression:"formInline.wareHouse"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),e._l(e.whList,function(t,e){return a("el-option",{key:e,attrs:{label:t.warehouseName,value:t.id}})})],2)],1),e._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"年月："}},[a("el-select",{staticStyle:{width:"95px"},model:{value:e.formInline.year,callback:function(t){e.$set(e.formInline,"year",t)},expression:"formInline.year"}},e._l(e.yearList,function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})}),1),e._v(" "),a("el-select",{staticStyle:{width:"95px"},model:{value:e.formInline.month,callback:function(t){e.$set(e.formInline,"month",t)},expression:"formInline.month"}},e._l(e.monthList,function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})}),1)],1),e._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"按批号显示："}},[a("el-select",{staticStyle:{width:"200px"},model:{value:e.formInline.batch,callback:function(t){e.$set(e.formInline,"batch",t)},expression:"formInline.batch"}},[a("el-option",{attrs:{label:"是",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"否",value:"0"}})],1)],1),e._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"关键字："}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSubmit(t)}},model:{value:e.formInline.keywords,callback:function(t){e.$set(e.formInline,"keywords",t)},expression:"formInline.keywords"}})],1),e._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:" "}},[a("el-button",{staticClass:"searchBtn",attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("查询")]),e._v(" "),a("Export",{ref:"exportTable",attrs:{tHeader:e.tHeader,filterVal:e.filterVal,tableData1:e.tableData1,name:e.name}})],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"smt min_table",staticStyle:{width:"100%","margin-top":"15px","margin-bottom":"10px"},attrs:{data:e.tableData,border:"","max-height":"660","show-summary":"","summary-method":e.getSummaries}},[a("el-table-column",{attrs:{prop:"warehouseName",label:"仓库","min-width":"70"}}),e._v(" "),a("el-table-column",{attrs:{prop:"drugId",label:"药品编号","min-width":"70"}}),e._v(" "),a("el-table-column",{attrs:{prop:"drugName",label:"药品名称","min-width":"90"}}),e._v(" "),a("el-table-column",{attrs:{prop:"unitName",label:"规格","min-width":"90"}}),e._v(" "),a("el-table-column",{attrs:{prop:"batchNumber",label:"批号","min-width":"90"}}),e._v(" "),a("el-table-column",{attrs:{prop:"jiType",label:"剂型","min-width":"60"}}),e._v(" "),a("el-table-column",{attrs:{prop:"dwName",label:"单位","min-width":"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"originAddress",label:"产地","min-width":"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"manufacturer",label:"厂商","min-width":"110"}}),e._v(" "),a("el-table-column",{attrs:{prop:"dwName",label:"上月结余","min-width":"70"}},[a("el-table-column",{attrs:{prop:"preQuantity",label:"数量","min-width":"60"}}),e._v(" "),a("el-table-column",{attrs:{prop:"dwName",label:"总金额","min-width":"70"}},[a("el-table-column",{attrs:{prop:"preRealPriceTotal",label:"进价","min-width":"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"preSalePriceTotal",label:"零售价","min-width":"80"}})],1)],1),e._v(" "),a("el-table-column",{attrs:{prop:"dwName",label:"本月入库","min-width":"70"}},[a("el-table-column",{attrs:{prop:"curInQuantity",label:"数量","min-width":"60"}}),e._v(" "),a("el-table-column",{attrs:{prop:"dwName",label:"总金额","min-width":"70"}},[a("el-table-column",{attrs:{prop:"curInRealPriceTotal",label:"进价","min-width":"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"curInSalePriceTotal",label:"零售价","min-width":"80"}})],1)],1),e._v(" "),a("el-table-column",{attrs:{prop:"dwName",label:"本月出库","min-width":"70"}},[a("el-table-column",{attrs:{prop:"curOutQuantity",label:"数量","min-width":"60"}}),e._v(" "),a("el-table-column",{attrs:{prop:"dwName",label:"总金额","min-width":"70"}},[a("el-table-column",{attrs:{prop:"curOutRealPriceTotal",label:"出库价","min-width":"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"curOutSalePriceTotal",label:"售价","min-width":"80"}})],1)],1),e._v(" "),a("el-table-column",{attrs:{prop:"dwName",label:"本月结存","min-width":"70"}},[a("el-table-column",{attrs:{prop:"curQuantity",label:"数量","min-width":"60"}}),e._v(" "),a("el-table-column",{attrs:{prop:"dwName",label:"总金额","min-width":"70"}},[a("el-table-column",{attrs:{prop:"curRealPriceTotal",label:"进价","min-width":"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"curSalePriceTotal",label:"零售价","min-width":"80"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]}},406:function(t,e,a){a(1936);var r=a(98)(a(1161),a(2411),"data-v-d69b1058",null);t.exports=r.exports},436:function(t,e,a){a(439);var r=a(98)(a(437),a(440),"data-v-6c47323e",null);t.exports=r.exports},437:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{tHeader:{},filterVal:{},tableData1:{type:Array},name:""},watch:{tableData1:{handler:function(t){this.otData=t},deep:!0}},data:function(){return{otData:[]}},methods:{handleDownload:function(){var a=this;r.e(220).then(function(){var t=r(448).export_json_to_excel,e=[];e=0!=a.otData.length?a.formatJson(a.filterVal,a.otData):a.formatJson(a.filterVal,a.tableData1),t(a.tHeader,e,a.name)}.bind(null,r)).catch(r.oe)},formatJson:function(t,e){return e.map(function(e){return t.map(function(t){return e[t]})})}}}},438:function(t,e,a){(t.exports=a(215)(!1)).push([t.i,".exportBtn[data-v-6c47323e]{background:#fff;border:1px solid #d6d4d4;font-size:14px;color:#666;border-radius:4px}",""])},439:function(t,e,a){var r=a(438);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a(216)("fdf4f478",r,!0)},440:function(t,e){t.exports={render:function(){var t=this.$createElement;return(this._self._c||t)("el-button",{staticClass:"exportBtn",attrs:{type:"primary"},on:{click:this.handleDownload}},[this._v("导出报表")])},staticRenderFns:[]}},443:function(t,e,a){"use strict";e.__esModule=!0;var r,l=a(444),n=(r=l)&&r.__esModule?r:{default:r};e.default=function(t,e,a){return e in t?(0,n.default)(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}},444:function(t,e,a){t.exports={default:a(445),__esModule:!0}},445:function(t,e,a){a(446);var r=a(2).Object;t.exports=function(t,e,a){return r.defineProperty(t,e,a)}},446:function(t,e,a){var r=a(9);r(r.S+r.F*!a(10),"Object",{defineProperty:a(11).f})}});