webpackJsonp([103],{1201:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i(100),r=i.n(a),n=i(99),s=i.n(n),o=i(443),l=i.n(o),u=(i(101),i(65)),c=(i.n(u),i(22),i(64)),m=i(436),d=i.n(m);e.default={data:function(){var t;return{ExportLoading:!1,date:"",editMes:[],loading:!1,detLoading:!1,ticketsDet:!1,title:"",inOutDet:!1,total:0,size:10,currentPage:1,checked:!1,formInline:(t={startDate:"",endDate:"",keywords:"",typeCode:"",hospitalCode:"",wareHouse:"",IsEnable:"",remainNum:!1},l()(t,"startDate",""),l()(t,"endDate",""),t),allData:[],tableData:[],hospitalList:[],supplierList:[],whList:[],allWhList:[],detData:[],sumData:{},dynamicTags:[]}},computed:{tHeader:function(){return["日期","卡券名称","印制入库","调拨入库","调拨出库","套餐发放","日常销售","赠送出库","销毁报废","其它出库","退货出库","库存"]},filterVal:function(){return["ticketDate","ticketName","ticketInCount1","ticketInCount2","ticketoutCount1","ticketoutCount2","ticketoutCount3","ticketoutCount4","ticketoutCount5","ticketoutCount6","ticketoutCount7","remainCount"]},tableData1:function(){return this.allData},name:function(){return"卡券库存明细"}},mounted:function(){this.date=[new Date,new Date],this.GetDropDownPermission()},methods:{dateChange:function(t){t?(t=t.formatDates(),this.formInline.startDate=t.substring(0,10),this.formInline.endDate=t.substring(13)):(this.formInline.startDate="",this.formInline.endDate="")},hosChange:function(e){var a=this;this.whList=[],this.formInline.wareHouse="",this.allWhList.forEach(function(t){t.hospitalCode==e&&a.whList.push(t)})},showReaminDet:function(e,a){var n=this;return s()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.title=a,n.dynamicTags=[],n.ticketsDet=!0,t.next=5,i.i(c.p)({TicketId:e.ticketId,TicketCodePre:e.ticketPrefixCode,numcount:e.numCount,warehouseId:e.warehouseId});case 5:t.sent.data.forEach(function(t){n.dynamicTags.push(t.ticketCode)});case 7:case"end":return t.stop()}},t,n)}))()},getSummaries:function(){var t=this.sumData.ticketInCount2+this.sumData.ticketInCount1,e=this.sumData.ticketoutCount1+this.sumData.ticketoutCount2+this.sumData.ticketoutCount3+this.sumData.ticketoutCount4+this.sumData.ticketoutCount5+this.sumData.ticketoutCount6+this.sumData.ticketoutCount7;return["合计","","",this.sumData.ticketInCount1,this.sumData.ticketInCount2,t,this.sumData.ticketoutCount1,this.sumData.ticketoutCount2,this.sumData.ticketoutCount3,this.sumData.ticketoutCount4,this.sumData.ticketoutCount5,this.sumData.ticketoutCount6,this.sumData.ticketoutCount7,e,t-e]},GetDropDownPermission:function(){var n=this;return s()(r.a.mark(function t(){var e,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.i(c.d)({typeId:1});case 2:return e=t.sent,n.hospitalList=e.data,t.next=6,i.i(c.e)({hospitalCode:"",pageIndex:1,pageSize:100,keywords:"",typeId:2});case 6:a=t.sent,n.allWhList=a.data,n.formInline.hospitalCode=n.hospitalList[0].code;case 9:case"end":return t.stop()}},t,n)}))()},GetStockTicket:function(a,n){var o=this;return s()(r.a.mark(function t(){var e;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n?o.ExportLoading=!0:o.loading=!0,t.next=4,i.i(c.q)(a);case 4:e=t.sent,n?(o.allData=o.calData(e.data),o.ExportLoading=!1,setTimeout(function(){o.$refs.exportTable.handleDownload()},10)):(o.tableData=o.calData(e.data),o.sumData=e.sumdata[0]),o.total=e.count,o.loading=!1,t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.log(t.t0);case 13:case"end":return t.stop()}},t,o,[[0,10]])}))()},calData:function(t){return t.forEach(function(t){t.sumData1=t.ticketInCount1+t.ticketInCount2,t.sumData2=t.ticketoutCount1+t.ticketoutCount2+t.ticketoutCount3+t.ticketoutCount4+t.ticketoutCount5+t.ticketoutCount6+t.ticketoutCount7,t.remainCount=t.sumData1-t.sumData2}),t},onSubmit:function(){this.currentPage=1,this.search()},search:function(t){this.GetStockTicket({pageIndex:t?1:this.currentPage,pageSize:t?this.total:this.size,startDate:this.formInline.startDate,endDate:this.formInline.endDate,Keywords:this.formInline.keywords.removeSP(),WarehouseId:this.formInline.wareHouse,HospitalCode:this.formInline.hospitalCode},t||"")},handleSizeChange:function(t){this.size=t,this.search()},handleCurrentChange:function(t){this.currentPage=t,this.search()}},components:{Export:d.a}}},1364:function(t,e,a){(t.exports=a(215)(!1)).push([t.i,".tag[data-v-4acd6ae8]{margin:5px}",""])},1789:function(t,e,a){var n=a(1364);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a(216)("06fd1124",n,!0)},2261:function(t,e){t.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tag selCommon"},[a("el-form",{staticClass:"demo-form-inline form_search",attrs:{inline:!0,model:e.formInline,"label-width":"80px"}},[a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"出库日期："}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"daterange",placeholder:"选择日期"},on:{change:e.dateChange},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1),e._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"医院："}},[a("el-select",{staticStyle:{width:"200px"},on:{change:e.hosChange},model:{value:e.formInline.hospitalCode,callback:function(t){e.$set(e.formInline,"hospitalCode",t)},expression:"formInline.hospitalCode"}},e._l(e.hospitalList,function(t,e){return a("el-option",{key:e,attrs:{label:t.supplierName,value:t.code}})}),1)],1),e._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"仓库："}},[a("el-select",{staticStyle:{width:"200px"},model:{value:e.formInline.wareHouse,callback:function(t){e.$set(e.formInline,"wareHouse",t)},expression:"formInline.wareHouse"}},e._l(e.whList,function(t,e){return a("el-option",{key:e,attrs:{label:t.warehouseName,value:t.id}})}),1)],1),e._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"关键字："}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSubmit(t)}},model:{value:e.formInline.keywords,callback:function(t){e.$set(e.formInline,"keywords",t)},expression:"formInline.keywords"}})],1),e._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:""}},[a("el-button",{staticClass:"searchBtn",attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("查询")]),e._v(" "),a("el-button",{staticClass:"searchBtn",attrs:{type:"primary",loading:e.ExportLoading},on:{click:function(t){return e.search(1)}}},[e._v("导出报表")]),e._v(" "),a("Export",{ref:"exportTable",staticStyle:{display:"none"},attrs:{tHeader:e.tHeader,filterVal:e.filterVal,tableData1:e.tableData1,name:e.name}})],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"smt min_table",staticStyle:{width:"100%","margin-top":"15px","margin-bottom":"10px"},attrs:{data:e.tableData,border:"","max-height":"560","show-summary":"","summary-method":e.getSummaries}},[a("el-table-column",{attrs:{prop:"ticketDate",label:"日期","min-width":"90"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ticketName",label:"卡券名称","min-width":"90"}}),e._v(" "),a("el-table-column",{attrs:{label:"数量单位","min-width":"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("张")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"warehouseName",label:"票券入库","min-width":"270"}},[a("el-table-column",{attrs:{prop:"ticketInCount1",label:"印制入库","min-width":"90"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ticketInCount2",label:"调拨入库","min-width":"90"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sumData1",label:"合计","min-width":"90"}})],1),e._v(" "),a("el-table-column",{attrs:{prop:"warehouseName",label:"票券出库","min-width":"630"}},[a("el-table-column",{attrs:{prop:"ticketoutCount1",label:"调拨出库","min-width":"90"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ticketoutCount2",label:"套餐发放","min-width":"90"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ticketoutCount3",label:"日常销售","min-width":"90"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ticketoutCount4",label:"赠送出库","min-width":"90"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ticketoutCount5",label:"销毁报废","min-width":"90"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ticketoutCount6",label:"其它出库","min-width":"90"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ticketoutCount7",label:"退货出库","min-width":"90"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sumData2",label:"合计","min-width":"90"}})],1),e._v(" "),a("el-table-column",{attrs:{prop:"remainCount",label:"票券库存","min-width":"90",align:"center"}})],1),e._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]}},432:function(t,e,a){a(1789);var n=a(98)(a(1201),a(2261),"data-v-4acd6ae8",null);t.exports=n.exports},436:function(t,e,a){a(439);var n=a(98)(a(437),a(440),"data-v-6c47323e",null);t.exports=n.exports},437:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{tHeader:{},filterVal:{},tableData1:{type:Array},name:""},watch:{tableData1:{handler:function(t){this.otData=t},deep:!0}},data:function(){return{otData:[]}},methods:{handleDownload:function(){var a=this;n.e(220).then(function(){var t=n(448).export_json_to_excel,e=[];e=0!=a.otData.length?a.formatJson(a.filterVal,a.otData):a.formatJson(a.filterVal,a.tableData1),t(a.tHeader,e,a.name)}.bind(null,n)).catch(n.oe)},formatJson:function(t,e){return e.map(function(e){return t.map(function(t){return e[t]})})}}}},438:function(t,e,a){(t.exports=a(215)(!1)).push([t.i,".exportBtn[data-v-6c47323e]{background:#fff;border:1px solid #d6d4d4;font-size:14px;color:#666;border-radius:4px}",""])},439:function(t,e,a){var n=a(438);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a(216)("fdf4f478",n,!0)},440:function(t,e){t.exports={render:function(){var t=this.$createElement;return(this._self._c||t)("el-button",{staticClass:"exportBtn",attrs:{type:"primary"},on:{click:this.handleDownload}},[this._v("导出报表")])},staticRenderFns:[]}},443:function(t,e,a){"use strict";e.__esModule=!0;var n,o=a(444),i=(n=o)&&n.__esModule?n:{default:n};e.default=function(t,e,a){return e in t?(0,i.default)(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}},444:function(t,e,a){t.exports={default:a(445),__esModule:!0}},445:function(t,e,a){a(446);var n=a(2).Object;t.exports=function(t,e,a){return n.defineProperty(t,e,a)}},446:function(t,e,a){var n=a(9);n(n.S+n.F*!a(10),"Object",{defineProperty:a(11).f})}});