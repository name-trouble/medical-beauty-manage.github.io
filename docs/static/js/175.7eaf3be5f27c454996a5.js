webpackJsonp([175],{1117:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(100),l=i.n(n),a=i(99),o=i.n(a),r=i(37),s=i.n(r),c=i(101),m=i(441),u=i(64),p=i(22),f=i(65),h=(i.n(f),c.a+m.a+"?op=branchshop");t.default={data:function(){return{uploadUrl:h,baseImgPath:c.b,acceptImage:m.b,dialogVisible:!1,dialogImageUrl:"",fileList:[],saveLoading:!1,loading:!1,options:[],optionsB:[],dialogFormVisible:[!1,!1,!1],total:0,size:10,currentPage:1,agentList:[],formInline:{keywords:"",date1:"",startTime:"",endTime:"",rec:"",grade:"",branch:""},tableData:[],form:{ReferrerName:"",ReferrerCode:"",branchName:"",branchCode:"",value:"",reason:"",branchObj:""},multipleSelection:[],rules:{branchObj:[{required:!0,message:"请选择",trigger:"blur"}],value:[{required:!0,message:"请选择",trigger:"blur"}],reason:[{required:!0,message:"请填写",trigger:"blur"}]}}},computed:{tHeader:function(){return["代理编号","姓名","代理等级","联系电话","身份证号","缴纳押金","推荐人","状态"]},filterVal:function(){return["Code","BranchName","BranchGradeName","PhoneNumber","IDCard","Pledge","ReferrerName","IsEnable"]},name:function(){return"迁移记录"},tableData1:function(){var e=JSON.parse(s()(this.tableData));return e.forEach(function(e){0==e.IsEnable&&(e.IsEnable="未启用"),1==e.IsEnable&&(e.IsEnable="已启用"),2==e.IsEnable&&(e.IsEnable="退会")}),e}},watch:{"form.branchObj":{handler:function(e){0<e.length&&(this.form.ReferrerName=e.split("|")[2],this.form.ReferrerCode=e.split("|")[3],this.form.branchName=e.split("|")[0],this.form.branchCode=e.split("|")[1])},deep:!0}},mounted:function(){this.GetBranchGrade()},methods:{viewPhoto:function(e){this.dialogImageUrl=e.imageUrl.split(","),this.dialogVisible=!0},success:function(e,t,n){this.fileList=n},handleRemove:function(e,t){this.DelImg(e),this.fileList=t},handlePictureCardPreview:function(e){this.dialogImageUrl=e.response,this.dialogVisible=!0},DelImg:function(n){var a=this;return o()(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.i(u._73)({filepath:n});case 2:(t=e.sent).status||a.$message({message:"原图片删除失败！"+t.errorMessage,type:"warning"});case 4:case"end":return e.stop()}},e,a)}))()},GetBranchByKeywords:function(n,a){var r=this;return o()(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.i(u._60)(n);case 3:t=e.sent,1==a?r.optionsB=t:r.options=t,r.loading=!1,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}},e,r,[[0,8]])}))()},GetBranchGrade:function(){var n=this;return o()(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.i(u._319)();case 3:t=e.sent,n.agentList=t,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}},e,n,[[0,7]])}))()},GetBranchChangeLogList:function(n){var a=this;return o()(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.i(u._355)(n);case 3:(t=e.sent).status&&(a.total=t.count,a.tableData=t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}},e,a,[[0,7]])}))()},BranchChange:function(n){var a=this;return o()(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.saveLoading=!0,e.next=4,i.i(u._352)(n);case 4:(t=e.sent).success?(a.$message({message:"迁移成功",type:"success"}),a.dialogOpe(1,!1),a.search()):a.$message.error("操作失败"+t.error),a.saveLoading=!1,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}},e,a,[[0,9]])}))()},handleSelectionChange:function(e){this.multipleSelection=e},handleSizeChange:function(e){console.log("每页 "+e+" 条"),this.size=e,this.search()},handleCurrentChange:function(e){console.log("当前页: "+e),this.currentPage=e,this.search()},dateForm1:function(e){e=e.formatDates(),this.formInline.startTime=e.substring(0,10),this.formInline.endTime=e.substring(13)},search:function(){this.GetBranchChangeLogList({startDate:this.formInline.startTime,endDate:this.formInline.endTime,pageIndex:this.currentPage,pageSize:this.size,Keywords:this.formInline.keywords.removeSP()})},onSubmit:function(){this.currentPage=1,this.search()},log:function(e,t,n){this.form=t[e],this.GetChangeLog({branchCode:t[e].Code}),this.dialogOpe(n,!0)},move:function(){this.reset(),this.reason="",this.value="",this.dialogOpe(1,!0)},dialogOpe:function(e,t){this.dialogFormVisible[e]=t,this.dialogFormVisible.push()},remoteMethod:function(e){""!==e?(this.loading=!0,this.loading=!1,this.GetBranchByKeywords({keyWords:e.removeSP()},2)):this.options=[]},remoteMethodB:function(e){""!==e?(this.loading=!0,this.loading=!1,this.GetBranchByKeywords({keyWords:e.removeSP()},1)):this.options=[]},sure:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.BranchChange({IsEnable:"1",branchCode:t.form.branchCode,branchName:t.form.branchName,refCode:t.form.value.split(",")[1],refName:t.form.value.split(",")[0],changeReason:t.form.reason,operatorName:i.i(p.b)("userName"),imageUrl:t.getImg()})})},getImg:function(){var t=[];return this.fileList.forEach(function(e){t.push(e.response)}),t.join(",")},cancel:function(){this.dialogOpe(1,!1)},reset:function(){for(var e in this.form)this.form[e]="";this.branchObj=""}},components:{}}},1397:function(e,t,n){(e.exports=n(215)(!1)).push([e.i,"",""])},1822:function(e,t,n){var a=n(1397);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n(216)("15c24336",a,!0)},2295:function(e,t){e.exports={render:function(){var n=this,e=n.$createElement,a=n._self._c||e;return a("div",{staticClass:"selCommon teamMigrate"},[a("el-form",{staticClass:"demo-form-inline form_search",attrs:{inline:!0,model:n.formInline,"label-width":"80px"}},[a("el-form-item",{staticClass:"form_item_mt10 ",attrs:{label:"时间范围："}},[a("el-date-picker",{staticClass:"wt200",attrs:{type:"daterange",placeholder:"选择日期范围"},on:{change:n.dateForm1},model:{value:n.formInline.date1,callback:function(e){n.$set(n.formInline,"date1",e)},expression:"formInline.date1"}})],1),n._v(" "),a("el-form-item",{staticClass:"form_item_mt10 form_item_wh280",attrs:{label:"关键字："}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"消费商/前推荐人/后推荐人"},model:{value:n.formInline.keywords,callback:function(e){n.$set(n.formInline,"keywords",e)},expression:"formInline.keywords"}})],1),n._v(" "),a("el-form-item",{staticClass:"form_item_mt10 form_item_wh280",attrs:{label:" "}},[a("el-button",{staticClass:"searchBtn",attrs:{type:"primary"},on:{click:n.onSubmit}},[n._v("查询")]),n._v(" "),a("el-button",{staticClass:"searchBtn",attrs:{type:"primary"},on:{click:n.move}},[n._v("团队迁移")])],1)],1),n._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%","margin-top":"15px","margin-bottom":"10px","min-height":"400px"},attrs:{data:n.tableData,"max-height":"660"},on:{"selection-change":n.handleSelectionChange}},[a("el-table-column",{attrs:{prop:"createOn",label:"变迁时间","min-width":"100"},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v("\n                "+n._s(e.row.createOn.substring(0,10))+"\n            ")]}}])}),n._v(" "),a("el-table-column",{attrs:{prop:"branchName",label:"消费商","min-width":"100"},scopedSlots:n._u([{key:"default",fn:function(e){return[e.row.branchName?a("span",[n._v(n._s(e.row.branchName)+"["+n._s(e.row.branchCode)+"]")]):n._e()]}}])}),n._v(" "),a("el-table-column",{attrs:{prop:"beforeRefName",label:"前推荐人","min-width":"100"},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v("\n                "+n._s(e.row.beforeRefName)+"\n                "),e.row.beforeRefCode?a("span",[n._v("\n                    ["+n._s(e.row.beforeRefCode)+"]\n                ")]):n._e()]}}])}),n._v(" "),a("el-table-column",{attrs:{prop:"branchGradeName",label:"","min-width":"80"},scopedSlots:n._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"}},[a("i",{staticClass:"el-icon-d-arrow-right"})])]}}])}),n._v(" "),a("el-table-column",{attrs:{prop:"afterRefName",label:"后推荐人","min-width":"100"},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v("\n                "+n._s(e.row.afterRefName)+"\n                "),e.row.afterRefCode?a("span",[n._v("\n                    ["+n._s(e.row.afterRefCode)+"]\n                ")]):n._e()]}}])}),n._v(" "),a("el-table-column",{attrs:{prop:"changeReason",label:"变迁原因","min-width":"150"}}),n._v(" "),a("el-table-column",{attrs:{prop:"createBy",label:"操作人","min-width":"100"}}),n._v(" "),a("el-table-column",{attrs:{prop:"createBy",label:"操作人","min-width":"100"},scopedSlots:n._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return n.viewPhoto(t.row)}}},[n._v("查看凭证")])]}}])})],1),n._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":n.currentPage,"page-sizes":[10,20,30,40],"page-size":n.size,layout:"total, sizes, prev, pager, next, jumper",total:n.total},on:{"size-change":n.handleSizeChange,"current-change":n.handleCurrentChange}})],1),n._v(" "),a("el-dialog",{attrs:{title:"迁移",visible:n.dialogFormVisible[1],size:""},on:{"update:visible":function(e){return n.$set(n.dialogFormVisible,1,e)}}},[a("el-form",{ref:"form",staticStyle:{width:"500px"},attrs:{model:n.form,rules:n.rules,"label-width":"110px"}},[a("el-form-item",{staticClass:"form_item_mt0",attrs:{label:"消费商：",prop:"branchObj"}},[a("el-select",{staticStyle:{float:"none"},attrs:{filterable:"",remote:"",placeholder:"请输入关键词","remote-method":n.remoteMethodB,loading:n.loading},model:{value:n.form.branchObj,callback:function(e){n.$set(n.form,"branchObj",e)},expression:"form.branchObj"}},n._l(n.optionsB,function(e){return a("el-option",{key:e.code,attrs:{label:e.BranchName+"|"+e.PhoneNumber,value:e.BranchName+"|"+e.Code+"|"+e.ReferrerName+"|"+e.ReferrerCode}})}),1)],1),n._v(" "),a("el-form-item",{staticClass:"form_item_mt0",attrs:{label:"推荐人："}},[a("span",[n._v(n._s(n.form.ReferrerName)+n._s(n.form.ReferrerCode))])]),n._v(" "),a("el-form-item",{staticClass:"form_item_mt0",attrs:{label:"推荐人变更为：",prop:"value"}},[a("el-select",{staticStyle:{float:"none"},attrs:{filterable:"",remote:"",placeholder:"请输入关键词","remote-method":n.remoteMethod,loading:n.loading},model:{value:n.form.value,callback:function(e){n.$set(n.form,"value",e)},expression:"form.value"}},n._l(n.options,function(e){return a("el-option",{key:e.Code,attrs:{label:e.BranchName+"("+e.Code+")",value:e.BranchName+","+e.Code}})}),1),n._v(" "),a("br"),n._v(" "),a("span",{staticStyle:{float:"none"}},[n._v("请输入推荐人姓名、推荐人编号查找推荐人")])],1),n._v(" "),a("el-form-item",{staticClass:"form_item_mt0",attrs:{label:"迁移原因：",prop:"reason"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{type:"textarea"},model:{value:n.form.reason,callback:function(e){n.$set(n.form,"reason",e)},expression:"form.reason"}})],1),n._v(" "),a("el-form-item",{staticClass:"form_item_mt0",attrs:{label:"上传凭证：",prop:"reason"}},[a("el-upload",{attrs:{action:n.uploadUrl,"list-type":"picture-card",acceptImage:n.acceptImage,"on-success":n.success,fileList:n.fileList,"on-remove":n.handleRemove}},[a("i",{staticClass:"el-icon-plus"})])],1),n._v(" "),a("span",{staticStyle:{color:"red","line-height":"20px !important"}},[n._v("迁移后，消费商“"+n._s(n.form.branchName)+"”及其所有直推代理人将全部迁移至新推荐人。请谨慎操作！")])],1),n._v(" "),a("div",{staticClass:"footer_ope"},[a("el-button",{attrs:{type:"primary",loading:n.saveLoading},on:{click:function(e){return n.sure("form")}}},[n._v("确定")]),n._v(" "),a("el-button",{on:{click:function(e){return n.cancel("form")}}},[n._v("取消")])],1)],1),n._v(" "),a("el-dialog",{attrs:{title:"查看凭证",size:"small"},model:{value:n.dialogVisible,callback:function(e){n.dialogVisible=e},expression:"dialogVisible"}},n._l(n.dialogImageUrl,function(e,t){return a("img",{key:t,staticStyle:{height:"400px",width:"auto"},attrs:{width:"100%",src:n.baseImgPath+e,alt:""}})}),0)],1)},staticRenderFns:[]}},375:function(e,t,n){n(1822);var a=n(98)(n(1117),n(2295),"data-v-5a7530b3",null);e.exports=a.exports},441:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"d",function(){return l}),n.d(t,"e",function(){return i}),n.d(t,"c",function(){return o});var a="image/gif,image/jpeg,image/jpg,image/png,image/svg",r="/Image/UploadImg",i="9",l=[{name:"中国",value:"01"},{name:"中国台湾",value:"02"},{name:"韩国",value:"03"},{name:"美国",value:"04"}],o=[{name:"网页",linkType:"0",linkUrl:""},{name:"热门",linkType:"1",linkUrl:"0"},{name:"直播",linkType:"1",linkUrl:"1"},{name:"视频",linkType:"1",linkUrl:"2"},{name:"问答",linkType:"1",linkUrl:"4"},{name:"精选案例",linkType:"2",linkUrl:"0"},{name:"最新案例",linkType:"2",linkUrl:"1"},{name:"附近案例",linkType:"2",linkUrl:"2"},{name:"医院详情",linkType:"3",linkUrl:""},{name:"医生详情",linkType:"4",linkUrl:""},{name:"项目详情",linkType:"5",linkUrl:""},{name:"商品详情",linkType:"6",linkUrl:""},{name:"案例详情",linkType:"7",linkUrl:""},{name:"卡券详情",linkType:"8",linkUrl:""},{name:"活动详情",linkType:"9",linkUrl:""},{name:"问答详情",linkType:"10",linkUrl:""},{name:"视频详情",linkType:"11",linkUrl:""},{name:"直播详情",linkType:"12",linkUrl:""},{name:"医美百科",linkType:"13",linkUrl:""},{name:"金牌设计",linkType:"14",linkUrl:""},{name:"抽奖中心",linkType:"15",linkUrl:""},{name:"红包专区",linkType:"16",linkUrl:""},{name:"html扩展页面",linkType:"17",linkUrl:""},{name:"医院列表",linkType:"18",linkUrl:""},{name:"项目列表",linkType:"19",linkUrl:""},{name:"卡券列表",linkType:"20",linkUrl:""},{name:"医生列表",linkType:"21",linkUrl:""},{name:"活动列表",linkType:"22",linkUrl:""},{name:"商家列表",linkType:"23",linkUrl:""},{name:"商家商品列表",linkType:"24",linkUrl:""},{name:"商家详情",linkType:"25",linkUrl:""},{name:"商家商品详情",linkType:"26",linkUrl:""},{name:"我的-订单",linkType:"27",linkUrl:"0"},{name:"我的-邀请好友",linkType:"27",linkUrl:"1"},{name:"我的-我的消息",linkType:"27",linkUrl:"2"},{name:"我的-我的收藏",linkType:"27",linkUrl:"3"},{name:"我的-身份认证",linkType:"27",linkUrl:"4"},{name:"我的-我的财富",linkType:"27",linkUrl:"5"},{name:"我的-关于我们",linkType:"27",linkUrl:"6"},{name:"我的-联系我们",linkType:"27",linkUrl:"7"},{name:"我的-信息咨询",linkType:"27",linkUrl:"8"},{name:"医院中心",linkType:"28",linkUrl:"0"},{name:"销售公司",linkType:"28",linkUrl:"1"},{name:"消费商",linkType:"28",linkUrl:"2"},{name:"商家中心",linkType:"28",linkUrl:"3"}]}});