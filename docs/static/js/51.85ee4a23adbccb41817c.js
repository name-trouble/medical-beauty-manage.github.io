webpackJsonp([51],{1073:function(e,t,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=u(37),i=u.n(a),r=u(100),p=u.n(r),o=u(66),d=u.n(o),l=u(102),h=u.n(l),n=u(99),s=u.n(n),f=u(64),c=u(22),m=u(567),b=u.n(m);t.default={props:{detailCode:"",title:"",branchCode:""},data:function(){return{saveLoading:!1,editMes:{},editIndex:"",payWayList:[],hosForm:{},supplyList:[],show:!1,accountList:[],IdentityType:"",bonusData:[],form:{type:"",PayTypeName:"",PayType:"",RealAmount:0,Memo:"",ReceiveAccount:"",sxf:0,payDate:new Date},dialogFormVisible:!1,dialogTableVisible1:!1,payTable:[],ReferrerCode:"",integral:0,ticketsList:[],packageAll:[],packageVal:[],gradeList:[],tableData:[],ruleForm:{order:!1,formNum:"",Hospital:"",identityType:"",payAmount:"",grade:"",BranchName:"",Sex:"",Code:"",BranchGradeName:"",PhoneNumber:"",Pledge:0},allGrade:[],oldPackCode:"",packageList:[],rules:{Hospital:[{required:!0,message:"请选择",trigger:"change"}],identityType:[{required:!0,message:"请选择",trigger:"change"}],grade:[{required:!0,message:"请选择",trigger:"change"}]},baseData:{}}},computed:{total:function(){var t=0;return this.payTable&&0<this.payTable.length?this.payTable.forEach(function(e){t+=Number(e.realAmount)}):t=0,t},disabled:function(){return"edit"==this.title||1==this.ruleForm.identityType}},watch:{"ruleForm.grade":{handler:function(t){var a=this,r="";this.gradeList.forEach(function(e){e.Code==t&&(r=e.OrderNum,"终结"==e.GradeProperty?a.show=!0:a.show=!1)}),this.packGradeSelect(r)},deep:!0},packageVal:{handler:function(e){this.getTickSplit(e)},deep:!0}},mounted:function(){this.GetBranchUpgradeApplyById()},filters:{filterFunB:function(e){var t=0;return e&&0<e.length?e.forEach(function(e){t+=Number(e.Bonus)}):t=0,t}},methods:{GetBranchUpgradeApplyById:function(){var i=this;return s()(p.a.mark(function e(){var t,a,r,o;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.all([u.i(f._365)({id:i.detailCode}),u.i(f._51)({branchcode:i.branchCode})]);case 2:t=e.sent,a=h()(t,2),r=a[0],o=a[1],i.baseData=r.data.bua,i.payTable=r.data.bop,i.oldPackCode=o.Branch.ConPackage?o.Branch.ConPackage:"",i.getBranchGradeAll();case 9:case"end":return e.stop()}},e,i)}))()},EnableBranchUpgradeApply:function(a){var r=this;return s()(p.a.mark(function e(){var t;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.i(f._366)(a);case 2:(t=e.sent).status?(r.$message({message:"启用成功",type:"success"}),r.$emit("upClose",close)):r.$message.error("启用失败"+t.errorMessage),r.saveLoading=!1;case 5:case"end":return e.stop()}},e,r)}))()},paySelect:function(){this.form.PayTypeName=this.form.type.name,this.form.PayType=this.form.type.value},UpdateBranchUpgradeApply:function(a){var r=this;return s()(p.a.mark(function e(){var t;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.i(f._367)(a);case 3:(t=e.sent).status?(r.$message({message:"编辑成功",type:"success"}),r.$emit("upClose",close)):r.$message.error("编辑失败"+t.errorMessage),r.saveLoading=!1,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}},e,r,[[0,8]])}))()},getTicketsAll:function(){var a=this;return s()(p.a.mark(function e(){var t;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.i(f._353)();case 3:t=e.sent,a.ticketsList=t,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}},e,a,[[0,7]])}))()},getPackageOrderNumAll:function(){var a=this;return s()(p.a.mark(function e(){var t;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.i(f._354)();case 3:t=e.sent,a.packageAll=t,a.getTicketsAll(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}},e,a,[[0,8]])}))()},GetBranchByCode:function(a){var r=this;return s()(p.a.mark(function e(){var t;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.i(f._51)(a);case 3:t=e.sent,r.allMes=t,r.copyWorth(t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}},e,r,[[0,8]])}))()},getBranchGradeAll:function(){var m=this;return s()(p.a.mark(function e(){var t,a,r,o,i,l,n,s,c;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={startdate:"",enddate:"",suppliername:"",suptypecode:"",phonenumber:"",pageindex:1,pagesize:999},e.next=4,d.a.all([u.i(f.x)(t),u.i(f._319)(),u.i(f.l)("0019"),u.i(f.l)("0006"),u.i(f._354)(),u.i(f._353)()]);case 4:a=e.sent,r=h()(a,6),o=r[0],i=r[1],l=r[2],n=r[3],s=r[4],c=r[5],m.supplyList=o,m.accountList=l,n.forEach(function(e){Number(e.DataCode)<7&&m.payWayList.push({name:e.DataName,value:e.DataCode})}),m.gradeList=m.filter(i),m.copyWorth(m.baseData),m.packageAll=s,m.ticketsList=c,e.next=24;break;case 21:e.prev=21,e.t0=e.catch(0),console.log(e.t0);case 24:case"end":return e.stop()}},e,m,[[0,21]])}))()},filter:function(e){var t=[];return e.forEach(function(e){"G100000"!=e.Code&&t.push(e)}),t},packGradeSelect:function(t){var a=[];this.gradeList.forEach(function(e){e.OrderNum>=t&&a.push(e.OrderNum)}),a=this.removeDup(a)},removeDup:function(e){var t=[],a=e.length;e.sort();for(var r=0;r<a;r++)e[r]!=e[r+1]?t.push(e[r]):a-1<=r&&t.push(e[r+1]);this.packageSelect(t,this.packageAll)},packageSelect:function(e,t){var a=this;this.packageList=[],this.packageVal=[];for(var r=0;r<e.length;r++)for(var o=0;o<t.length;o++)e[r]==t[o].OrderNum&&(this.packageList[r]||this.packageList.push([]),this.packageList[this.packageList.length-1].push(t[o]));this.packageList.forEach(function(e){a.packageVal.push({code:""})})},getTickSplit:function(e){for(var t=[],a=0;a<e.length;a++)for(var r=0;r<this.ticketsList.length;r++)0!=e[a].code.length&&e[a].code==this.ticketsList[r].ConPacCode&&(this.ticketsList[r].TickCode="",t.push(this.ticketsList[r]));this.tableData=this.removeDu(t),this.integral=this.recharge()},removeDu:function(e){for(var t=[],a=JSON.parse(i()(e)),r=0;r<e.length-1;r++)for(var o=r+1;o<e.length;o++)if(e[r].TickInfoCode==e[o].TickInfoCode){a[o].TicNum+=a[r].TicNum,a[r].dul=!0;break}return a.forEach(function(e){e.dul||t.push(e)}),t},recharge:function(){var a=this,r=0;return this.packageVal.forEach(function(e){for(var t=0;t<a.packageAll.length;t++)if(e.code==a.packageAll[t].ConPacCode){r+=Number(a.packageAll[t].JifenRecharge);break}}),r},submitForm:function(e){var a=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;a.payTable.forEach(function(e){e.BranchCode=a.baseData.branchCode,e.BranchName=a.baseData.branchName,e.createUserId=u.i(c.b)("userId"),e.createBy=u.i(c.b)("userName")});var t={id:a.detailCode,branchCode:a.baseData.branchCode,branchName:a.baseData.branchName,identityType:a.ruleForm.identityType,branchOrderPayList:i()(a.payTable),modifiedBy:u.i(c.b)("userName"),modifiedUserId:u.i(c.b)("userId"),branchGradeCode:a.baseData.branchGradeCode,branchGradeName:a.baseData.branchGradeName,targetBranchGradeCode:a.baseData.targetBranchGradeCode,targetBranchGradeName:a.baseData.targetBranchGradeName,referrerCode:a.baseData.referrerCode,referrerName:a.baseData.referrerName,currentAmount:a.ruleForm.payAmount,payAmount:a.total,BranchPoints:a.integral,ConPackage:a.conPackSplit(a.packageVal)};a.show&&(t.hospitalCode=a.ruleForm.Hospital.split("|")[1],t.hospitalName=a.ruleForm.Hospital.split("|")[0]),a.saveLoading=!0,"edit"==a.title?a.UpdateBranchUpgradeApply(t):(t.comPakageOrderList=i()(a.packageTurn(a.tableData)),a.EnableBranchUpgradeApply(t))})},packageTurn:function(e){var t=this,a=[];return e.forEach(function(e){a.push({ConPacCode:e.ConPacCode,createUserId:u.i(c.b)("userId"),createBy:u.i(c.b)("userName"),TickInfoCode:e.TickInfoCode,TicketCode:e.TicketCode,TicketsType:e.TicketsType,ProjCodes:e.ProjCodes,UseCount:e.UseCount,TicNum:e.TicNum,ProjCodesNames:e.ProjCodesNames,branchCode:t.baseData.branchCode})}),a},resetForm:function(){this.$emit("upClose",close),this.ruleForm.grade=""},copyWorth:function(e){var t=this;this.getGradeName(e.branchGradeCode),this.ruleForm.Hospital=e.hospitalName+"|"+e.hospitalCode,this.ruleForm.payAmount=e.currentAmount,this.ruleForm.identityType=e.identityType,setTimeout(function(){t.ruleForm.grade=e.targetBranchGradeCode},100)},getGradeName:function(t){var a="",r=[],o="";return this.gradeList.forEach(function(e){e.Code==t&&(a=e.BranchGradeName,o=e.OrderNum)}),this.gradeList.forEach(function(e){e.OrderNum<o&&r.push(e)}),this.allGrade=this.gradeList.length-r.length-1,this.gradeList=r,a},conPackSplit:function(e){var t=[];if(0==e.length)return"";e.forEach(function(e){t.push(e.code)});var a="";if(0==this.oldPackCode.length)for(var r=this.allGrade,o=0;o<r-1;o++)a+=",";else a=this.oldPackCode;return t.join(",")+","+a},add:function(){this.dialogTableVisible1=!0,this.form={type:"",PayTypeName:"",PayType:"",RealAmount:0,Memo:"",ReceiveAccount:"",sxf:0,payDate:new Date}},paySure:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.payTable.push({PayType:t.form.PayType,PayTypeName:t.form.PayTypeName,Memo:t.form.Memo,RealAmount:t.form.RealAmount,ReceiveAccount:t.form.ReceiveAccount,ProcFee:t.form.sxf,payDate:t.form.payDate?t.form.payDate.formatDate("yyyy-MM-dd"):""}),t.dialogTableVisible1=!1,t.$refs.form.resetFields()})},payCancel:function(){this.dialogTableVisible1=!1,this.$refs.form.resetFields()},deleteRow:function(e,t){t.splice(e,1)},editPay:function(e,t){var a=JSON.parse(i()(t[e]));for(var r in a)a[r.substring(0,1).toUpperCase()+r.substring(1)]=a[r];this.editIndex=e,a.random=Math.random(),this.editMes=a,this.dialogTableVisible1=!0},payOpe:function(e,t){var a={memo:e.Memo,payDate:e.PayDate,payType:e.PayType,payTypeName:e.PayTypeName,procFee:Number(e.ProcFee),realAmount:Number(e.RealAmount),receiveBranchCode:e.ReceiveBranchCode,receiveBranchName:e.ReceiveBranchName,receiveAccount:e.ReceiveAccount,topBranch:e.topBranch,type:e.type};t?(this.payTable[this.editIndex]=JSON.parse(i()(a)),this.payTable.push()):e.PayType&&this.payTable.push(JSON.parse(i()(a))),this.dialogTableVisible1=!1}},components:{payInfo:b.a}}},1087:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l(66),n=l.n(a),r=l(102),s=l.n(r),o=l(100),c=l.n(o),i=l(99),m=l.n(i),u=l(443),p=l.n(u),d=l(65),h=(l.n(d),l(517)),f=l.n(h),b=l(2067),_=l.n(b),v=l(64),y=l(22);t.default={data:function(){return p()({type:l.i(y.d)("typeCode"),title:"",ope:"",dialogOpen:!1,hospitalList:"",hosForm:[],opeMes:{},loading:!1,referList:[],baseData:"",bankList:[],eduList:[],industryList:[],origionList:[],gradeList:[],currentPage:1,detailCode:"",branchCode:"",dialogFormVisible:!1,total:0,size:10,formInline:{keywords:"",isEnable:""},tableData:[]},"loading",!1)},computed:{},mounted:function(){this.getBranchGradeAll()},filters:{filterFun:function(e){var t=0;return e.forEach(function(e){t+=Number(e.Bonus)}),t}},methods:{composeValue:function(e,t,a,r){return{data:e,status:t,title:a,ope:r}},handleCommand:function(e){0==e.status?this.open(e.data,e.status,e.title,e.ope):1==e.status?this.del(e.data):2==e.status&&this.refund(e.data)},refund:function(e){var t=this;this.$confirm("是否确定进行退款操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.RefundUpgradeApply({id:e.id})})},RefundUpgradeApply:function(a){var r=this;return m()(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.i(v._362)(a);case 2:(t=e.sent).status?(r.$message({message:"退款成功",type:"success"}),r.getTableDate()):r.$message.error("退款失败"+t.errorMessage);case 4:case"end":return e.stop()}},e,r)}))()},del:function(e){var t=this;this.$confirm("确认删除此条消费商升级信息吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.delData({id:e.id})})},delData:function(a){var r=this;return m()(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.i(v._363)(a);case 2:(t=e.sent).status?(r.$message({message:"删除成功",type:"success"}),r.getTableDate()):r.$message.error("删除失败"+t.errorMessage);case 4:case"end":return e.stop()}},e,r)}))()},GetBranchUpgradeApply:function(a){var r=this;return m()(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.loading=!0,e.next=3,l.i(v._364)(a);case 3:t=e.sent,r.tableData=t.data,r.total=t.count,r.loading=!1;case 7:case"end":return e.stop()}},e,r)}))()},getBranchGradeAll:function(){var i=this;return m()(c.a.mark(function e(){var t,a,r,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.a.all([l.i(v.d)({typeId:1}),l.i(v._319)()]);case 3:t=e.sent,a=s()(t,2),r=a[0],o=a[1],i.hospitalList=r.data,i.formInline.hospital=i.hospitalList[0].code,i.gradeList=o,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}},e,i,[[0,12]])}))()},getBranchByConditions:function(a){var r=this;return m()(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r.loading=!0,e.next=4,GetBranchByConditions(a);case 4:t=e.sent,r.loading=!1,r.tableData=t,r.tableData.push(),0!=t.length&&(r.total=t[0].RecordCount),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}},e,r,[[0,11]])}))()},dateSelect:function(e){0!=e.length?(e=e.formatDates(),this.formInline.date1=e.substring(0,10),this.formInline.date2=e.substring(13)):(this.formInline.date1="",this.formInline.date2="")},onSubmit:function(){this.currentPage=1,this.getTableDate(1)},handleSizeChange:function(e){console.log("每页 "+e+" 条"),this.size=e,this.getTableDate()},handleCurrentChange:function(e){console.log("当前页: "+e),this.currentPage=e,this.getTableDate()},DetailMes:function(e,t){this.detailCode=t[e].branchCode,this.dialogFormVisible=!0},open:function(e,t,a,r){this.title=a,this.ope=r,this.detailCode=e.id,this.branchCode=e.branchCode,this.dialogOpen=!0},upClose:function(){this.dialogOpen=!1,this.getTableDate()},getTableDate:function(){this.GetBranchUpgradeApply({pageIndex:this.currentPage,pageSize:this.size,keywords:this.formInline.keywords.removeSP(),isEnable:this.formInline.isEnable})}},components:{agentDetail:f.a,openDialog:_.a}}},1343:function(e,t,a){(e.exports=a(215)(!1)).push([e.i,".AgentManage[data-v-3edb059a]{font-size:12px}.inventory[data-v-3edb059a]{margin-bottom:10px}.form_footer[data-v-3edb059a]{text-align:center}",""])},1509:function(e,t,a){(e.exports=a(215)(!1)).push([e.i,".clear[data-v-d0bbeb42]{clear:both}.pic[data-v-d0bbeb42]{width:60px;height:60px;border-radius:60px;background:url("+a(510)+") no-repeat 50%;background-size:100%;overflow:hidden;margin-right:10px}.mes[data-v-d0bbeb42]{margin-left:20px;line-height:26px}",""])},1768:function(e,t,a){var r=a(1343);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a(216)("559aac52",r,!0)},1934:function(e,t,a){var r=a(1509);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a(216)("51077cc9",r,!0)},2067:function(e,t,a){a(1934);var r=a(98)(a(1073),a(2409),"data-v-d0bbeb42",null);e.exports=r.exports},2240:function(e,t){e.exports={render:function(){var a=this,e=a.$createElement,r=a._self._c||e;return r("div",{staticClass:"selCommon AgentManage"},[r("el-form",{staticClass:"demo-form-inline form_search",attrs:{inline:!0,model:a.formInline,"label-width":"90px"}},[r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"关键字："}},[r("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"消费商"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&a._k(e.keyCode,"enter",13,e.key,"Enter")?null:a.onSubmit(e)}},model:{value:a.formInline.keywords,callback:function(e){a.$set(a.formInline,"keywords",e)},expression:"formInline.keywords"}})],1),a._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"启用状态："}},[r("el-select",{staticStyle:{width:"200px"},on:{change:a.onSubmit},model:{value:a.formInline.isEnable,callback:function(e){a.$set(a.formInline,"isEnable",e)},expression:"formInline.isEnable"}},[r("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),r("el-option",{attrs:{label:"未启用",value:"0"}}),a._v(" "),r("el-option",{attrs:{label:"已启用",value:"1"}}),a._v(" "),r("el-option",{attrs:{label:"已退款",value:"3"}})],1)],1),a._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:" "}},[r("el-button",{staticStyle:{background:"#cda382","border-radius":"2px",color:"#fff","border-color":"#d6d4d4"},attrs:{type:"primary"},on:{click:a.onSubmit}},[a._v("查询")])],1)],1),a._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],staticClass:"min_table smt",staticStyle:{width:"100%","margin-top":"15px","margin-bottom":"10px"},attrs:{data:a.tableData,border:""}},[r("el-table-column",{attrs:{prop:"Code",label:"消费商","min-width":"120"},scopedSlots:a._u([{key:"default",fn:function(t){return[r("span",{staticClass:"table_btn",attrs:{type:"text"},on:{click:function(e){return a.DetailMes(t.$index,a.tableData)}}},[a._v(a._s(t.row.branchName)),r("br"),a._v(a._s(t.row.branchCode))])]}}])}),a._v(" "),r("el-table-column",{attrs:{prop:"createOn",label:"申请日期",width:"110"},scopedSlots:a._u([{key:"default",fn:function(e){return[e.row.createOn?r("span",[a._v("\n                     "+a._s(e.row.createOn.substring(0,10))+"\n                ")]):a._e()]}}])}),a._v(" "),r("el-table-column",{attrs:{prop:"ReferrerName",label:"推荐人","min-width":"130"},scopedSlots:a._u([{key:"default",fn:function(e){return[e.row.referrerName?r("span",[a._v(a._s(e.row.referrerName))]):a._e(),r("br"),a._v(" "),e.row.referrerCode?r("span",[a._v("["+a._s(e.row.referrerCode)+"]")]):a._e()]}}])}),a._v(" "),r("el-table-column",{attrs:{prop:"hospitalName",label:"医院","min-width":"130"}}),a._v(" "),r("el-table-column",{attrs:{prop:"branchGradeName",label:"当前等级","min-width":"130"}}),a._v(" "),r("el-table-column",{attrs:{prop:"targetBranchGradeName",label:"目标等级","min-width":"130"}}),a._v(" "),r("el-table-column",{attrs:{prop:"currentAmount",label:"缴纳会费","min-width":"90"},scopedSlots:a._u([{key:"default",fn:function(e){return[e.row.currentAmount||0==e.row.currentAmount?r("span",[a._v("￥"+a._s(e.row.currentAmount.toQFW()))]):a._e()]}}])}),a._v(" "),r("el-table-column",{attrs:{prop:"payAmount",label:"已支付","min-width":"90"},scopedSlots:a._u([{key:"default",fn:function(e){return[e.row.payAmount||0==e.row.payAmount?r("span",[a._v("￥"+a._s(e.row.payAmount.toQFW()))]):a._e()]}}])}),a._v(" "),r("el-table-column",{attrs:{prop:"isPayOff",label:"是否结清",width:"90"},scopedSlots:a._u([{key:"default",fn:function(e){return[0==e.row.isPayOff?r("el-tag",{attrs:{type:"warning"}},[a._v("未结清")]):a._e(),a._v(" "),1==e.row.isPayOff?r("el-tag",{attrs:{type:"success"}},[a._v("已结清")]):a._e()]}}])}),a._v(" "),r("el-table-column",{attrs:{prop:"isEnable",label:"状态",width:"80"},scopedSlots:a._u([{key:"default",fn:function(e){return[0==e.row.isEnable?r("el-tag",{attrs:{type:"warning"}},[a._v("未启用")]):a._e(),a._v(" "),1==e.row.isEnable?r("el-tag",{attrs:{type:"success"}},[a._v("已启用")]):a._e(),a._v(" "),2==e.row.isEnable?r("el-tag",{attrs:{type:"success"}},[a._v("已启用")]):a._e(),a._v(" "),3==e.row.isEnable?r("el-tag",{attrs:{type:"danger"}},[a._v("已退款")]):a._e()]}}])}),a._v(" "),r("el-table-column",{attrs:{prop:"grade",label:"操作",width:"150"},scopedSlots:a._u([{key:"default",fn:function(e){return[r("el-dropdown",{on:{command:a.handleCommand}},[r("el-button",{attrs:{type:"primary"}},[a._v("操作"),r("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),a._v(" "),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r("el-dropdown-item",{attrs:{command:a.composeValue(e.row,0,"编辑","edit"),disabled:0!=e.row.isEnable&&"01"!=a.type}},[a._v("编辑")]),a._v(" "),r("el-dropdown-item",{attrs:{command:a.composeValue(e.row,0,"启用","open"),disabled:0!=e.row.isEnable}},[a._v("启用")]),a._v(" "),r("el-dropdown-item",{attrs:{command:a.composeValue(e.row,0,"续交订金","edit"),disabled:3==e.row.isEnable||1==e.row.isPayOff}},[a._v("续交订金")]),a._v(" "),r("el-dropdown-item",{attrs:{command:a.composeValue(e.row,1,"",""),disabled:1==e.row.isPayOff}},[a._v("删除")]),a._v(" "),r("el-dropdown-item",{attrs:{command:a.composeValue(e.row,2,"",""),disabled:0!=e.row.isEnable}},[a._v("退款")])],1)],1)]}}])})],1),a._v(" "),r("div",{staticClass:"block"},[r("el-pagination",{attrs:{"current-page":a.currentPage,"page-sizes":[10,20,30,40],"page-size":a.size,layout:"total, sizes, prev, pager, next, jumper",total:a.total},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1),a._v(" "),r("el-dialog",{attrs:{title:"代理详情",visible:a.dialogFormVisible,size:"",top:"5%"},on:{"update:visible":function(e){a.dialogFormVisible=e}}},[a.dialogFormVisible?r("div",[r("agentDetail",{ref:"detail",staticStyle:{width:"920px"},attrs:{detailCode:a.detailCode}})],1):a._e()]),a._v(" "),r("el-dialog",{attrs:{title:a.title,visible:a.dialogOpen,size:"",top:"5%"},on:{"update:visible":function(e){a.dialogOpen=e}}},[a.dialogOpen?r("div",[r("openDialog",{ref:"detail",staticStyle:{width:"920px"},attrs:{title:a.ope,detailCode:a.detailCode,branchCode:a.branchCode},on:{upClose:a.upClose}})],1):a._e()])],1)},staticRenderFns:[]}},2409:function(e,t){e.exports={render:function(){var a=this,e=a.$createElement,r=a._self._c||e;return r("div",{staticClass:"upGrade"},[r("el-col",{staticStyle:{"line-height":"36px","font-size":"16px","font-weight":"bold"},attrs:{span:24}},[a._v("升级信息")]),a._v(" "),r("div",{staticClass:"clear",staticStyle:{"margin-top":"20px"}},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:a.ruleForm,rules:a.rules,inline:!0,"label-width":"110px"}},[r("el-col",{staticStyle:{background:"#F2F2F2","padding-top":"10px"},attrs:{span:24}},[r("el-form-item",{staticClass:"form_item form_item_mt10",attrs:{label:"当前等级：",prop:"grade"}},[r("span",[a._v(a._s(a.baseData.branchGradeName))])]),r("br"),a._v(" "),r("el-form-item",{staticClass:"form_item form_item_mt10",attrs:{label:"升级等级：",prop:"grade"}},[r("el-select",{staticClass:"form_select_2",attrs:{placeholder:"请选择等级",disabled:""},model:{value:a.ruleForm.grade,callback:function(e){a.$set(a.ruleForm,"grade",e)},expression:"ruleForm.grade"}},a._l(a.gradeList,function(e){return r("el-option",{key:e.Code,attrs:{label:e.BranchGradeName,disabled:"",value:e.Code}})}),1)],1),a._v(" "),r("el-form-item",{staticClass:"form_item form_item_mt10",attrs:{label:"推荐提成策略：",prop:"identityType"}},[r("el-select",{staticClass:"form_select_2",attrs:{placeholder:"请选择",disabled:""},model:{value:a.ruleForm.identityType,callback:function(e){a.$set(a.ruleForm,"identityType",e)},expression:"ruleForm.identityType"}},[r("el-option",{attrs:{label:"新策略",value:"1"}}),a._v(" "),r("el-option",{attrs:{label:"老策略",value:"2"}})],1)],1),a._v(" "),a.show?r("el-form-item",{staticClass:"form_item form_item_mt10",attrs:{label:"医院：",prop:"Hospital"}},[r("el-select",{staticClass:"form_ipt",attrs:{disabled:""},model:{value:a.ruleForm.Hospital,callback:function(e){a.$set(a.ruleForm,"Hospital",e)},expression:"ruleForm.Hospital"}},a._l(a.supplyList,function(e,t){return r("el-option",{key:t,attrs:{label:e.SupplierName,value:e.Code+"|"+e.SupplierName}})}),1)],1):a._e(),a._v(" "),r("br"),a._v(" "),r("el-form-item",{staticClass:"form_item form_item_mt10",attrs:{label:"补交："}},[r("span",{staticStyle:{color:"red","line-height":"36px"}},[a._v("￥"+a._s(a.ruleForm.payAmount))])]),a._v(" "),r("el-form-item",{staticClass:"form_item form_item_mt10",attrs:{label:"押金："}},[r("span",{staticStyle:{color:"red","line-height":"36px"}},[a._v("￥"+a._s(a.ruleForm.Pledge))])]),a._v(" "),r("br"),a._v(" "),r("el-form-item",{staticClass:"form_item form_item_mt10",attrs:{label:"消费订单："}},[r("el-checkbox",{model:{value:a.ruleForm.order,callback:function(e){a.$set(a.ruleForm,"order",e)},expression:"ruleForm.order"}})],1),a._v(" "),a.ruleForm.order?r("el-form-item",{staticClass:"form_item form_item_mt10",attrs:{label:"订单编号：",prop:"formNum"}},[r("el-input",{staticClass:"form_ipt",model:{value:a.ruleForm.formNum,callback:function(e){a.$set(a.ruleForm,"formNum",e)},expression:"ruleForm.formNum"}})],1):a._e()],1),a._v(" "),r("el-form-item",{staticStyle:{width:"100%",margin:"10px 0"},attrs:{label:"","label-width":"70px"}},[r("span",{staticStyle:{"font-weight":"bold","font-size":"16px"}},[a._v("支付信息")])]),a._v(" "),r("el-col",{staticStyle:{background:"#F2F2F2","padding-top":"10px"},attrs:{span:24}},[r("el-form-item",{staticStyle:{width:"100%","margin-bottom":"10px"},attrs:{label:" ","label-width":"30px"}},[r("el-table",{ref:"singleTable",staticStyle:{width:"870px"},attrs:{data:a.payTable,border:""}},[r("el-table-column",{attrs:{prop:"payTypeName","min-width":"100",label:"支付方式"}}),a._v(" "),r("el-table-column",{attrs:{prop:"receiveBranchName","min-width":"100",label:"销售公司"}}),a._v(" "),r("el-table-column",{attrs:{prop:"receiveAccount",label:"收款账户","min-width":"100"}}),a._v(" "),r("el-table-column",{attrs:{prop:"procFee",label:"手续费","min-width":"80"}}),a._v(" "),r("el-table-column",{attrs:{prop:"memo",label:"备注","min-width":"100"}}),a._v(" "),r("el-table-column",{attrs:{prop:"realAmount",label:"实际金额","min-width":"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v("\n                                "+a._s(e.row.realAmount.toQFW())+"\n                            ")]}}])}),a._v(" "),r("el-table-column",{attrs:{prop:"payDate",label:"支付日期","min-width":"100"},scopedSlots:a._u([{key:"default",fn:function(e){return[e.row.payDate?r("span",[a._v("\n                                    "+a._s(e.row.payDate.substring(0,10))+"\n                                ")]):a._e()]}}])}),a._v(" "),r("el-table-column",{attrs:{prop:"",label:"操作","min-width":"100"},scopedSlots:a._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return a.editPay(t.$index,a.payTable,"编辑")}}},[a._v("编辑")]),a._v(" "),r("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(e){return a.deleteRow(t.$index,a.payTable)}}},[a._v("删除")])]}}])})],1),a._v("\n                    总额：￥"+a._s(a.total)),r("br"),a._v(" "),r("el-button",{staticStyle:{"margin-top":"10px"},attrs:{type:"success"},on:{click:a.add}},[a._v("添加支付信息")])],1)],1),a._v(" "),r("el-form-item",{staticStyle:{width:"100%",margin:"10px 0"},attrs:{label:"","label-width":"70px"}},[r("span",{staticStyle:{"font-weight":"bold","font-size":"16px"}},[a._v("套餐信息")])]),a._v(" "),r("el-col",{staticStyle:{background:"#F2F2F2","padding-top":"10px"},attrs:{span:24}},[r("el-form-item",{staticStyle:{"margin-bottom":"0px"},attrs:{label:"选择套餐组合："}},[r("el-row",a._l(a.packageList,function(e,t){return r("el-col",{key:t,staticStyle:{width:"150px"}},[r("el-select",{attrs:{form:"",placeholder:"请选择",disabled:a.disabled},model:{value:a.packageVal[t].code,callback:function(e){a.$set(a.packageVal[t],"code",e)},expression:"packageVal[index].code"}},a._l(e,function(e){return r("el-option",{key:e.ConPacCode,attrs:{label:e.ConPacName,value:e.ConPacCode}})}),1)],1)}),1)],1),a._v(" "),r("el-form-item",{staticStyle:{width:"100%","margin-bottom":"0px"},attrs:{label:"卡券："}},[r("el-table",{ref:"singleTable",staticStyle:{width:"800px"},attrs:{data:a.tableData,border:"","highlight-current-row":""}},[r("el-table-column",{attrs:{type:"index",width:"60",label:"序号"}}),a._v(" "),r("el-table-column",{attrs:{prop:"ConPacName",label:"套餐名称","min-width":"100"}}),a._v(" "),r("el-table-column",{attrs:{prop:"TickInfoCode",label:"券种编号","min-width":"100"}}),a._v(" "),r("el-table-column",{attrs:{prop:"TickName",label:"券名称","min-width":"120"}}),a._v(" "),r("el-table-column",{attrs:{prop:"Price",label:"面值","min-width":"80"}}),a._v(" "),r("el-table-column",{attrs:{prop:"TicNum",label:"数量","min-width":"80"}}),a._v(" "),r("el-table-column",{attrs:{prop:"EndDate",label:"有效期","min-width":"120"}})],1)],1),a._v(" "),r("el-form-item",{staticClass:"form_item",attrs:{label:"积分："}},[r("span",[a._v(a._s(a.integral))])])],1),a._v(" "),r("el-form-item",{staticClass:"form_item_mt0",staticStyle:{width:"100%","text-align":"center","margin-top":"20px"}},[r("el-button",{attrs:{type:"primary",loading:a.saveLoading},on:{click:function(e){return a.submitForm("ruleForm")}}},[a._v("保存")]),a._v(" "),r("el-button",{on:{click:function(e){return a.resetForm("ruleForm")}}},[a._v("取消")])],1)],1)],1),a._v(" "),r("el-dialog",{attrs:{title:"添加支付信息",visible:a.dialogTableVisible1,modal:!1,size:""},on:{"update:visible":function(e){a.dialogTableVisible1=e}}},[r("payInfo",{staticStyle:{width:"380px"},attrs:{editMes:a.editMes,dialogTableVisible1:a.dialogTableVisible1,isHos:!0},on:{payOpe:a.payOpe}})],1),a._v(" "),r("el-dialog",{attrs:{title:"推荐奖明细",visible:a.dialogFormVisible,size:"",modal:!1,"label-width":"80px"},on:{"update:visible":function(e){a.dialogFormVisible=e}}},[r("el-table",{staticStyle:{width:"800px","margin-top":"15px","margin-bottom":"10px"},attrs:{data:a.bonusData,border:"","max-height":"400px"}},[r("el-table-column",{attrs:{prop:"RefrenceName",label:"代理人","min-width":"80"}}),a._v(" "),r("el-table-column",{attrs:{prop:"RefrenceGradeName",label:"代理等级","min-width":"90"}}),a._v(" "),r("el-table-column",{attrs:{prop:"UpgradeBonus",label:"会费等级金额","min-width":"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v("\n                    "+a._s(e.row.UpgradeBonus.toQFW())+"\n                ")]}}])}),a._v(" "),r("el-table-column",{attrs:{prop:"UpgradeBonus",label:"策略","min-width":"80"}},[[1==a.ruleForm.identityType?r("span",[a._v("新策略")]):a._e(),a._v(" "),2==a.ruleForm.identityType?r("span",[a._v("老策略")]):a._e()]],2),a._v(" "),1==a.ruleForm.identityType?r("el-table-column",{attrs:{prop:"Rate",label:"分成比例%","min-width":"90"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v("\n                    "+a._s(100*e.row.Rate)+"\n                ")]}}],null,!1,2731708868)}):a._e(),a._v(" "),r("el-table-column",{attrs:{prop:"Bonus",label:"分成金额","min-width":"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v("\n                    "+a._s(e.row.Bonus.toQFW())+"\n                ")]}}])})],1),a._v("\n        总计：￥"+a._s(a._f("filterFunB")(a.bonusData))+"\n        "),r("el-form",{staticStyle:{width:"700px"},attrs:{model:a.hosForm,inline:!0}},[r("el-form-item",{staticClass:"form_item",staticStyle:{margin:"10px 0 0 0px"},attrs:{label:"",prop:"RealAmount"}},[r("span",{staticStyle:{"font-size":"16px","font-weight":"bold"}},[a._v("医院收益")])]),r("br"),a._v(" "),r("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"医院：",prop:"RealAmount"}},[r("span",[a._v(a._s(a.hosForm.HospitalName))])]),a._v(" "),r("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"比例：",prop:"RealAmount"}},[r("span",[a._v(a._s(100*a.hosForm.Rate)+"%")])]),a._v(" "),r("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"金额：",prop:"RealAmount"}},[r("span",[a._v(a._s(a.hosForm.HosAmount))])])],1)],1)],1)},staticRenderFns:[]}},359:function(e,t,a){a(1768);var r=a(98)(a(1087),a(2240),"data-v-3edb059a",null);e.exports=r.exports},443:function(e,t,a){"use strict";t.__esModule=!0;var r,o=a(444),i=(r=o)&&r.__esModule?r:{default:r};t.default=function(e,t,a){return t in e?(0,i.default)(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}},444:function(e,t,a){e.exports={default:a(445),__esModule:!0}},445:function(e,t,a){a(446);var r=a(2).Object;e.exports=function(e,t,a){return r.defineProperty(e,t,a)}},446:function(e,t,a){var r=a(9);r(r.S+r.F*!a(10),"Object",{defineProperty:a(11).f})},510:function(e,t,a){e.exports=a.p+"static/img/person.f548a9b.jpg"},513:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(100),c=s.n(a),r=s(66),m=s.n(r),o=s(102),u=s.n(o),i=s(99),l=s.n(i),n=s(443),p=s.n(n),d=s(101),h=s(64);t.default={props:{detailCode:""},data:function(){var e;return e={dialogImg:!1,baseImgPath:d.b,fileList:[],allMes:{},integral:0,payTable:[],ticketsList:[],packageAll:[],packageVal:[],gradeList:[],tableData:[]},p()(e,"allMes",""),p()(e,"ruleForm",{grade:"",BranchName:"",Sex:"",Code:"",BranchGradeName:"",PhoneNumber:"",OldReferrerName:"",ReferrerName:""}),p()(e,"createBy",""),p()(e,"ServiceInfo",{}),e},watch:{detailCode:{handler:function(){this.getBranchGradeAll()},deep:!0},"ruleForm.grade":{handler:function(t){this.gradeList.forEach(function(e){e.Code==t&&e.OrderNum})},deep:!0}},mounted:function(){this.getBranchGradeAll()},methods:{imgShow:function(e){this.$emit("photoShow",e)},uploadImg:function(){this.dialogImg=!0},getBranchGradeAll:function(){var n=this;return l()(c.a.mark(function e(){var t,a,r,o,i,l;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.a.all([s.i(h._319)(),s.i(h._354)(),s.i(h._353)(),s.i(h._51)({branchcode:n.detailCode})]);case 3:t=e.sent,a=u()(t,4),r=a[0],o=a[1],i=a[2],l=a[3],n.gradeList=r,n.packageAll=o,n.ticketsList=i,n.getBranchByCode(l),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.log(e.t0);case 18:case"end":return e.stop()}},e,n,[[0,15]])}))()},getBranchByCode:function(e){this.fileList=e.CommonPhotoList,this.allMes=e,this.ServiceInfo=e.ServiceInfo?e.ServiceInfo:{},this.copyWorth(e.Branch),this.tableData=e.CPOList,this.payTable=e.BranchOrderPayList.filter(function(e){if(1==e.ItemType||4==e.ItemType)return e})},copyWorth:function(e){for(var t in e)e[t]&&"null"!=e[t]&&null!=e[t]&&"undefined"!=e[t]||(e[t]="");this.allMes=e,this.ruleForm.Sex=this.getSex(e.Sex),this.ruleForm.Code=e.Code,this.ruleForm.BranchName=e.BranchName,this.ruleForm.BranchGradeName=this.getGradeName(e.BranchGradeCode),this.ruleForm.PhoneNumber=e.PhoneNumber,this.ruleForm.SourcWayeCode=e.SourcWayeCode,this.ruleForm.RegistDate=e.RegistDate.substring(0,10),this.ruleForm.ReferrerName=e.ReferrerName,this.ruleForm.OpenBankName=e.OpenBankName,this.ruleForm.OpenBankCode=e.OpenBankCode,this.ruleForm.Income=e.Income,this.ruleForm.IDCard=e.IDCard,this.ruleForm.Email=e.Email,this.ruleForm.BankCardId=e.BankCardId,this.ruleForm.Birthday=e.Birthday,this.ruleForm.BankCardHolder=e.BankCardHolder,this.ruleForm.Address=e.Province+e.City+e.Area+e.Address.split(",").join(""),this.ruleForm.hospital=e.HospitalName,this.ruleForm.OldReferrerName=e.OldReferrerName?e.OldReferrerName:"",this.packageVal=this.packNamTurn(e.ConPackage),this.createBy=e.CreateBy},getSex:function(e){return e?1==e?"男":"女":""},getGradeName:function(t){var a="",r=[],o="";return this.gradeList.forEach(function(e){e.Code==t&&(a=e.BranchGradeName,o=e.OrderNum)}),this.gradeList.forEach(function(e){e.OrderNum<o&&r.push(e)}),this.gradeList=r,a},packNamTurn:function(e){for(var t=e.split(","),a=[],r=0;r<t.length;r++)for(var o=0;o<this.packageAll.length;o++)t[r]==this.packageAll[o].ConPacCode&&(a.push(this.packageAll[o].ConPacName),this.integral+=this.packageAll[o].JifenRecharge);return a}},components:{}}},514:function(e,t,a){(e.exports=a(215)(!1)).push([e.i,".clear[data-v-33b7c139]{clear:both}.pic[data-v-33b7c139]{width:60px;height:60px;border-radius:30px;overflow:hidden;background:url("+a(510)+") 50%;background-size:100%}.form_item_half[data-v-33b7c139]{width:48%;margin-bottom:0}.upGrade[data-v-33b7c139]{height:750px;overflow-x:hidden;overflow-y:auto}.mes[data-v-33b7c139]{margin-left:20px;line-height:26px}.imgList[data-v-33b7c139]{width:100px;height:100px;border:1px dashed #c0ccda;display:inline-block;border-radius:6px;margin-right:5px;position:relative}.layer[data-v-33b7c139]{position:absolute;top:0;left:0;z-index:2;width:100%;height:100px;background-color:rgba(0,0,0,.3);text-align:center;line-height:100px;opacity:0;color:#fff;border:none}.imgShow[data-v-33b7c139]{width:100px;height:100px}.imgList:hover .layer[data-v-33b7c139]{opacity:1}.view[data-v-33b7c139]{cursor:pointer}",""])},515:function(e,t,a){var r=a(514);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a(216)("06166ec1",r,!0)},517:function(e,t,a){a(515);var r=a(98)(a(513),a(519),"data-v-33b7c139",null);e.exports=r.exports},519:function(e,t){e.exports={render:function(){var a=this,e=a.$createElement,r=a._self._c||e;return r("div",{staticClass:"upGrade"},[r("div",{staticClass:"clear"},[a._m(0),a._v(" "),r("div",{staticClass:"mes left"},[r("span",{},[a._v(a._s(a.ruleForm.BranchName)+"  "+a._s(a.ruleForm.Sex))]),r("br"),a._v(" "),r("span",[a._v("代理编号："+a._s(a.ruleForm.Code))]),a._v("   \n            "),r("span",[a._v("代理等级："+a._s(a.ruleForm.BranchGradeName)+"  手机号码："+a._s(a.ruleForm.PhoneNumber))]),a._v("  \n            "),r("span",[a._v("创建人："+a._s(a.createBy))]),a._v("   \n        ")])]),a._v(" "),r("div",{staticClass:"clear",staticStyle:{"margin-top":"20px"}},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:a.ruleForm,inline:!0,"label-width":"110px"}},[r("el-form-item",{staticStyle:{"margin-bottom":"0px"},attrs:{label:""}},[r("span",{staticStyle:{"font-weight":"bold","font-size":"16px"}},[a._v("代理详情")])]),a._v(" "),r("el-col",{staticStyle:{background:"#F2F2F2"},attrs:{span:24}},[r("el-form-item",{staticClass:"form_item_half",attrs:{label:"注册时间："}},[r("span",[a._v(a._s(a.ruleForm.RegistDate))])]),a._v(" "),r("el-form-item",{staticClass:"form_item_half",attrs:{label:"邮箱："}},[r("span",[a._v(a._s(a.ruleForm.Email))])]),a._v(" "),r("el-form-item",{staticClass:"form_item_half",attrs:{label:"地区："}},[r("span",[a._v(a._s(a.ruleForm.Address))])]),a._v(" "),r("el-form-item",{staticClass:"form_item_half",attrs:{label:"来源渠道："}},[r("span",[a._v(a._s(a.ruleForm.SourcWayeCode))])]),a._v(" "),r("el-form-item",{staticClass:"form_item_half",attrs:{label:"身份证号："}},[r("span",[a._v(a._s(a.ruleForm.IDCard))])]),a._v(" "),r("el-form-item",{staticClass:"form_item_half",attrs:{label:"卡号："}},[r("span",[a._v(a._s(a.allMes.CardNO))])]),a._v(" "),r("el-form-item",{staticClass:"form_item_half",attrs:{label:"生日："}},[r("span",[a._v(a._s(a.ruleForm.Birthday))])]),a._v(" "),0<a.ruleForm.ReferrerName.length?r("el-form-item",{staticClass:"form_item_half",attrs:{label:"推荐人："}},[r("span",[a._v(a._s(a.ruleForm.ReferrerName))])]):a._e(),a._v(" "),0<a.ruleForm.OldReferrerName.length?r("el-form-item",{staticClass:"form_item_half",attrs:{label:"前推荐人："}},[r("span",[a._v(a._s(a.ruleForm.OldReferrerName))])]):a._e(),a._v(" "),2==a.allMes.BranchType?r("el-form-item",{staticClass:"form_item_half",attrs:{label:"服务商："}},[a.ServiceInfo.ServiceInfoName?r("span",[a._v(a._s(a.ServiceInfo.ServiceInfoName)+"（"+a._s(a.ServiceInfo.PhoneNumber)+"）")]):a._e()]):a._e(),a._v(" "),r("el-form-item",{staticClass:"form_item_half",attrs:{label:"医院："}},[r("span",[a._v(a._s(a.ruleForm.hospital))])]),a._v(" "),r("el-form-item",{staticClass:"form_item_half",attrs:{label:"代理类型："}},[1==a.allMes.BranchType?r("span",[a._v("个人")]):a._e(),a._v(" "),2==a.allMes.BranchType?r("span",[a._v("店铺")]):a._e()]),a._v(" "),2==a.allMes.BranchType?r("el-form-item",{staticClass:"form_item_half",attrs:{label:"店铺："}},[0<a.allMes.ShopName.length?r("span",[a._v(a._s(a.allMes.ShopName))]):a._e(),a._v(" "),r("span",[a._v(a._s(a.allMes.ShopArea)+"m²")])]):a._e(),a._v(" "),2==a.allMes.BranchType?r("el-form-item",{staticClass:"form_item_half",attrs:{label:"凭证："}},[r("el-button",{attrs:{size:"small"},on:{click:a.uploadImg}},[a._v("查看图片")])],1):a._e(),a._v(" "),2==a.allMes.BranchType?r("el-form-item",{staticClass:"form_item_half",attrs:{label:"专家日提成：",prop:""}},[0==a.allMes.IsExpert?r("span",[a._v("无")]):a._e(),a._v(" "),1==a.allMes.IsExpert?r("span",[a._v("有")]):a._e()]):a._e(),a._v(" "),1==a.allMes.IsExpert&&2==a.allMes.BranchType?r("el-form-item",{staticClass:"form_item_half",attrs:{label:"生效时间："}},[a.allMes.ShopEffectiveDate?r("span",[a._v(a._s(a.allMes.ShopEffectiveDate.substring(0,10)))]):a._e()]):a._e(),a._v(" "),1==a.allMes.IsExpert&&2==a.allMes.BranchType?r("el-form-item",{staticClass:"form_item_half",attrs:{label:"专家日提成比例："}},[a.allMes.ExpertRate?r("span",[a._v(a._s(a.allMes.ExpertRate.mul(100))+"%")]):a._e()]):a._e(),a._v(" "),r("el-form-item",{staticClass:"form_item_half",attrs:{label:"策略："}},[1==a.allMes.IdentityType?r("span",[a._v("新策略")]):a._e(),a._v(" "),2==a.allMes.IdentityType?r("span",[a._v("老策略")]):a._e()]),a._v(" "),1==a.allMes.IdentityType?r("el-form-item",{staticClass:"form_item_half",attrs:{label:"订单号："}},[1==a.allMes.IdentityType?r("span",[a._v(a._s(a.allMes.FormNO))]):a._e()]):a._e()],1),a._v(" "),r("el-form-item",{staticStyle:{width:"100%","margin-bottom":"0px"},attrs:{label:""}},[r("span",{staticStyle:{"font-weight":"bold","font-size":"16px"}},[a._v("组合信息")])]),a._v(" "),r("el-col",{staticStyle:{background:"#F2F2F2","padding-top":"10px"},attrs:{span:24}},[r("el-form-item",{staticStyle:{"margin-bottom":"0px"},attrs:{label:"套餐内容："}},[r("el-row",a._l(a.packageVal,function(e,t){return r("span",{key:t,staticStyle:{"margin-right":"20px"}},[a._v(a._s(e))])}),0)],1),a._v(" "),r("el-form-item",{staticStyle:{width:"100%","margin-bottom":"0px"},attrs:{label:"卡券："}},[r("el-table",{ref:"singleTable",staticStyle:{width:"750px"},attrs:{data:a.tableData,border:"","highlight-current-row":""}},[r("el-table-column",{attrs:{type:"index",width:"60",label:"序号"}}),a._v(" "),r("el-table-column",{attrs:{prop:"ConPacName",label:"套餐名称","min-width":"100"}}),a._v(" "),r("el-table-column",{attrs:{prop:"TickInfoCode",label:"券种编号","min-width":"100"}}),a._v(" "),r("el-table-column",{attrs:{prop:"TickName",label:"券名称","min-width":"120"}}),a._v(" "),r("el-table-column",{attrs:{prop:"Price",label:"面值","min-width":"80"}}),a._v(" "),r("el-table-column",{attrs:{prop:"EndDate",label:"有效期","min-width":"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[""!=e.row.PrdOfVal&&null!=e.row.PrdOfVal?r("span",[a._v(" "+a._s("售后"+e.row.PrdOfVal+"天"))]):r("div",[r("p",[a._v("开始："+a._s(e.row.StartDate&&e.row.StartDate.substr(0,10))+" ")]),a._v(" "),r("p",[a._v("结束："+a._s(e.row.EndDate&&e.row.EndDate.substr(0,10))+" ")])])]}}])})],1)],1),a._v(" "),r("el-form-item",{staticClass:"form_item",attrs:{label:"积分："}},[r("span",[a._v(a._s(a.integral))])])],1),a._v(" "),r("el-form-item",{staticStyle:{"margin-bottom":"0px",width:"100%"},attrs:{label:""}},[r("span",{staticStyle:{"font-weight":"bold","font-size":"16px"}},[a._v("银行信息")])]),a._v(" "),r("el-col",{staticStyle:{background:"#F2F2F2","padding-top":"10px"},attrs:{span:24}},[r("el-form-item",{staticClass:"form_item_half",attrs:{label:"银行："}},[r("span",[a._v(a._s(a.ruleForm.OpenBankCode))])]),a._v(" "),r("el-form-item",{staticClass:"form_item_half",attrs:{label:"开户支行："}},[r("span",[a._v(a._s(a.ruleForm.OpenBankName))])]),a._v(" "),r("el-form-item",{staticClass:"form_item_half",attrs:{label:"银行卡号："}},[r("span",[a._v(a._s(a.ruleForm.BankCardId))])]),a._v(" "),r("el-form-item",{staticClass:"form_item_half",attrs:{label:"开户人："}},[r("span",[a._v(a._s(a.ruleForm.BankCardHolder))])])],1),a._v(" "),r("el-form-item",{staticStyle:{width:"100%",margin:"0"},attrs:{label:"","label-width":"70px"}},[r("span",{staticStyle:{"font-weight":"bold","font-size":"16px"}},[a._v("支付信息")])]),a._v(" "),r("el-col",{staticStyle:{background:"#F2F2F2","padding-top":"10px"},attrs:{span:24}},[r("el-form-item",{staticStyle:{width:"100%","margin-bottom":"10px"},attrs:{label:" ","label-width":"50px"}},[r("el-table",{ref:"singleTable",staticStyle:{width:"800px"},attrs:{data:a.payTable,border:""}},[r("el-table-column",{attrs:{prop:"PayTypeName","min-width":"100",label:"支付方式"}}),a._v(" "),r("el-table-column",{attrs:{prop:"PayDate",label:"支付日期","min-width":"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[e.row.PayDate?r("span",[a._v("\n                                    "+a._s(e.row.PayDate.substring(0,10))+" "+a._s(e.row.PayDate.substring(11,19))+"\n                                ")]):a._e()]}}])}),a._v(" "),r("el-table-column",{attrs:{prop:"ReceiveAccount",label:"收款账户","min-width":"100"}}),a._v(" "),r("el-table-column",{attrs:{prop:"ProcFee",label:"手续费","min-width":"80"}}),a._v(" "),r("el-table-column",{attrs:{prop:"ItemDetail",label:"来源","min-width":"80"}}),a._v(" "),r("el-table-column",{attrs:{prop:"Memo",label:"备注","min-width":"100","show-overflow-tooltip":""}}),a._v(" "),r("el-table-column",{attrs:{prop:"RealAmount",label:"实际金额","min-width":"100"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v("\n                                "+a._s(e.row.RealAmount.toQFW())+"\n                            ")]}}])})],1)],1)],1)],1)],1),a._v(" "),r("el-dialog",{attrs:{title:"凭证图片",visible:a.dialogImg,modal:!1,size:""},on:{"update:visible":function(e){a.dialogImg=e}}},[r("div",{staticStyle:{width:"650px"}},a._l(a.fileList,function(t){return r("div",{key:t.Id,staticClass:"imgList"},[r("img",{staticClass:"imgShow",attrs:{src:a.baseImgPath+t.ImgUrl,alt:""}}),a._v(" "),r("div",{staticClass:"layer"},[r("i",{staticClass:"el-icon-view view",on:{click:function(e){return a.imgShow(a.baseImgPath+t.ImgUrl)}}})])])}),0)])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"pic left"},[t("img",{attrs:{src:"",alt:""}})])}]}},567:function(e,t,a){a(606);var r=a(98)(a(580),a(625),"data-v-7432d7aa",null);e.exports=r.exports},580:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(100),l=i.n(a),r=i(99),n=i.n(r),s=(i(22),i(64));t.default={props:{isHos:"",dialogTableVisible1:Boolean,editMes:{},code:""},data:function(){return{debounce:1e3,payWayList:[],accountList:[],hosAccount:[],payDate:"",ruleForm:{PayDate:"",type:"",PayTypeName:"",PayType:"",Memo:"",RealAmount:0,ReceiveAccount:"",ProcFee:0,topBranch:"",ReceiveBranchCode:"",ReceiveBranchName:""},isEdit:!0,topBranchList:[],RemainAmount:0,rules:{topBranch:[{required:!0,message:"请选择",trigger:"change"}],RealAmount:[{required:!0,type:"number",message:"请填写实付金额",trigger:"blur"}],ReceiveAccount:[{required:!0,message:"请填写收款账户",trigger:"blur"}]}}},watch:{dialogTableVisible1:{handler:function(){this.init("ruleForm")},deep:!0},"ruleForm.type":{handler:function(){1==this.isHos&&(this.accountList=this.hosAccount)},deep:!0},editMes:{handler:function(e){e.PayDate?(this.initData(this.editMes),this.isEdit=!0):this.isEdit=!1},deep:!0}},mounted:function(){this.payDate=new Date,this.ruleForm.payDate=new Date,this.getPayWay(),this.editMes.PayDate?(this.initData(this.editMes),this.isEdit=!0):this.isEdit=!1},methods:{initData:function(e){this.payDate=e.PayDate?new Date(e.PayDate.substring(0,4),e.PayDate.substring(5,7)-1,e.PayDate.substring(8,10),e.PayDate.substring(11,13),e.PayDate.substring(14,16),e.PayDate.substring(17,19)):"",this.ruleForm.type=e.PayTypeName+"|"+e.PayType,this.ruleForm.RealAmount=e.RealAmount,this.ruleForm.ReceiveAccount=e.ReceiveAccount,this.ruleForm.topBranch=e.ReceiveBranchName+"|"+e.ReceiveBranchCode,this.ruleForm.ProcFee=e.ProcFee,this.ruleForm.Memo=e.Memo},dateChange:function(e){this.ruleForm.payDate=e},GetBaseBranchAccount:function(a){var r=this;return n()(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.i(s.k)(a);case 2:t=e.sent,r.accountList=t.data;case 4:case"end":return e.stop()}},e,r)}))()},GetHospitalAccountByCode:function(a){var r=this;return n()(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.i(s._31)({hospitalCode:a});case 2:t=e.sent,r.hosAccount=t.data,r.accountList=t.data;case 5:case"end":return e.stop()}},e,r)}))()},paySelect:function(){this.ruleForm.PayTypeName=this.ruleForm.type.split("|")[0],this.ruleForm.PayType=this.ruleForm.type.split("|")[1]},selBranch:function(){0<this.ruleForm.topBranch.length?(this.ruleForm.ReceiveBranchCode=this.ruleForm.topBranch.split("|")[1],this.ruleForm.ReceiveBranchName=this.ruleForm.topBranch.split("|")[0],this.isHos?this.GetHospitalAccountByCode(this.ruleForm.ReceiveBranchCode):this.GetBaseBranchAccount({keywords:""})):(this.ruleForm.ReceiveBranchCode="",this.ruleForm.ReceiveBranchName="")},getPayWay:function(){var o=this;return n()(l.a.mark(function e(){var t,a,r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o.code)return e.next=3,i.i(s._32)({branchcode:o.code});e.next=5;break;case 3:t=e.sent,o.RemainAmount=t.RemainAmount;case 5:return e.next=7,i.i(s.d)({typeId:o.isHos?"1":"2"});case 7:return a=e.sent,o.topBranchList=a.data,""==a.data[0].code&&o.topBranchList.splice(0,1),e.next=12,i.i(s.l)("0006");case 12:(r=e.sent).constructor==Array&&r.forEach(function(e){"008"!=e.DataCode&&"009"!=e.DataCode&&"010"!=e.DataCode&&"011"!=e.DataCode&&o.payWayList.push({name:e.DataName,value:e.DataCode})});case 14:case"end":return e.stop()}},e,o)}))()},submitForm:function(e){var t=this,a=this;this.$refs[e].validate(function(e){e&&(t.payDate.formatDate("yyyy-MM-dd")==(new Date).formatDate("yyyy-MM-dd")?a.ruleForm.PayDate=(new Date).formatDate("yyyy-MM-dd hh:mm:ss"):a.ruleForm.PayDate=t.payDate.formatDate("yyyy-MM-dd hh:mm:ss"),a.isEdit&&a.payDate.formatDate("yyyy-MM-dd")==a.editMes.PayDate.substring(0,10)&&(a.ruleForm.PayDate=a.editMes.PayDate),a.$emit("payOpe",a.ruleForm,a.isEdit))})},init:function(e){this.$refs[e].resetFields(),this.ruleForm.RealAmount=0,this.ruleForm.ProcFee=0,this.ruleForm.Memo="",this.ruleForm.type="",this.accountList=[],this.payDate=new Date},resetForm:function(e){this.init(e),this.$emit("payOpe",!1)}}}},592:function(e,t,a){(e.exports=a(215)(!1)).push([e.i,".form_footer[data-v-7432d7aa]{text-align:center}.form_item_ipt153[data-v-7432d7aa]{width:153px}.form_item_wt255[data-v-7432d7aa]{width:253px}",""])},606:function(e,t,a){var r=a(592);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a(216)("714243a9",r,!0)},625:function(e,t){e.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{},[a("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,rules:t.rules,inline:!0,"label-width":"110px"}},[a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"支付方式：",prop:"PayType"}},[a("el-select",{staticStyle:{width:"200px"},on:{change:t.paySelect},model:{value:t.ruleForm.type,callback:function(e){t.$set(t.ruleForm,"type",e)},expression:"ruleForm.type"}},t._l(t.payWayList,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.name+"|"+e.value}})}),1)],1),t._v(" "),a("el-form-item",{staticClass:"form_item_mt0",attrs:{label:"实际支付金额：",prop:"RealAmount"}},[a("el-input-number",{staticStyle:{width:"200px"},attrs:{debounce:t.debounce,controls:!1},model:{value:t.ruleForm.RealAmount,callback:function(e){t.$set(t.ruleForm,"RealAmount",e)},expression:"ruleForm.RealAmount"}})],1),t._v(" "),"018"==t.ruleForm.PayType?a("el-form-item",{staticClass:"form_item_mt0",attrs:{label:"预付款余额："}},[a("span",[t._v(t._s(t.RemainAmount))])]):t._e(),t._v(" "),a("el-form-item",{staticClass:"form_item_mt0",attrs:{label:"手续费："}},[a("el-input-number",{staticStyle:{width:"200px"},attrs:{debounce:t.debounce,controls:!1},model:{value:t.ruleForm.ProcFee,callback:function(e){t.$set(t.ruleForm,"ProcFee",e)},expression:"ruleForm.ProcFee"}})],1),t._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"收款时间："}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"选择日期"},model:{value:t.payDate,callback:function(e){t.payDate=e},expression:"payDate"}})],1),t._v(" "),t.isHos?t._e():a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"销售公司：",prop:"topBranch"}},[a("el-select",{staticStyle:{width:"200px"},attrs:{filterable:"",placeholder:"请选择"},on:{change:t.selBranch},model:{value:t.ruleForm.topBranch,callback:function(e){t.$set(t.ruleForm,"topBranch",e)},expression:"ruleForm.topBranch"}},t._l(t.topBranchList,function(e,t){return a("el-option",{key:t,attrs:{label:e.branchName,value:e.branchName+"|"+e.code}})}),1)],1),t._v(" "),t.isHos?a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"医院：",prop:"topBranch"}},[a("el-select",{staticStyle:{width:"200px"},attrs:{filterable:"",placeholder:"请选择"},on:{change:t.selBranch},model:{value:t.ruleForm.topBranch,callback:function(e){t.$set(t.ruleForm,"topBranch",e)},expression:"ruleForm.topBranch"}},t._l(t.topBranchList,function(e,t){return a("el-option",{key:t,attrs:{label:e.supplierName,value:e.supplierName+"|"+e.code}})}),1)],1):t._e(),t._v(" "),"001"!=t.ruleForm.PayType&&"018"!=t.ruleForm.PayType?a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"收款账户：",prop:"ReceiveAccount"}},[a("el-select",{staticStyle:{width:"200px"},attrs:{filterable:"",placeholder:"请选择"},model:{value:t.ruleForm.ReceiveAccount,callback:function(e){t.$set(t.ruleForm,"ReceiveAccount",e)},expression:"ruleForm.ReceiveAccount"}},t._l(t.accountList,function(e,t){return a("el-option",{key:t,attrs:{label:e.shortName,value:e.shortName}})}),1)],1):t._e(),t._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"备注："}},[a("el-input",{staticStyle:{width:"200px"},attrs:{type:"textarea"},model:{value:t.ruleForm.Memo,callback:function(e){t.$set(t.ruleForm,"Memo",e)},expression:"ruleForm.Memo"}})],1)],1),t._v(" "),a("div",{staticClass:"form_footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("ruleForm")}}},[t._v("确定")]),t._v(" "),a("el-button",{on:{click:function(e){return t.resetForm("ruleForm")}}},[t._v("取消")])],1)],1)},staticRenderFns:[]}}});