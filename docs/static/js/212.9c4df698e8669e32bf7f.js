webpackJsonp([212],{1525:function(e,t,r){(e.exports=r(215)(!1)).push([e.i,".form_footer[data-v-e61f1a8c]{text-align:center}.form_item_ipt153[data-v-e61f1a8c]{width:153px}.form_item_wt255[data-v-e61f1a8c]{width:253px}",""])},1950:function(e,t,r){var a=r(1525);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);r(216)("f46ddd3c",a,!0)},2425:function(e,t){e.exports={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{},[r("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"110px"}},[r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"消费商：",prop:"BranchCode",required:""}},[r("el-autocomplete",{staticStyle:{width:"250px"},attrs:{"fetch-suggestions":t.queryCus,placeholder:"请输入内容","trigger-on-focus":!1},on:{select:t.selectCus},scopedSlots:t._u([{key:"default",fn:function(e){var t=e.item;return[r("my-item-extraMember",{attrs:{item:t}})]}}]),model:{value:t.branch,callback:function(e){t.branch=e},expression:"branch"}})],1),t._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"支付方式：",prop:"type"}},[r("el-select",{staticStyle:{width:"250px"},on:{change:t.paySelect},model:{value:t.ruleForm.type,callback:function(e){t.$set(t.ruleForm,"type",e)},expression:"ruleForm.type"}},t._l(t.payWayList,function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.name+"|"+e.value}})}),1)],1),t._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"实际支付金额：",prop:"RealAmount"}},[r("el-input-number",{staticStyle:{width:"250px"},attrs:{debounce:t.debounce,controls:!1},model:{value:t.ruleForm.RealAmount,callback:function(e){t.$set(t.ruleForm,"RealAmount",e)},expression:"ruleForm.RealAmount"}})],1),t._v(" "),"018"==t.ruleForm.PayType?r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"预付款余额："}},[r("span",[t._v(t._s(t.RemainAmount))])]):t._e(),t._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"手续费："}},[r("el-input-number",{staticStyle:{width:"250px"},attrs:{debounce:t.debounce,controls:!1},model:{value:t.ruleForm.ProcFee,callback:function(e){t.$set(t.ruleForm,"ProcFee",e)},expression:"ruleForm.ProcFee"}})],1),t._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"收款时间："}},[r("el-date-picker",{staticStyle:{width:"250px"},attrs:{type:"date",placeholder:"选择日期"},model:{value:t.payDate,callback:function(e){t.payDate=e},expression:"payDate"}})],1),t._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"销售公司：",prop:"topBranch"}},[r("el-select",{staticStyle:{width:"250px"},attrs:{filterable:"",placeholder:"请选择"},on:{change:t.selBranch},model:{value:t.ruleForm.topBranch,callback:function(e){t.$set(t.ruleForm,"topBranch",e)},expression:"ruleForm.topBranch"}},t._l(t.topBranchList,function(e,t){return r("el-option",{key:t,attrs:{label:e.branchName,value:e.branchName+"|"+e.code}})}),1)],1),t._v(" "),"001"!=t.ruleForm.PayType&&"018"!=t.ruleForm.PayType?r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"收款账户：",prop:"ReceiveAccount"}},[r("el-select",{staticStyle:{width:"250px"},attrs:{filterable:"",placeholder:"请选择"},model:{value:t.ruleForm.ReceiveAccount,callback:function(e){t.$set(t.ruleForm,"ReceiveAccount",e)},expression:"ruleForm.ReceiveAccount"}},t._l(t.accountList,function(e,t){return r("el-option",{key:t,attrs:{label:e.shortName,value:e.shortName}})}),1)],1):t._e(),t._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"备注："}},[r("el-input",{staticStyle:{width:"250px"},attrs:{type:"textarea"},model:{value:t.ruleForm.Memo,callback:function(e){t.$set(t.ruleForm,"Memo",e)},expression:"ruleForm.Memo"}})],1),t._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:""}},[r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("ruleForm")}}},[t._v("确定")]),t._v(" "),r("el-button",{on:{click:function(e){return t.resetForm("ruleForm")}}},[t._v("取消")])],1)],1)],1)},staticRenderFns:[]}},255:function(e,t,r){r(1950);var a=r(98)(r(951),r(2425),"data-v-e61f1a8c",null);e.exports=a.exports},951:function(e,t,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=m(100),p=m.n(r),a=m(103),h=m.n(a),n=m(99),o=m.n(n),s=m(22),d=m(64);m(1).default.component("my-item-extraMember",{functional:!0,render:function(e,t){var r=t.props.item;return e("div",t.data,[e("p",{attrs:{class:"select_name"+r.Type,title:r.name}},["名字："+r.name]),e("p",{attrs:{class:"select_name"+r.Type,title:r.name}},["编号："+r.code]),e("p",{attrs:{class:"select_name"+r.Type,title:r.name}},["手机号："+r.phone])])},props:{item:{type:Object,required:!0}}}),t.default={data:function(){return{branch:"",debounce:1e3,payWayList:[],accountList:[],hosAccount:[],payDate:"",ruleForm:{BranchCode:"",PayDate:"",type:"",PayTypeName:"",PayType:"",Memo:"",RealAmount:0,ReceiveAccount:"",ProcFee:0,topBranch:"",ReceiveBranchCode:"",ReceiveBranchName:"",ItemType:5,ItemDetail:"额外费用",createUserId:m.i(s.b)("userId"),createBy:m.i(s.b)("userName")},customerList:[],isEdit:!0,topBranchList:[],RemainAmount:0,rules:{topBranch:[{required:!0,message:"请选择",trigger:"change"}],RealAmount:[{required:!0,type:"number",message:"请填写实付金额",trigger:"blur"}],ReceiveAccount:[{required:!0,message:"请填写收款账户",trigger:"change"}],BranchCode:[{required:!0,message:"请选择支付方式",trigger:"change"}],type:[{required:!0,message:"请选择消费商",trigger:"change"}]}}},watch:{},mounted:function(){this.payDate=new Date,this.ruleForm.payDate=new Date,this.getPayWay()},methods:{queryCus:function(e,t){this.customerList=[],(this.ruleForm.BranchCode="")!==e&&null!=e&&this.getBranchByKeywords({keywords:e.removeSP()});var r=this;clearTimeout(this.timeout),this.timeout=setTimeout(function(){t(r.customerList)},1e3)},selectCus:function(e){this.ruleForm.BranchCode=e.code?e.code:""},getBranchByKeywords:function(l){var u=this;return o()(p.a.mark(function e(){var t,r,a,n,o,s,c,i;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.i(d._60)(l);case 3:if(!((t=e.sent)instanceof Array&&0<t.length)){e.next=24;break}for(a=!(r=!0),n=void 0,e.prev=8,o=h()(t);!(r=(s=o.next()).done);r=!0)c=s.value,(i="")!=c.BranchTags&&null!=c.BranchTags&&null!=c.BranchTags&&(i="("+c.BranchTags+")"),u.customerList.push({value:c.BranchName+i,phone:c.PhoneNumber,code:c.Code,name:c.BranchName+i,hospitalCode:c.HospitalCode,hospitalName:c.HospitalName});e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),a=!0,n=e.t0;case 16:e.prev=16,e.prev=17,!r&&o.return&&o.return();case 19:if(e.prev=19,a)throw n;e.next=22;break;case 22:return e.finish(19);case 23:return e.finish(16);case 24:u.loading1=!1,e.next=30;break;case 27:e.prev=27,e.t1=e.catch(0),console.log(e.t1);case 30:case"end":return e.stop()}},e,u,[[0,27],[8,12,16,24],[17,,19,23]])}))()},dateChange:function(e){this.ruleForm.payDate=e},GetBaseBranchAccount:function(r){var a=this;return o()(p.a.mark(function e(){var t;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.i(d.k)(r);case 2:t=e.sent,a.accountList=t.data;case 4:case"end":return e.stop()}},e,a)}))()},GetHospitalAccountByCode:function(r){var a=this;return o()(p.a.mark(function e(){var t;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.i(d._31)({hospitalCode:r});case 2:t=e.sent,a.hosAccount=t.data,a.accountList=t.data;case 5:case"end":return e.stop()}},e,a)}))()},paySelect:function(){this.ruleForm.PayTypeName=this.ruleForm.type.split("|")[0],this.ruleForm.PayType=this.ruleForm.type.split("|")[1]},selBranch:function(){0<this.ruleForm.topBranch.length?(this.ruleForm.ReceiveBranchCode=this.ruleForm.topBranch.split("|")[1],this.ruleForm.ReceiveBranchName=this.ruleForm.topBranch.split("|")[0],this.GetBaseBranchAccount({keywords:this.ruleForm.ReceiveBranchCode})):(this.ruleForm.ReceiveBranchCode="",this.ruleForm.ReceiveBranchName="")},getPayWay:function(){var n=this;return o()(p.a.mark(function e(){var t,r,a;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.i(d._32)({branchcode:n.code});case 2:return t=e.sent,n.RemainAmount=t.RemainAmount,e.next=6,m.i(d.d)({typeId:n.isHos?"1":"2"});case 6:return r=e.sent,n.topBranchList=r.data,""==r.data[0].code&&n.topBranchList.splice(0,1),e.next=11,m.i(d.l)("0006");case 11:(a=e.sent).constructor==Array&&a.forEach(function(e){"008"!=e.DataCode&&"009"!=e.DataCode&&"010"!=e.DataCode&&"011"!=e.DataCode&&n.payWayList.push({name:e.DataName,value:e.DataCode})});case 13:case"end":return e.stop()}},e,n)}))()},submitForm:function(e){var t=this,r=this;this.$refs[e].validate(function(e){e&&(t.payDate.formatDate("yyyy-MM-dd")==(new Date).formatDate("yyyy-MM-dd")?r.ruleForm.PayDate=(new Date).formatDate("yyyy-MM-dd hh:mm:ss"):r.ruleForm.PayDate=t.payDate.formatDate("yyyy-MM-dd hh:mm:ss"),t.AddBranchOrderPay(r.ruleForm))})},init:function(e){this.$refs[e].resetFields(),this.ruleForm.BranchCode="",this.ruleForm.RealAmount=0,this.ruleForm.ProcFee=0,this.ruleForm.Memo="",this.ruleForm.type="",this.accountList=[],this.payDate=new Date},resetForm:function(e){this.$refs[e].resetFields(),this.payDate=new Date},AddBranchOrderPay:function(r){var a=this;return o()(p.a.mark(function e(){var t;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.i(d._292)(r);case 2:(t=e.sent).status?(a.$message({type:"success",message:"添加成功"}),a.resetForm("ruleForm")):a.$message({type:"warning",message:"添加失败!"+t.errorMessage});case 4:case"end":return e.stop()}},e,a)}))()}}}}});