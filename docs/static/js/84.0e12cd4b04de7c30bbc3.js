webpackJsonp([84],{1175:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(37),s=o.n(r),a=o(100),i=o.n(a),n=o(99),l=o.n(n),u=o(22),m=o(64);o(1).default.component("my-item-ordonPro",{functional:!0,render:function(e,t){var r=t.props.item;return e("li",t.data,[e("p",{attrs:{class:"select_name",title:r.Name}},["名称："+r.GoodsAlias]),e("p",{attrs:{class:"select_code",title:r.Name}},["编号："+r.GoodsCode]),e("p",{attrs:{class:"select_code",title:r.Name}},["医院："+r.SupplierName]),e("p",{attrs:{class:"select_code",title:r.Name}},["价格区间："+r.priceRange])])},props:{item:{type:Object,required:!0}}}),t.default={props:{editMes:{}},data:function(){return{isDrug:!1,ruleForm:{wareHouse:"",date:new Date,hospital:"",operator:o.i(u.b)("userName"),memo:""},saveLoading:!1,SpecList:[],drugList:[],opeIndex:"",tableData:[],hospitalList:[],whList:[],allWhList:[]}},watch:{"ruleForm.hospital":{handler:function(e,t){""!=t&&(this.ruleForm.wareHouse=""),this.hosSel()},deep:!0}},mounted:function(){this.addTable&&(this.addLabel={label1:"出库时间"}),this.GetBaseDataAll()},methods:{numChange:function(e){var t=this;setTimeout(function(){t.tableData[e].inventoryAmount=t.tableData[e].inventoryQuantity.mul(t.tableData[e].realPrice),t.tableData[e].profitLossQuantity=t.tableData[e].bookQuantity.red(t.tableData[e].inventoryQuantity),t.tableData[e].profitLossAmount=t.tableData[e].bookAmount.red(t.tableData[e].inventoryAmount)},20)},hosSel:function(e){var t=this;if(0<e.length){var r=e.split("|")[1];this.whList=[],this.allWhList.forEach(function(e){e.hospitalCode==r&&t.whList.push(e)})}else this.allWhList=[]},addDrug:function(){this.$emit("addDrug",{warehouseId:0<this.ruleForm.wareHouse.length?this.ruleForm.wareHouse.split("|")[1]:"",hospitalCode:0<this.ruleForm.hospital.length?this.ruleForm.hospital.split("|")[1]:"",pageIndex:1,pageSize:10,keywords:"hz100014"})},addTable:function(e){this.tableData.push(e)},clickIndex:function(e){this.opeIndex=e},GetInventoryDetail:function(r){var a=this;return l()(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.i(m._9)({id:r});case 2:t=e.sent,a.tableData=t.data.stockInventoryDrugList;case 4:case"end":return e.stop()}},e,a)}))()},GetBaseDataAll:function(){var a=this;return l()(i.a.mark(function e(){var t,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={startdate:"",enddate:"",suppliername:"",suptypecode:"",phonenumber:"",pageindex:1,pagesize:1e3},e.next=4,o.i(m.x)(t);case 4:return a.hospitalList=e.sent,e.next=7,o.i(m.e)({hospitalCode:"",pageIndex:1,pageSize:100,keywords:"",typeId:1});case 7:r=e.sent,a.allWhList=JSON.parse(s()(r.data)),a.whList=JSON.parse(s()(r.data)),a.editMes.inventoryCode&&(a.GetInventoryDetail(a.editMes.id),a.copyData(a.editMes)),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop()}},e,a,[[0,13]])}))()},copyData:function(e){for(var t in e)null==e[t]&&(e[t]="");this.ruleForm={id:e.id,inventoryCode:e.inventoryCode,wareHouse:0<e.warehouseName.length?e.warehouseName+"|"+e.warehouseId:"",date:new Date,hospital:0<e.hospitalCode.length?e.hospitalName+"|"+e.hospitalCode:"",operator:o.i(u.b)("userName"),memo:e.memo},e.inventoryDate&&this.$set(this.ruleForm,"date",new Date(e.inventoryDate.substring(0,4),Number(e.inventoryDate.substring(5,7))-1,e.inventoryDate.substring(8,10)))},selectPro:function(e){this.tableData[this.opeIndex].name=e.Name,this.tableData[this.opeIndex].code=e.code,this.SpecList[this.opeIndex]=e.GUList,this.SpecList.push()},deleteRow:function(e,t){t.splice(e,1)},sure:function(e){var r=this,a=this.getAmount();this.$refs[e].validate(function(e){if(!e)return!1;var t={InventoryDate:r.ruleForm.date.formatDate("yyyy-MM-dd"),hospitalCode:0<r.ruleForm.hospital.length?r.ruleForm.hospital.split("|")[1]:"",hospitalName:0<r.ruleForm.hospital.length?r.ruleForm.hospital.split("|")[0]:"",inventoryId:0<r.ruleForm.wareHouse.length?r.ruleForm.wareHouse.split("|")[1]:"",inventoryName:0<r.ruleForm.wareHouse.length?r.ruleForm.wareHouse.split("|")[0]:"",bookAmount:a[1],bookQuantity:a[0],inventoryAmount:a[3],inventoryQuantity:a[2],profitLossAmount:a[4],memo:r.ruleForm.memo,warehouseId:0<r.ruleForm.wareHouse.length?r.ruleForm.wareHouse.split("|")[1]:"",warehouseName:0<r.ruleForm.wareHouse.length?r.ruleForm.wareHouse.split("|")[0]:"",inventoryDrugList:s()(r.tableData)};r.saveLoading=!0,r.editMes.inventoryCode?(t.modifiedUserId=o.i(u.b)("userId"),t.modifiedBy=o.i(u.b)("userName"),t.id=r.ruleForm.id,t.inventoryCode=r.ruleForm.inventoryCode,r.UpdateStockInventory(t)):(t.createUserId=o.i(u.b)("userId"),t.createBy=o.i(u.b)("userName"),r.AddStockInventory(t))})},getAmount:function(){var t=0,r=0,a=0,o=0,s=0;return this.tableData.forEach(function(e){t=t.add(e.bookQuantity),a=a.add(e.bookAmount),r=r.add(e.inventoryQuantity),o=o.add(e.inventoryAmount),s=s.add(e.profitLossAmount)}),[t,a,r,o,s]},cancel:function(){this.$emit("addClose",!1)},AddStockInventory:function(r){var a=this;return l()(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.i(m._10)(r);case 2:t=e.sent,a.saveLoading=!1,t.status?(a.$message({message:"添加成功",type:"success"}),a.$emit("addClose",!0)):a.$message.error("添加失败"+t.errorMessage);case 5:case"end":return e.stop()}},e,a)}))()},UpdateStockInventory:function(r){var a=this;return l()(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.i(m._11)(r);case 2:t=e.sent,a.saveLoading=!1,t.status?(a.$message({message:"编辑成功",type:"success"}),a.$emit("addClose",!0)):a.$message.error("编辑失败"+t.errorMessage);case 5:case"end":return e.stop()}},e,a)}))()}},components:{}}},1180:function(e,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=d(100),p=d.n(r),a=d(103),h=d.n(a),o=d(37),f=d.n(o),s=d(99),i=d.n(s),v=(d(22),d(64));d(1).default.component("my-item-ordonProOut",{functional:!0,render:function(e,t){var r=t.props.item;return e("div",t.data,[e("p",{attrs:{class:"select_name"}},["名称："+r.Name]),e("p",{attrs:{class:"select_code"}},["批号："+r.batchNumber]),e("p",{attrs:{class:"select_code"}},["仓库："+r.warehouseName]),e("p",{attrs:{class:"select_code"}},["规格："+r.unitName]),e("p",{attrs:{class:"select_code"}},["库存："+r.remainingCount]),e("p",{attrs:{class:"select_code"}},["产地："+r.originAddress]),e("p",{attrs:{class:"select_code"}},["有效期："+r.effectiveDate.substring(0,10)])])},props:{item:{type:Object,required:!0}}}),t.default={props:{addStore:"",searchMes:{}},data:function(){return{ruleForm:{quantity:0,bookQuantity:0,profitLossAmount:0,profitLossQuantity:0,inventoryQuantity:0,inventoryAmount:0,bookAmount:0},tableData:[],drugList:[],drug:"",Spec:"",opeIndex:0,SpecList:[]}},mounted:function(){},methods:{calAmount:function(){var e=this;window.clearTimeout(),setTimeout(function(){e.ruleForm.profitLossAmount=e.ruleForm.bookAmount.red(e.ruleForm.inventoryAmount)},100)},calNum:function(){var e=this;window.clearTimeout(),setTimeout(function(){e.ruleForm.bookAmount=e.ruleForm.bookQuantity.mul(e.ruleForm.realPrice),e.ruleForm.profitLossQuantity=e.ruleForm.bookQuantity.red(e.ruleForm.inventoryQuantity),e.ruleForm.inventoryAmount=e.ruleForm.inventoryQuantity.mul(e.ruleForm.realPrice),e.ruleForm.profitLossAmount=e.ruleForm.bookAmount.red(e.ruleForm.inventoryAmount)},100)},selectPro:function(e){this.ruleForm.drugName=e.Name,this.ruleForm.drugId=e.code,this.ruleForm.jiType=e.jiType,this.ruleForm.dwName=e.dwName,this.ruleForm.productionDate=e.productionDate,this.ruleForm.manufacturer=e.manufacturer,this.ruleForm.originAddress=e.originAddress,this.ruleForm.quantity=0,this.ruleForm.bookQuantity=e.remainingCount,this.ruleForm.realPrice=e.realPrice,this.ruleForm.price=e.price,this.ruleForm.effectiveDate=e.effectiveDate.substring(0,10),this.ruleForm.totalAmount=0,this.ruleForm.salePrice=e.salePrice,this.ruleForm.batchNumber=e.batchNumber,this.ruleForm.unitName=e.unitName,this.ruleForm.warehouseId=e.warehouseId,this.ruleForm.approvalNumber=e.approvalNumber,this.calNum()},queryPro:function(e,t){this.drugList=[],""!==e&&null!=e&&this.getProject(e),this.cleanData();var r=this;clearTimeout(this.timeout),this.timeout=setTimeout(function(){t(r.drugList)},1e3)},cleanData:function(){this.ruleForm={quantity:0,bookQuantity:0,profitLossAmount:0,profitLossQuantity:0,inventoryQuantity:0,inventoryAmount:0,bookAmount:0}},getProject:function(m){var c=this;return i()(p.a.mark(function e(){var t,r,a,o,s,i,n,l,u;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=JSON.parse(f()(c.searchMes))).keywords=m,e.next=4,d.i(v._8)(t);case 4:if(r=e.sent,a=[],!(r.data instanceof Array&&0<r.data.length)){e.next=26;break}for(s=!(o=!0),i=void 0,e.prev=10,n=h()(r.data);!(o=(l=n.next()).done);o=!0)u=l.value,a.push({value:u.drugName,code:u.drugId,GoodsCode:u.drugId,Name:u.drugName,unitName:u.unitName,dwName:u.dwName,batchNumber:u.batchNumber,manufacturer:u.manufacturer,effectiveDate:u.effectiveDate?u.effectiveDate:"",productionDate:u.productionDate?u.productionDate:"",originAddress:u.originAddress,realPrice:u.realPrice,salePrice:u.salePrice,jiType:u.jiType,remainingCount:u.remainingCount,warehouseName:u.warehouseName,approvalNumber:u.approvalNumber});e.next=18;break;case 14:e.prev=14,e.t0=e.catch(10),s=!0,i=e.t0;case 18:e.prev=18,e.prev=19,!o&&n.return&&n.return();case 21:if(e.prev=21,s)throw i;e.next=24;break;case 24:return e.finish(21);case 25:return e.finish(18);case 26:c.drugList=a;case 27:case"end":return e.stop()}},e,c,[[10,14,18,26],[19,,21,25]])}))()},sure:function(){this.ruleForm.totalAmount=this.ruleForm.realPrice.mul(this.ruleForm.quantity),this.$emit("selSure",!0,this.ruleForm)},cancel:function(){this.$emit("selSure",!1)}},components:{}}},1184:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(100),i=s.n(r),a=s(99),n=s.n(a),o=s(37),l=s.n(o),u=(s(101),s(65)),m=(s.n(u),s(22),s(2100)),c=s.n(m),d=s(2105),p=s.n(d),h=s(64);t.default={data:function(){return{date:"",editMes:{},addStore:"盘点",isDrug:!1,saveLoading:!1,loading:!1,title:"",tag:!1,total:0,size:10,currentPage:1,formInline:{warehouseId:"",supplier:"",keywords:"",typeCode:"",hospitalCode:"",startDate:"",endDate:""},tableData:[],hospitalList:[],supplierList:[],searchMes:{},whList:[],allWhList:[]}},computed:{},mounted:function(){this.date=[new Date,new Date],this.GetDropDownPermission()},methods:{hosSelect:function(t){var r=this;this.whList=[],this.allWhList.forEach(function(e){e.hospitalCode==t&&r.whList.push(e)})},openView:function(e){this.editMes=JSON.parse(l()(e)),this.editMes.view=!0,this.tag=!0,this.title="详情"},dateChange:function(e){e?(e=e.formatDates(),this.formInline.startDate=e.substring(0,10),this.formInline.endDate=e.substring(13)):(this.formInline.startDate="",this.formInline.endDate="")},GetDropDownPermission:function(){var o=this;return n()(i.a.mark(function e(){var t,r,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.i(h.d)({typeId:1});case 2:return t=e.sent,o.hospitalList=t.data,e.next=6,s.i(h.N)({hospitalCode:"",pageIndex:1,pageSize:1e3,keywords:""});case 6:return r=e.sent,o.supplierList=r.data,e.next=10,s.i(h.e)({hospitalCode:"",pageIndex:1,pageSize:100,keywords:"",typeId:1});case 10:a=e.sent,o.allWhList=JSON.parse(l()(a.data));case 12:case"end":return e.stop()}},e,o)}))()},DeleteInventoryById:function(t){var r=this;return n()(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.i(h._6)(t);case 3:e.sent.status?(r.$message({message:"删除成功",type:"success"}),r.search()):r.$message.error("删除失败"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0),r.$message.error("删除失败");case 11:case"end":return e.stop()}},e,r,[[0,7]])}))()},GetInventory:function(r){var a=this;return n()(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.loading=!0,e.next=4,s.i(h._7)(r);case 4:t=e.sent,a.tableData=t.data,a.total=t.count,a.loading=!1,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}},e,a,[[0,10]])}))()},onSubmit:function(){this.currentPage=1,this.search()},search:function(){this.GetInventory({warehouseId:this.formInline.warehouseId,hospitalCode:this.formInline.hospitalCode,stockSupplierCode:this.formInline.supplier,startDate:this.formInline.startDate,endDate:this.formInline.endDate,pageIndex:this.currentPage,pageSize:this.size,keywords:this.formInline.keywords.removeSP()})},handleSizeChange:function(e){this.size=e,this.search()},handleCurrentChange:function(e){this.currentPage=e,this.search()},addTag:function(e,t,r){this.tag=!0,this.title=e,r&&(this.editMes=JSON.parse(l()(r[t])))},deleteRow:function(e,t){var r=this;this.$confirm("此操作将删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r.DeleteInventoryById({id:t[e].id})}).catch(function(){})},approve:function(){},account:function(){},pay:function(){},addDrug:function(e){this.isDrug=!0,this.searchMes=e},selSure:function(e,t){e&&this.$refs.addS.addTable(t),this.isDrug=!1},addClose:function(e){this.tag=!1,e&&this.search()}},components:{add:c.a,selDrug:p.a}}},1354:function(e,t,r){(e.exports=r(215)(!1)).push([e.i,".wt200[data-v-4823aadd]{width:200px}",""])},1376:function(e,t,r){(e.exports=r(215)(!1)).push([e.i,".form_span[data-v-501eb676]{display:block;line-height:40px}",""])},1531:function(e,t,r){(e.exports=r(215)(!1)).push([e.i,"",""])},1779:function(e,t,r){var a=r(1354);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);r(216)("be4e52fc",a,!0)},1801:function(e,t,r){var a=r(1376);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);r(216)("7a643cf4",a,!0)},1956:function(e,t,r){var a=r(1531);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);r(216)("5c5dfa02",a,!0)},2100:function(e,t,r){r(1801);var a=r(98)(r(1175),r(2274),"data-v-501eb676",null);e.exports=a.exports},2105:function(e,t,r){r(1779);var a=r(98)(r(1180),r(2251),"data-v-4823aadd",null);e.exports=a.exports},2251:function(e,t){e.exports={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"selCommon editRegister"},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,inline:!0,"label-width":"85px"}},[r("el-form-item",{staticClass:"form_item_mt0",attrs:{label:"药品名称："}},[r("el-autocomplete",{staticStyle:{width:"200px"},attrs:{"fetch-suggestions":t.queryPro,placeholder:"请输入内容","trigger-on-focus":!1},on:{select:t.selectPro},scopedSlots:t._u([{key:"default",fn:function(e){var t=e.item;return[r("my-item-ordonProOut",{attrs:{item:t}})]}}]),model:{value:t.drug,callback:function(e){t.drug=e},expression:"drug"}})],1),t._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"规格："}}),t._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"药品编号："}},[r("div",{staticClass:"wt200"},[t._v(t._s(t.ruleForm.drugId))])]),t._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"剂型："}},[r("div",{staticClass:"wt200"},[t._v(t._s(t.ruleForm.jiType))])]),t._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"单位："}},[r("div",{staticClass:"wt200"},[t._v(t._s(t.ruleForm.dwName))])]),t._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"采购进价："}},[r("div",{staticClass:"wt200"},[t._v(t._s(t.ruleForm.realPrice))])]),t._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"基础进价："}},[r("div",{staticClass:"wt200"},[t._v(t._s(t.ruleForm.price))])]),t._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"售价："}},[r("div",{staticClass:"wt200"},[t._v(t._s(t.ruleForm.salePrice))])]),t._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"批号："}},[r("div",{staticClass:"wt200"},[t._v(t._s(t.ruleForm.batchNumber))])]),t._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"产地："}},[r("div",{staticClass:"wt200"},[t._v(t._s(t.ruleForm.originAddress))])]),t._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"账面数量："}},[r("el-input-number",{staticStyle:{width:"200px"},attrs:{placeholder:"",debounce:1e3,controls:!1,min:0},on:{change:t.calNum},model:{value:t.ruleForm.bookQuantity,callback:function(e){t.$set(t.ruleForm,"bookQuantity",e)},expression:"ruleForm.bookQuantity"}})],1),t._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"账面金额："}},[r("el-input-number",{staticStyle:{width:"200px"},attrs:{placeholder:"",debounce:1e3,controls:!1,min:0},on:{change:t.calAmount},model:{value:t.ruleForm.bookAmount,callback:function(e){t.$set(t.ruleForm,"bookAmount",e)},expression:"ruleForm.bookAmount"}})],1),t._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"盘点数量："}},[r("el-input-number",{staticStyle:{width:"200px"},attrs:{placeholder:"",debounce:1e3,controls:!1,min:0},on:{change:t.calNum},model:{value:t.ruleForm.inventoryQuantity,callback:function(e){t.$set(t.ruleForm,"inventoryQuantity",e)},expression:"ruleForm.inventoryQuantity"}})],1),t._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"盘点金额："}},[r("el-input-number",{staticStyle:{width:"200px"},attrs:{placeholder:"",debounce:1e3,controls:!1,min:0},on:{change:t.calAmount},model:{value:t.ruleForm.inventoryAmount,callback:function(e){t.$set(t.ruleForm,"inventoryAmount",e)},expression:"ruleForm.inventoryAmount"}})],1),t._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"盈亏数量："}},[r("el-input-number",{staticStyle:{width:"200px"},attrs:{placeholder:"",debounce:1e3,controls:!1},model:{value:t.ruleForm.profitLossQuantity,callback:function(e){t.$set(t.ruleForm,"profitLossQuantity",e)},expression:"ruleForm.profitLossQuantity"}})],1),t._v(" "),r("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"盈亏金额："}},[r("el-input-number",{staticStyle:{width:"200px"},attrs:{placeholder:"",debounce:1e3,controls:!1},model:{value:t.ruleForm.profitLossAmount,callback:function(e){t.$set(t.ruleForm,"profitLossAmount",e)},expression:"ruleForm.profitLossAmount"}})],1)],1),t._v(" "),r("div",{staticClass:"form_footer"},[r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.sure("ruleForm")}}},[t._v("保存")]),t._v(" "),r("el-button",{on:{click:function(e){return t.cancel("ruleForm")}}},[t._v("取消")])],1)],1)},staticRenderFns:[]}},2274:function(e,t){e.exports={render:function(){var r=this,e=r.$createElement,a=r._self._c||e;return a("div",{staticClass:"selCommon editRegister"},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:r.ruleForm,inline:!0,"label-width":"85px"}},[a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"盘点日期："}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"选择日期"},model:{value:r.ruleForm.date,callback:function(e){r.$set(r.ruleForm,"date",e)},expression:"ruleForm.date"}})],1),r._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"医院：",prop:"hospital",rules:[{required:!0,message:"不能为空"}]}},[a("el-select",{staticStyle:{width:"200px"},model:{value:r.ruleForm.hospital,callback:function(e){r.$set(r.ruleForm,"hospital",e)},expression:"ruleForm.hospital"}},[a("el-option",{attrs:{label:"空",value:""}}),r._v(" "),r._l(r.hospitalList,function(e,t){return a("el-option",{key:t,attrs:{label:e.SupplierName,value:e.SupplierName+"|"+e.Code}})})],2)],1),r._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"盘点仓库：",prop:"wareHouse",rules:[{required:!0,message:"不能为空"}]}},[a("el-select",{staticStyle:{width:"200px"},model:{value:r.ruleForm.wareHouse,callback:function(e){r.$set(r.ruleForm,"wareHouse",e)},expression:"ruleForm.wareHouse"}},r._l(r.whList,function(e,t){return a("el-option",{key:t,attrs:{label:e.warehouseName,value:e.warehouseName+"|"+e.id}})}),1)],1),r._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"操作人："}},[a("span",[r._v(r._s(r.ruleForm.operator))])]),r._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:" ","label-width":"20px"}},[a("el-table",{staticStyle:{width:"950px","margin-top":"15px","margin-bottom":"10px"},attrs:{data:r.tableData,border:"","max-height":"400"}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:r._u([{key:"default",fn:function(e){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[a("el-form-item",{staticStyle:{"margin-right":"25px","line-height":"30px"},attrs:{label:"商品编号："}},[a("span",{staticClass:"form_span"},[r._v(r._s(e.row.drugId))])]),r._v(" "),a("el-form-item",{staticStyle:{"margin-right":"25px","line-height":"30px"},attrs:{label:"剂型："}},[a("span",{staticClass:"form_span"},[r._v(r._s(e.row.jiType))])]),r._v(" "),a("el-form-item",{staticStyle:{"margin-right":"25px","line-height":"30px"},attrs:{label:"单位："}},[a("span",{staticClass:"form_span"},[r._v(r._s(e.row.dwName))])]),r._v(" "),a("el-form-item",{staticStyle:{"margin-right":"25px","line-height":"30px"},attrs:{label:"生产日期："}},[e.row.productionDate?a("span",{staticClass:"form_span"},[r._v(r._s(e.row.productionDate.substring(0,10)))]):r._e()]),r._v(" "),a("el-form-item",{staticStyle:{"margin-right":"25px","line-height":"30px"},attrs:{label:"有效期："}},[e.row.EffectiveDate?a("span",{staticClass:"form_span"},[r._v(r._s(e.row.EffectiveDate.substring(0,10)))]):r._e()]),r._v(" "),a("el-form-item",{staticStyle:{"margin-right":"25px","line-height":"30px"},attrs:{label:"生产厂家："}},[a("span",{staticClass:"form_span"},[r._v(r._s(e.row.manufacturer))])]),r._v(" "),a("el-form-item",{staticStyle:{"margin-right":"25px","line-height":"30px"},attrs:{label:"产地："}},[a("span",{staticClass:"form_span"},[r._v(r._s(e.row.originAddress))])])],1)]}}])}),r._v(" "),a("el-table-column",{attrs:{prop:"drugName",label:"药品名称","min-width":"120"}}),r._v(" "),a("el-table-column",{attrs:{prop:"unitName",label:"规格","min-width":"100"}}),r._v(" "),a("el-table-column",{attrs:{prop:"bookQuantity",label:"账面数量","min-width":"80"}}),r._v(" "),a("el-table-column",{attrs:{prop:"realPrice",label:"采购进价","min-width":"80"}}),r._v(" "),a("el-table-column",{attrs:{prop:"price",label:"基础进价","min-width":"80"}}),r._v(" "),a("el-table-column",{attrs:{prop:"bookAmount",label:"账面金额","min-width":"80"}}),r._v(" "),a("el-table-column",{attrs:{prop:"inventoryQuantity",label:"盘点数量","min-width":"80"},scopedSlots:r._u([{key:"default",fn:function(t){return[a("el-input-number",{staticStyle:{width:"70px"},attrs:{min:0,controls:!1,debounce:1e3},on:{change:function(e){return r.numChange(t.$index)}},model:{value:t.row.inventoryQuantity,callback:function(e){r.$set(t.row,"inventoryQuantity",e)},expression:"scope.row.inventoryQuantity"}})]}}])}),r._v(" "),a("el-table-column",{attrs:{prop:"inventoryAmount",label:"盘点金额","min-width":"80"}}),r._v(" "),a("el-table-column",{attrs:{prop:"profitLossQuantity",label:"盈亏数量","min-width":"80"}}),r._v(" "),a("el-table-column",{attrs:{prop:"profitLossAmount",label:"盈亏金额","min-width":"80"}}),r._v(" "),r.editMes.view?r._e():a("el-table-column",{attrs:{prop:"status",label:"操作",width:"80"},scopedSlots:r._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return r.deleteRow(t.$index,r.tableData)}}},[r._v("删除")])]}}],null,!1,843965033)})],1),r._v(" "),r.editMes.view?r._e():a("el-button",{attrs:{type:"success",size:"small"},on:{click:r.addDrug}},[r._v("添加药品")])],1),r._v(" "),a("el-form-item",{staticClass:"form_item_mt1",attrs:{label:"备注："}},[a("el-input",{staticStyle:{width:"500px"},attrs:{type:"textarea",rows:4},model:{value:r.ruleForm.memo,callback:function(e){r.$set(r.ruleForm,"memo",e)},expression:"ruleForm.memo"}})],1)],1),r._v(" "),r.editMes.view?r._e():a("div",{staticClass:"form_footer"},[a("el-button",{attrs:{type:"primary",loading:r.saveLoading},on:{click:function(e){return r.sure("ruleForm")}}},[r._v("保存")]),r._v(" "),a("el-button",{on:{click:function(e){return r.cancel("ruleForm")}}},[r._v("取消")])],1)],1)},staticRenderFns:[]}},2431:function(e,t){e.exports={render:function(){var r=this,e=r.$createElement,a=r._self._c||e;return a("div",{staticClass:"tag selCommon"},[a("el-form",{staticClass:"demo-form-inline form_search",attrs:{inline:!0,model:r.formInline,"label-width":"80px"}},[a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"盘点日期："}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"daterange",placeholder:"选择日期"},on:{change:r.dateChange},model:{value:r.date,callback:function(e){r.date=e},expression:"date"}})],1),r._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"盘点编号："}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&r._k(e.keyCode,"enter",13,e.key,"Enter")?null:r.onSubmit(e)}},model:{value:r.formInline.keywords,callback:function(e){r.$set(r.formInline,"keywords",e)},expression:"formInline.keywords"}})],1),r._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"医院："}},[a("el-select",{staticStyle:{width:"200px"},on:{change:r.hosSelect},model:{value:r.formInline.hospitalCode,callback:function(e){r.$set(r.formInline,"hospitalCode",e)},expression:"formInline.hospitalCode"}},r._l(r.hospitalList,function(e,t){return a("el-option",{key:t,attrs:{label:e.supplierName,value:e.code}})}),1)],1),r._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"仓库："}},[a("el-select",{staticStyle:{width:"200px"},model:{value:r.formInline.warehouseId,callback:function(e){r.$set(r.formInline,"warehouseId",e)},expression:"formInline.warehouseId"}},[a("el-option",{attrs:{label:"全部",value:""}}),r._v(" "),r._l(r.whList,function(e,t){return a("el-option",{key:t,attrs:{label:e.warehouseName,value:e.id}})})],2)],1),r._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"供应商："}},[a("el-select",{staticStyle:{width:"200px"},model:{value:r.formInline.supplier,callback:function(e){r.$set(r.formInline,"supplier",e)},expression:"formInline.supplier"}},[a("el-option",{attrs:{label:"全部",value:""}}),r._v(" "),r._l(r.supplierList,function(e,t){return a("el-option",{key:t,attrs:{label:e.stockSupplierName,value:e.stockSupplierCode}})})],2)],1),r._v(" "),a("el-form-item",{staticClass:"form_item_mt10",attrs:{label:" "}},[a("el-button",{staticClass:"searchBtn",attrs:{type:"primary"},on:{click:r.onSubmit}},[r._v("查询")]),r._v(" "),a("el-button",{staticClass:"searchBtn",attrs:{type:"primary"},on:{click:function(e){return r.addTag("添加")}}},[r._v("添加盘点")])],1)],1),r._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:r.loading,expression:"loading"}],staticClass:"smt min_table",staticStyle:{width:"100%","margin-top":"15px","margin-bottom":"10px"},attrs:{data:r.tableData,border:"","max-height":"560"}},[a("el-table-column",{attrs:{prop:"inventoryCode",label:"盘点编号","min-width":"90"},scopedSlots:r._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(e){return r.openView(t.row)}}},[r._v(r._s(t.row.inventoryCode))])]}}])}),r._v(" "),a("el-table-column",{attrs:{prop:"createOn",label:"盘点日期","min-width":"90"},scopedSlots:r._u([{key:"default",fn:function(e){return[e.row.createOn?a("span",[r._v(r._s(e.row.createOn.substring(0,10)))]):r._e()]}}])}),r._v(" "),a("el-table-column",{attrs:{prop:"warehouseName",label:"盘点仓库","min-width":"90"}}),r._v(" "),a("el-table-column",{attrs:{prop:"hospitalName",label:"医院","min-width":"90"}}),r._v(" "),a("el-table-column",{attrs:{prop:"bookAmount",label:"账面金额","min-width":"80"}}),r._v(" "),a("el-table-column",{attrs:{prop:"bookQuantity",label:"账面数量","min-width":"80"}}),r._v(" "),a("el-table-column",{attrs:{prop:"inventoryAmount",label:"盘点金额","min-width":"80"}}),r._v(" "),a("el-table-column",{attrs:{prop:"inventoryQuantity",label:"盘点数量","min-width":"80"}}),r._v(" "),a("el-table-column",{attrs:{prop:"profitLossAmount",label:"差异金额","min-width":"80"}}),r._v(" "),a("el-table-column",{attrs:{prop:"",label:"差异数量","min-width":"80"},scopedSlots:r._u([{key:"default",fn:function(e){return[r._v("\n                "+r._s(e.row.bookQuantity.red(e.row.inventoryQuantity))+"\n            ")]}}])}),r._v(" "),a("el-table-column",{attrs:{prop:"createBy",label:"填制人","min-width":"80"}}),r._v(" "),a("el-table-column",{attrs:{prop:"address",label:"审核人","min-width":"80"}}),r._v(" "),a("el-table-column",{attrs:{prop:"address",label:"审核日期","min-width":"80"}}),r._v(" "),a("el-table-column",{attrs:{prop:"memo",label:"备注","min-width":"90","show-overflow-tooltip":""}}),r._v(" "),a("el-table-column",{attrs:{prop:"address",label:"更新状态","min-width":"90"}}),r._v(" "),a("el-table-column",{attrs:{prop:"address",label:"审核状态","min-width":"90"}}),r._v(" "),a("el-table-column",{attrs:{prop:"status",label:"操作",width:"210",fixed:"right"},scopedSlots:r._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{"margin-left":"0"},attrs:{type:"primary",size:"small"},on:{click:function(e){return r.addTag("编辑",t.$index,r.tableData)}}},[r._v("编辑")]),r._v(" "),a("el-button",{staticStyle:{"margin-left":"0"},attrs:{type:"primary",size:"small"},on:{click:function(e){return r.deleteRow(t.$index,r.tableData)}}},[r._v("删除")])]}}])})],1),r._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":r.currentPage,"page-sizes":[10,20,30,40],"page-size":r.size,layout:"total, sizes, prev, pager, next, jumper",total:r.total},on:{"size-change":r.handleSizeChange,"current-change":r.handleCurrentChange}})],1),r._v(" "),a("el-dialog",{attrs:{title:r.title,visible:r.tag,size:""},on:{"update:visible":function(e){r.tag=e}}},[r.tag?a("add",{ref:"addS",staticStyle:{width:"1000px"},attrs:{editMes:r.editMes},on:{addDrug:r.addDrug,addClose:r.addClose}}):r._e()],1),r._v(" "),a("el-dialog",{attrs:{title:"选择药品",visible:r.isDrug,size:""},on:{"update:visible":function(e){r.isDrug=e}}},[r.isDrug?a("selDrug",{staticStyle:{width:"640px"},attrs:{searchMes:r.searchMes},on:{selSure:r.selSure}}):r._e()],1)],1)},staticRenderFns:[]}},420:function(e,t,r){r(1956);var a=r(98)(r(1184),r(2431),"data-v-e8d15998",null);e.exports=a.exports}});