webpackJsonp([162],{1028:function(e,t,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=u(103),d=u.n(a),i=u(100),p=u.n(i),r=u(99),s=u.n(r),n=u(443),l=u.n(n),f=u(64),o=u(22),c=u(101);t.default={components:{},data:function(){var e;return{tabLoading:!1,currentIndex:0,url:"",date:"",loading:!1,ispopEdit:!1,filterModel:(e={tickName:"",ticketsType:"",hospitalCodes:"",projCodes:"",tickState:"0",startDate:"",endDate:"",pageIndex:1,pageSize:10},l()(e,"tickState",""),l()(e,"IsEnable",""),l()(e,"sortCode",0),e),userInfo:{},filterWord:"",tableData:[],selectData:[],dataCount:0,currentPage:1,pageSize:20,state:["0"],hospList:[],projectList:[],currentData:""}},computed:{},mounted:function(){this.url=c.b,this.$nextTick(function(){this.dropInfo()})},methods:{ticketSort:function(e){this.ispopEdit=!0,this.sortId=e.Id,this.filterModel.sortCode=e.SortCode?e.SortCode:""},sure:function(){var a=this;return s()(p.a.mark(function e(){var t;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.i(f._548)({id:a.sortId,SortCode:a.filterModel.sortCode});case 2:(t=e.sent).status?(a.$message({type:"success",message:"操作成功!"}),a.getTicketsList(),a.ispopEdit=!1):a.$message({type:"error",message:"操作失败!"+t.errorMessage});case 4:case"end":return e.stop()}},e,a)}))()},ModifyScortCode:function(){var t=this;return s()(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,t)}))()},onSelf:function(e,t){var a=this,i=t?"上架":"下架";this.$confirm("是否确定"+i+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.UpdateTicketsInfoOnSale(e,t)})},UpdateTicketsInfoOnSale:function(a,i){var r=this;return s()(p.a.mark(function e(){var t;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.i(f._430)({id:a,IsEnable:i});case 2:(t=e.sent).status?(r.$message({type:"success",message:"操作成功!"}),r.getTicketsList()):r.$message({type:"error",message:"操作失败!"+t.errorMessage});case 4:case"end":return e.stop()}},e,r)}))()},remoteMethod:function(e){""!==e?(this.loading=!0,this.GetGoodsByKeywords({keywords:e.removeSP(),IsMall:0})):(this.projectList=[],this.filterModel.projCodes=e)},GetGoodsByKeywords:function(o){var c=this;return s()(p.a.mark(function e(){var t,a,i,r,n,s,l;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c.projectList=[],e.next=3,u.i(f._30)(o);case 3:for(t=e.sent,i=!(a=!0),r=void 0,e.prev=7,n=d()(t);!(a=(s=n.next()).done);a=!0)l=s.value,c.projectList.push({name:l.GoodsEntity.GoodsAlias,id:l.GoodsEntity.Id});e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),i=!0,r=e.t0;case 15:e.prev=15,e.prev=16,!a&&n.return&&n.return();case 18:if(e.prev=18,i)throw r;e.next=21;break;case 21:return e.finish(18);case 22:return e.finish(15);case 23:c.loading=!1;case 24:case"end":return e.stop()}},e,c,[[7,11,15,23],[16,,18,22]])}))()},getName:function(e){switch(e){case 1:return"折扣券";case 2:return"代金券";case 3:return"门票"}},getData:function(e){return""!=e.PrdOfVal&&e.PrdOfVal+""!="null"?"售后"+e.PrdOfVal+"天":e.StartDate&&e.EndDate?"开始："+e.StartDate.substr(0,10)+"结束："+e.EndDate.substr(0,10):""},getTicketsList:function(){var a=this;return s()(p.a.mark(function e(){var t;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.tabLoading=!0,a.filterModel.pageIndex=a.currentPage,a.filterModel.pageSize=a.pageSize,e.next=5,u.i(f._174)(a.filterModel);case 5:t=e.sent,a.tableData=[],t instanceof Array&&(0<(a.tableData=t).length?a.dataCount=parseInt(a.tableData[0].RecordCount):a.dataCount=0),a.tabLoading=!1;case 9:case"end":return e.stop()}},e,a)}))()},dropInfo:function(){var t=this;return s()(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.i(f._186)("001");case 2:t.hospList=e.sent;case 3:case"end":return e.stop()}},e,t)}))()},dateSelect:function(e){e.length?(e=e.formatDates(),this.filterModel.startDate=e.substring(0,10),this.filterModel.endDate=e.substring(13)):(this.filterModel.startDate="",this.filterModel.endDate=""),this.search()},search:function(){this.currentPage=1,this.getTicketsList()},deleteRow:function(e,t){var a=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.deleteTicket(e,t)}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deleteTicket:function(t){var a=this;return s()(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.i(f._188)(t);case 2:0<e.sent.success?(a.$message({type:"success",message:"删除成功!"}),a.getTicketsList()):a.$message({type:"warning",message:"删除失败!"});case 4:case"end":return e.stop()}},e,a)}))()},active:function(e,t,a){var i=this,r="启用";2==t&&(r="冻结"),this.$confirm("确定"+r+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.activeTicket(e,t,a)}).catch(function(){i.$message({type:"info",message:"已取消"})})},activeTicket:function(i,r){var n=this;return s()(p.a.mark(function e(){var t,a;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.i(o.b)("userId"),e.next=3,u.i(f._189)(i,r,t);case 3:(a=e.sent).success&&0<a.success?(n.getTicketsList(),n.$message({type:"success",message:"操作成功!"})):n.$message({type:"warning",message:"操作失败!"});case 5:case"end":return e.stop()}},e,n)}))()},pageIndexChange:function(){this.getTicketsList()},pageSizeChange:function(e){this.pageSize=e,this.getTicketsList()},init:function(){this.getTicketsList(),this.currentPage=1},submited:function(){}}}},1466:function(e,t,a){(e.exports=a(215)(!1)).push([e.i,".select[data-v-89e223b8]{background:#f9f9f9;padding:10px;border-radius:5px}.select .el-input[data-v-89e223b8]{width:270px}.select .el-date-editor[data-v-89e223b8]{width:128px}.select .el-input--small .el-input__inner[data-v-89e223b8]{height:35px;width:270px}.select .el-select[data-v-89e223b8]{width:270px}.inline[data-v-89e223b8]{display:inline-block}.block[data-v-89e223b8]{float:right;margin-right:30px;padding-right:0!important}.el-checkbox-button__inner[data-v-89e223b8]{width:150px}",""])},1891:function(e,t,a){var i=a(1466);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a(216)("589eacca",i,!0)},2366:function(e,t){e.exports={render:function(){var a=this,e=a.$createElement,i=a._self._c||e;return i("div",[i("div",{staticClass:"select"},[i("el-form",{staticClass:"demo-form-inline form_search",attrs:{inline:!0,"label-width":"110px"},model:{value:a.filterModel,callback:function(e){a.filterModel=e},expression:"filterModel"}},[i("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"创建日期："}},[i("el-date-picker",{staticStyle:{width:"220px"},attrs:{type:"daterange",placeholder:"选择日期范围"},on:{change:a.dateSelect},model:{value:a.date,callback:function(e){a.date=e},expression:"date"}})],1),a._v(" "),i("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"关键字："}},[i("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"券种编号/申请人/券名"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&a._k(e.keyCode,"enter",13,e.key,"Enter")?null:a.search(e)}},model:{value:a.filterModel.tickName,callback:function(e){a.$set(a.filterModel,"tickName",e)},expression:"filterModel.tickName"}})],1),a._v(" "),i("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"券类型："}},[i("el-select",{staticClass:"form_item_ipt220",on:{change:a.search},model:{value:a.filterModel.ticketsType,callback:function(e){a.$set(a.filterModel,"ticketsType",e)},expression:"filterModel.ticketsType"}},[i("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),i("el-option",{attrs:{label:"折扣券",value:"1"}}),a._v(" "),i("el-option",{attrs:{label:"现金券",value:"2"}}),a._v(" "),i("el-option",{attrs:{label:"门票",value:"3"}})],1)],1),a._v(" "),i("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"适用医院："}},[i("el-select",{staticClass:"form_item_ipt220",on:{change:a.search},model:{value:a.filterModel.hospitalCodes,callback:function(e){a.$set(a.filterModel,"hospitalCodes",e)},expression:"filterModel.hospitalCodes"}},[i("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),a._l(a.hospList,function(e,t){return i("el-option",{key:t,attrs:{label:e.SupplierName,value:e.Code}})})],2)],1),a._v(" "),i("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"启用状态："}},[i("el-select",{staticClass:"form_item_ipt220",on:{change:a.search},model:{value:a.filterModel.tickState,callback:function(e){a.$set(a.filterModel,"tickState",e)},expression:"filterModel.tickState"}},[i("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),i("el-option",{attrs:{label:"未启用",value:"0"}}),a._v(" "),i("el-option",{attrs:{label:"已启用",value:"1"}}),a._v(" "),i("el-option",{attrs:{label:"已冻结",value:"2"}})],1)],1),a._v(" "),i("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"上架状态："}},[i("el-select",{staticClass:"form_item_ipt220",on:{change:a.search},model:{value:a.filterModel.IsEnable,callback:function(e){a.$set(a.filterModel,"IsEnable",e)},expression:"filterModel.IsEnable"}},[i("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),i("el-option",{attrs:{label:"未上架",value:"0"}}),a._v(" "),i("el-option",{attrs:{label:"已上架",value:"1"}})],1)],1),a._v(" "),i("el-form-item",{staticClass:"form_item_mt10",attrs:{label:"适用项目："}},[i("el-select",{staticClass:"form_item_ipt220",attrs:{filterable:"",remote:"",placeholder:"请输入关键词","remote-method":a.remoteMethod,loading:a.loading},on:{change:a.search},model:{value:a.filterModel.projCodes,callback:function(e){a.$set(a.filterModel,"projCodes",e)},expression:"filterModel.projCodes"}},a._l(a.projectList,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),a._v(" "),i("el-form-item",{staticClass:"form_item_mt10",attrs:{label:" "}},[i("el-button",{staticClass:"searchBtn",attrs:{type:"primary"},on:{click:a.search}},[a._v("查询")])],1)],1)],1),a._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:a.tabLoading,expression:"tabLoading"}],ref:"multipleTable",staticClass:"min_table smt",staticStyle:{width:"100%","margin-top":"10px","margin-bottom":"10px"},attrs:{data:a.tableData,border:"",stripe:"","max-height":"600","row-key":"id"}},[i("el-table-column",{attrs:{prop:"MainPicUrl",label:"券封面",width:"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[e.row.MainPicUrl?i("img",{staticStyle:{"vertical-align":"middle"},attrs:{src:a.url+e.row.MainPicUrl,alt:"",width:"82"}}):a._e()]}}])}),a._v(" "),i("el-table-column",{attrs:{prop:"FrontPicUrl",label:"券正面",width:"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[i("div",{staticStyle:{height:"52px",overflow:"hidden"}},[i("div",{staticStyle:{height:"52px",display:"table-cell","vertical-align":"middle"}},[i("img",{staticStyle:{"vertical-align":"middle"},attrs:{src:a.url+e.row.FrontPicUrl,alt:"",width:"82"}})])])]}}])}),a._v(" "),i("el-table-column",{attrs:{prop:"TickInfoCode",label:"券种编号",width:"100"}}),a._v(" "),i("el-table-column",{attrs:{prop:"CreateBy",label:"创建人",width:"100"}}),a._v(" "),i("el-table-column",{attrs:{prop:"CreateOn",label:"创建日期",width:"100"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v("\n                "+a._s(e.row.CreateOn.substring(0,10))+"\n            ")]}}])}),a._v(" "),i("el-table-column",{attrs:{prop:"TickName",label:"券名称","min-width":"160"}}),a._v(" "),i("el-table-column",{attrs:{prop:"TickSubTitle",label:"副标题","min-width":"100","show-overflow-tooltip":""}}),a._v(" "),i("el-table-column",{attrs:{label:"有效期","min-width":"140"},scopedSlots:a._u([{key:"default",fn:function(e){return[""!=e.row.PrdOfVal&&e.row.PrdOfVal+""!="null"?i("span",[a._v(" "+a._s("售后"+e.row.PrdOfVal+"天"))]):i("div",[i("p",[a._v("开始："+a._s(e.row.StartDate&&e.row.StartDate.substr(0,10))+" ")]),a._v(" "),i("p",[a._v("结束："+a._s(e.row.EndDate&&e.row.EndDate.substr(0,10))+" ")])])]}}])}),a._v(" "),i("el-table-column",{attrs:{label:"券类型","min-width":"100"},scopedSlots:a._u([{key:"default",fn:function(e){return[1==e.row.TicketsType?i("span",[a._v("\n                    折扣券\n                ")]):a._e(),a._v(" "),2==e.row.TicketsType?i("span",[a._v("\n                    代金券\n                ")]):a._e(),a._v(" "),3==e.row.TicketsType?i("span",[a._v("\n                    门票\n                ")]):a._e()]}}])}),a._v(" "),i("el-table-column",{attrs:{prop:"Price",label:"售价",width:"100"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v("\n                "+a._s("￥"+e.row.Price)+"\n            ")]}}])}),a._v(" "),i("el-table-column",{attrs:{prop:"TickName",label:"启用状态","min-width":"100",align:"center"},scopedSlots:a._u([{key:"default",fn:function(e){return["0"==e.row.TickState?i("el-tag",{attrs:{type:"gray"}},[a._v("未启用")]):a._e(),a._v(" "),"1"==e.row.TickState?i("el-tag",{attrs:{type:"success"}},[a._v("已启用")]):a._e(),a._v(" "),"2"==e.row.TickState?i("el-tag",{attrs:{type:"warning"}},[a._v("冻结")]):a._e()]}}])}),a._v(" "),i("el-table-column",{attrs:{prop:"TickName",label:"上架状态","min-width":"100",align:"center"},scopedSlots:a._u([{key:"default",fn:function(e){return[e.row.IsEnable?i("el-tag",{attrs:{type:"success"}},[a._v("已上架")]):i("el-tag",{attrs:{type:"gray"}},[a._v("未上架")])]}}])}),a._v(" "),i("el-table-column",{attrs:{prop:"SortCode",label:"排序","min-width":"50"}}),a._v(" "),i("el-table-column",{attrs:{label:"操作",width:"200px"},scopedSlots:a._u([{key:"default",fn:function(t){return["0"==t.row.TickState||null==t.row.TickState?i("div",{staticClass:"inline"},[i("el-button",{attrs:{type:"primary",size:"mini",icon:"edit"},on:{click:function(e){return a.active(t.row.Id,"1",t.$index)}}},[a._v(" 启用\n                    ")])],1):a._e(),a._v(" "),"1"==t.row.TickState?i("div",{staticClass:"inline"},[i("el-button",{attrs:{type:"primary",size:"mini",icon:"edit"},on:{click:function(e){return a.active(t.row.Id,"2",t.$index)}}},[a._v(" 冻结\n                    ")]),a._v(" "),t.row.IsEnable?i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){return a.onSelf(t.row.Id,0)}}},[a._v("下架")]):i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return a.onSelf(t.row.Id,1)}}},[a._v("上架")]),a._v(" "),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return a.ticketSort(t.row)}}},[a._v("排序")])],1):a._e(),a._v(" "),"2"==t.row.TickState?i("div",{staticClass:"inline"},[i("el-button",{attrs:{type:"primary",size:"mini",icon:"edit"},on:{click:function(e){return a.active(t.row.Id,"1",t.$index)}}},[a._v(" 激活\n                    ")])],1):a._e(),a._v(" "),i("el-button",{attrs:{type:"primary",size:"mini",icon:"delete"},on:{click:function(e){return a.deleteRow(t.row.Id,t.$index)}}},[a._v("删除")])]}}])})],1),a._v(" "),i("div",{staticClass:"block"},[i("el-pagination",{attrs:{total:a.dataCount,"current-page":a.currentPage,"page-size":a.pageSize,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":a.pageSizeChange,"current-change":a.pageIndexChange,"update:currentPage":function(e){a.currentPage=e},"update:current-page":function(e){a.currentPage=e}}})],1),a._v(" "),i("el-dialog",{attrs:{title:"消费券排序",visible:a.ispopEdit,size:""},on:{"update:visible":function(e){a.ispopEdit=e}}},[i("el-form",{staticClass:"demo-form-inline",attrs:{"label-width":"80px"},model:{value:a.filterModel,callback:function(e){a.filterModel=e},expression:"filterModel"}},[i("el-form-item",{staticClass:"form_item_mt0",attrs:{label:"排序："}},[i("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:""},model:{value:a.filterModel.sortCode,callback:function(e){a.$set(a.filterModel,"sortCode",a._n(e))},expression:"filterModel.sortCode"}})],1),a._v(" "),i("el-form-item",{staticClass:"form_item_mt10",attrs:{label:""}},[i("span",{staticStyle:{color:"red"}},[a._v("默认为0，数字越大排序越靠前")])]),a._v(" "),i("el-form-item",{staticStyle:{"text-align":"center"},attrs:{label:"","label-width":"0px"}},[i("el-button",{attrs:{type:"primary"},on:{click:a.sure}},[a._v("确定")]),a._v(" "),i("el-button",{on:{click:function(e){a.ispopEdit=!1}}},[a._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]}},316:function(e,t,a){a(1891);var i=a(98)(a(1028),a(2366),"data-v-89e223b8",null);e.exports=i.exports},443:function(e,t,a){"use strict";t.__esModule=!0;var i,r=a(444),n=(i=r)&&i.__esModule?i:{default:i};t.default=function(e,t,a){return t in e?(0,n.default)(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}},444:function(e,t,a){e.exports={default:a(445),__esModule:!0}},445:function(e,t,a){a(446);var i=a(2).Object;e.exports=function(e,t,a){return i.defineProperty(e,t,a)}},446:function(e,t,a){var i=a(9);i(i.S+i.F*!a(10),"Object",{defineProperty:a(11).f})}});