webpackJsonp([74],{1005:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(100),o=n.n(a),i=n(99),r=n.n(i),s=n(64);e.default={props:{mes:Object,date:"",isFinished:""},watch:{},computed:{setAmount:function(){var e=0;return this.multipleSelection.forEach(function(t){e=e.add(t.amountOut)}),e}},mounted:function(){1==this.isFinished?this.GetHospitalOutDetailHis():this.GetHospitalOutDetail()},data:function(){return{loading:!1,branch:{},total:0,multipleTable:[],showMes:{type:"",baseMes:""},multipleSelection:[],tableData:[]}},methods:{reportData:function(){this.$emit("reportData",this.tableData)},backOpe:function(e){var a=this;return r()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a.$confirm("此操作将修改该单据为未审核状态，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.RevokeApprove({FxCode:e.fxCode?e.fxCode:"",BranchCode:e.fxCode?"":e.customerId,CommissionDate:e.fxCode?"":a.date})}).catch(function(){});case 1:case"end":return t.stop()}},t,a)}))()},RevokeApprove:function(e){var a=this;return r()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.i(s._490)(e);case 2:t.sent.status?(a.$message({message:"撤回成功",type:"success"}),a.GetHospitalOutDetail()):a.$message.error("撤回失败");case 4:case"end":return t.stop()}},t,a)}))()},GetHospitalOutDetail:function(){var a=this;return r()(o.a.mark(function t(){var e;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a.loading=!0,t.next=3,n.i(s._491)({HospitalId:a.mes.hospitalId,CommissionDate:a.date,ToCode:a.mes.toCode,TypeId:a.mes.typeId,isFinished:a.isFinished,isCurrentMonth:a.mes.isCurrentMonth?1:0});case 3:e=t.sent,a.loading=!1,a.tableData=e.data;case 6:case"end":return t.stop()}},t,a)}))()},GetHospitalOutDetailHis:function(){var a=this;return r()(o.a.mark(function t(){var e;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.i(s._492)({HospitalId:a.mes.hospitalId,startDate:a.mes.startDate,endDate:a.mes.endDate,ToCode:a.mes.toCode,TypeId:a.mes.typeId});case 2:e=t.sent,a.tableData=e.data;case 4:case"end":return t.stop()}},t,a)}))()},handleSelectionChange:function(t){this.multipleSelection=t},getPD:function(t){this.$emit("openRP",t)},settle:function(){var o=this;this.$confirm("确定进行结算操作？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={};o.multipleSelection.forEach(function(t){e[""+t.settleTypeId]||(e[""+t.settleTypeId]=[]),e[""+t.settleTypeId].push(t.id)});var t=[];for(var a in e){var n=e[a].join(",");t.push(a+"@"+n)}o.HospitalDetailSettlement(t.join("|"))}).catch(function(){})},HospitalDetailSettlement:function(e){var a=this;return r()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.i(s._493)({ids:e});case 2:t.sent.status?(a.$message({message:"结算成功",type:"success"}),a.$emit("detSettle")):a.$message.error("结算失败");case 4:case"end":return t.stop()}},t,a)}))()}},components:{}}},1008:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i(100),r=i.n(a),n=i(99),s=i.n(n),o=i(37),l=i.n(o),c=i(443),u=i.n(c),m=i(2053),p=i.n(m),d=i(436),f=i.n(d),h=i(64),v=i(65);i.n(v);e.default={data:function(){var t;return t={selectData:{},ispopRead:!1,loading:!1,mes:{},dialogTableVisible:!1,detail:!1,total:0,HospitalList:[],formInline:{keywords:"",Hospital:[],mulHos:"",branch:"",date:"",startTime:"",endTime:"",type:0,hos:""},date:"",agentList:[],tableData:[],year:(new Date).getFullYear(),month:"",yearList:[],monthList:[]},u()(t,"mes",""),u()(t,"sum",{consumeAmount:0}),u()(t,"currentPage",0),u()(t,"size",10),u()(t,"allData",[]),u()(t,"detailData",[]),u()(t,"multipleSelection",[]),t},computed:{tHeader:function(){return["医院","转出客户","开户人","开户行","银行卡号","金额"]},filterVal:function(){return["hospitalName","toName","bankCardHolder","openBankName","bankCardId","consumeAmount"]},name:function(){return"医院结算"},reportData:function(){return JSON.parse(l()(this.allData))},totalAmount:function(){var e=0;return this.multipleSelection.forEach(function(t){e=e.add(t.consumeAmount)}),e}},mounted:function(){this.getSupplierByPage()},methods:{handleSelectionChange:function(t){this.multipleSelection=t},dateChange:function(t){this.formInline.date=t||""},change:function(){this.formInline.keywords=""},getSummaries:function(){return["总合计","",this.sum.consumeAmount.toQFW()]},GetHospitalIn:function(a){var n=this;return s()(r.a.mark(function t(){var e;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n.loading=!0,t.next=4,i.i(h._489)(a);case 4:e=t.sent,n.loading=!1,e.status?(n.total=e.count,n.allData=e.data,n.pageChange(),n.getTotal()):n.$message.error("获取数据失败"+e.errorMessage),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0);case 12:case"end":return t.stop()}},t,n,[[0,9]])}))()},getSupplierByPage:function(){var o=this;return s()(r.a.mark(function t(){var e,a,n;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.i(h.a)({SupTypeCode:"001"});case 2:return e=t.sent,a=[],e.forEach(function(t){a.push({name:t.SupplierName,value:t.Code})}),o.HospitalList=a,t.next=8,i.i(h.d)({typeId:2});case 8:n=t.sent,o.agentList=n.data;case 10:case"end":return t.stop()}},t,o)}))()},submit:function(){this.currentPage=1,this.search()},search:function(){this.sum={consumeAmount:0},this.GetHospitalIn({HospitalId:this.getHos(this.formInline.Hospital),CommissionDate:(this.formInline.date||this.date).formatDate("yyyy-MM-dd"),IsFinished:this.formInline.type,keywords:this.formInline.keywords.removeSP(),TypeId:this.formInline.branch})},getHos:function(t){var e=[];return t.forEach(function(t){e.push(t.value)}),e.join(",")},det:function(t,e){this.mes=e[t],this.GetHospitalInDetail({HospitalId:e[t].hospitalId,CommissionDate:this.formInline.date,FromCode:e[t].fromCode,TypeId:this.formInline.branch}),this.detail=!0},GetHospitalInDetail:function(a){var n=this;return s()(r.a.mark(function t(){var e;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.i(h._473)(a);case 2:e=t.sent,n.detailData=e.data;case 4:case"end":return t.stop()}},t,n)}))()},openRP:function(t){this.selectData=t,this.ispopRead=!0},handleSizeChange:function(t){this.size=t,this.pageChange()},handleCurrentChange:function(t){this.currentPage=t,this.pageChange()},pageChange:function(){this.tableData=this.allData.slice((this.currentPage-1)*this.size,this.currentPage*this.size)},getTotal:function(){var e=this;this.allData.forEach(function(t){e.sum.consumeAmount=e.sum.consumeAmount.add(t.consumeAmount)})},selMulData:function(){if(1==this.formInline.Hospital.length&&""==this.formInline.Hospital[0].value)this.formInline.mulHos="全部";else{for(var t=[],e=JSON.parse(l()(this.formInline.Hospital)),a=e.length,n=0;n<a;n++){if(""==e[n].value)return this.formInline.mulHos="全部",this.formInline.Hospital=[],this.formInline.Hospital.push({name:"全部",value:""}),!1;t.push(e[n].name)}this.formInline.mulHos=t.join(",")}},getPD:function(t){this.ispopRead=!0,this.selectData=t}},components:{Export:f.a,det:p.a}}},1311:function(t,e,a){(t.exports=a(215)(!1)).push([t.i,"",""])},1336:function(t,e,a){(t.exports=a(215)(!1)).push([t.i,"",""])},1736:function(t,e,a){var n=a(1311);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a(216)("3955d81e",n,!0)},1761:function(t,e,a){var n=a(1336);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a(216)("62fa98ec",n,!0)},2053:function(t,e,a){a(1761);var n=a(98)(a(1005),a(2233),"data-v-3c03382c",null);t.exports=n.exports},2208:function(t,e){t.exports={render:function(){var a=this,t=a.$createElement,n=a._self._c||t;return n("div",{staticClass:"settled selCommon"},[n("el-form",{staticClass:"demo-form-inline form_search",attrs:{inline:!0,model:a.formInline,"label-width":"80px"}},[n("el-form-item",{staticClass:"form_item_mt10 ",attrs:{label:"结算日期："}},[n("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"选择日期"},on:{change:a.dateChange},model:{value:a.date,callback:function(t){a.date=t},expression:"date"}})],1),a._v(" "),n("el-form-item",{staticClass:"form_item_mt10 form_item_wh280",staticStyle:{width:"285px",position:"relative"},attrs:{label:"医院："}},[n("el-input",{staticStyle:{width:"200px",position:"absolute"},attrs:{placeholder:"请选择"},model:{value:a.formInline.mulHos,callback:function(t){a.$set(a.formInline,"mulHos",t)},expression:"formInline.mulHos"}}),a._v(" "),n("el-select",{staticStyle:{width:"200px",opacity:"0",height:"36px"},attrs:{placeholder:"",multiple:""},on:{change:a.selMulData},model:{value:a.formInline.Hospital,callback:function(t){a.$set(a.formInline,"Hospital",t)},expression:"formInline.Hospital"}},a._l(a.HospitalList,function(t){return n("el-option",{key:t.value,attrs:{label:t.name,value:t}})}),1)],1),a._v(" "),n("el-form-item",{staticClass:"form_item_mt10 form_item_wh280",attrs:{label:"来源客户："}},[n("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:""},on:{change:a.change},model:{value:a.formInline.branch,callback:function(t){a.$set(a.formInline,"branch",t)},expression:"formInline.branch"}},[n("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),n("el-option",{attrs:{label:"销售公司",value:"1"}}),a._v(" "),n("el-option",{attrs:{label:"消费商",value:"2"}})],1)],1),a._v(" "),1==a.formInline.branch?n("el-form-item",{staticClass:"form_item_mt10 form_item_wh280",attrs:{label:"医院："}},[n("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:""},model:{value:a.formInline.keywords,callback:function(t){a.$set(a.formInline,"keywords",t)},expression:"formInline.keywords"}},[n("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),a._l(a.HospitalList,function(t){return n("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})})],2)],1):a._e(),a._v(" "),2==a.formInline.branch?n("el-form-item",{staticClass:"form_item_mt10 form_item_wh280",attrs:{label:"销售公司："}},[n("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:""},model:{value:a.formInline.keywords,callback:function(t){a.$set(a.formInline,"keywords",t)},expression:"formInline.keywords"}},a._l(a.agentList,function(t){return n("el-option",{key:t.code,attrs:{label:t.branchName,value:t.code}})}),1)],1):a._e(),a._v(" "),3==a.formInline.branch?n("el-form-item",{staticClass:"form_item_mt10 form_item_wh280",attrs:{label:"关键字："}},[n("el-input",{staticStyle:{width:"200px"},model:{value:a.formInline.keywords,callback:function(t){a.$set(a.formInline,"keywords",t)},expression:"formInline.keywords"}})],1):a._e(),a._v(" "),n("el-form-item",{staticClass:"form_item_mt10 form_item_wh280",attrs:{label:" "}},[n("el-button",{staticClass:"searchBtn",attrs:{type:"primary"},on:{click:a.submit}},[a._v("查询")]),a._v(" "),n("Export",{ref:"port",attrs:{tHeader:a.tHeader,filterVal:a.filterVal,tableData1:a.reportData,name:a.name}})],1)],1),a._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],staticClass:"min_table smt",staticStyle:{width:"100%","margin-top":"15px","margin-bottom":"10px"},attrs:{data:a.tableData,border:"","max-height":"660","show-summary":"","summary-method":a.getSummaries}},[n("el-table-column",{attrs:{prop:"hospitalName",label:"医院","min-width":"80"}}),a._v(" "),n("el-table-column",{attrs:{prop:"fromName",label:"来源客户","min-width":"80"},scopedSlots:a._u([{key:"default",fn:function(t){return[n("span",[a._v(a._s(t.row.fromName))]),n("br"),a._v(" "),n("span",[a._v(a._s(t.row.fromCode))])]}}])}),a._v(" "),n("el-table-column",{staticStyle:{color:"red"},attrs:{label:"金额",prop:"consumeAmount","min-width":"120",align:"right"},scopedSlots:a._u([{key:"default",fn:function(e){return[n("el-button",{staticStyle:{float:"right"},attrs:{type:"text",size:"small"},on:{click:function(t){return a.det(e.$index,a.tableData)}}},[a._v(a._s(e.row.consumeAmount.toQFW()))])]}}])})],1),a._v(" "),n("div",{staticClass:"block"},[n("el-pagination",{attrs:{"current-page":a.currentPage,"page-sizes":[10,20,30,40],"page-size":a.size,layout:"total, sizes, prev, pager, next, jumper",total:a.total},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1),a._v(" "),n("el-dialog",{attrs:{title:"详情",visible:a.dialogTableVisible,size:""},on:{"update:visible":function(t){a.dialogTableVisible=t}}},[a.dialogTableVisible?n("det",{staticStyle:{width:"1000px"},attrs:{mes:a.mes,date:a.formInline.date,isFinished:a.formInline.type},on:{openRP:a.openRP}}):a._e()],1),a._v(" "),n("el-dialog",{attrs:{title:"详情",visible:a.detail,size:""},on:{"update:visible":function(t){a.detail=t}}},[n("span",[a._v("金额："+a._s(a.totalAmount))]),a._v(" "),n("el-table",{ref:"multipleTable",staticClass:"min_table smt",staticStyle:{width:"650px"},attrs:{data:a.detailData,border:"","tooltip-effect":"dark","max-height":"560"},on:{"selection-change":a.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",align:"center","min-width":"55"}}),a._v(" "),n("el-table-column",{attrs:{prop:"customerName",label:"客户","min-width":"90"}}),a._v(" "),n("el-table-column",{attrs:{prop:"hospitalName",label:"医院","min-width":"100"}}),a._v(" "),n("el-table-column",{attrs:{prop:"consumeAmount",label:"金额","min-width":"100",align:"right"}})],1)],1)],1)},staticRenderFns:[]}},2233:function(t,e){t.exports={render:function(){var a=this,t=a.$createElement,n=a._self._c||t;return n("div",{staticClass:"selCommon"},[0==a.isFinished?n("div",{staticStyle:{"margin-bottom":"10px"}},[n("span",[a._v("结算金额："+a._s(a.setAmount))]),a._v(" "),n("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:a.settle}},[a._v("结算")]),a._v(" "),n("el-button",{staticStyle:{"margin-left":"10px"},on:{click:a.reportData}},[a._v("导出报表")])],1):a._e(),a._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],ref:"multipleTable",staticClass:"min_table smt",staticStyle:{width:"100%"},attrs:{data:a.tableData,border:"","tooltip-effect":"dark","max-height":"560"},on:{"selection-change":a.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",align:"center","min-width":"55"}}),a._v(" "),n("el-table-column",{attrs:{label:"单号","min-width":"100"},scopedSlots:a._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text"},on:{click:function(t){return a.getPD(e.row)}}},[a._v(a._s(e.row.fxCode))])]}}])}),a._v(" "),n("el-table-column",{attrs:{prop:"customerName",label:"客户","min-width":"80"}}),a._v(" "),n("el-table-column",{attrs:{prop:"refrenceBranchName",label:"推荐人","min-width":"80"},scopedSlots:a._u([{key:"default",fn:function(t){return[n("span",[a._v(a._s(t.row.refrenceBranchName))]),n("br"),a._v(" "),n("span",[a._v(a._s(t.row.refrenceBranchCode))])]}}])}),a._v(" "),n("el-table-column",{attrs:{prop:"hospitalName",label:"医院","min-width":"150"}}),a._v(" "),n("el-table-column",{attrs:{prop:"toName",label:"转到","min-width":"85"}}),a._v(" "),n("el-table-column",{attrs:{prop:"orderAmount",label:"订单金额","min-width":"85",align:"right"},scopedSlots:a._u([{key:"default",fn:function(t){return[t.row.orderAmount?n("span",[a._v(" ￥"+a._s(t.row.orderAmount.toQFW()))]):n("span",[a._v(" ￥0")])]}}])}),a._v(" "),n("el-table-column",{attrs:{prop:"realAmount",label:"提成总额","min-width":"85",align:"right"},scopedSlots:a._u([{key:"default",fn:function(t){return[t.row.realAmount?n("span",[a._v(" ￥"+a._s(t.row.realAmount.toQFW()))]):n("span",[a._v(" ￥0")])]}}])}),a._v(" "),n("el-table-column",{attrs:{prop:"toRate",label:"比例","min-width":"85"},scopedSlots:a._u([{key:"default",fn:function(t){return[a._v("\n                "+a._s(t.row.toRate.mul(100))+"%\n            ")]}}])}),a._v(" "),n("el-table-column",{attrs:{prop:"amountOut",label:"提成金额","min-width":"85",align:"right"},scopedSlots:a._u([{key:"default",fn:function(t){return[t.row.amountOut?n("span",[a._v(" ￥"+a._s(t.row.amountOut.toQFW()))]):n("span",[a._v(" ￥0")])]}}])}),a._v(" "),n("el-table-column",{attrs:{prop:"amountOut",label:"操作","min-width":"85",align:"center"},scopedSlots:a._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return a.backOpe(e.row)}}},[a._v("撤回审核")])]}}])})],1),a._v(" "),n("span",[a._v("共 "+a._s(a.tableData.length)+" 条数据")])],1)},staticRenderFns:[]}},301:function(t,e,a){a(1736);var n=a(98)(a(1008),a(2208),"data-v-2cad0cb2",null);t.exports=n.exports},436:function(t,e,a){a(439);var n=a(98)(a(437),a(440),"data-v-6c47323e",null);t.exports=n.exports},437:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{tHeader:{},filterVal:{},tableData1:{type:Array},name:""},watch:{tableData1:{handler:function(t){this.otData=t},deep:!0}},data:function(){return{otData:[]}},methods:{handleDownload:function(){var a=this;n.e(220).then(function(){var t=n(448).export_json_to_excel,e=[];e=0!=a.otData.length?a.formatJson(a.filterVal,a.otData):a.formatJson(a.filterVal,a.tableData1),t(a.tHeader,e,a.name)}.bind(null,n)).catch(n.oe)},formatJson:function(t,e){return e.map(function(e){return t.map(function(t){return e[t]})})}}}},438:function(t,e,a){(t.exports=a(215)(!1)).push([t.i,".exportBtn[data-v-6c47323e]{background:#fff;border:1px solid #d6d4d4;font-size:14px;color:#666;border-radius:4px}",""])},439:function(t,e,a){var n=a(438);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a(216)("fdf4f478",n,!0)},440:function(t,e){t.exports={render:function(){var t=this.$createElement;return(this._self._c||t)("el-button",{staticClass:"exportBtn",attrs:{type:"primary"},on:{click:this.handleDownload}},[this._v("导出报表")])},staticRenderFns:[]}},443:function(t,e,a){"use strict";e.__esModule=!0;var n,o=a(444),i=(n=o)&&n.__esModule?n:{default:n};e.default=function(t,e,a){return e in t?(0,i.default)(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}},444:function(t,e,a){t.exports={default:a(445),__esModule:!0}},445:function(t,e,a){a(446);var n=a(2).Object;t.exports=function(t,e,a){return n.defineProperty(t,e,a)}},446:function(t,e,a){var n=a(9);n(n.S+n.F*!a(10),"Object",{defineProperty:a(11).f})}});